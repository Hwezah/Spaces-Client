(()=>{var e={};e.id=346,e.ids=[346],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},96849:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>l,pages:()=>u,routeModule:()=>f,tree:()=>d}),a(93692),a(48278),a(55886),a(81798),a(20784),a(89204),a(41888);var r=a(23191),s=a(88716),o=a(37922),n=a.n(o),i=a(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);a.d(t,c);let d=["",{children:["account",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,93692)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\page.js"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,48278)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\layout.js"],loading:[()=>Promise.resolve().then(a.bind(a,55886)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\loading.js"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,81798)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\layout.js"],error:[()=>Promise.resolve().then(a.bind(a,20784)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\error.js"],loading:[()=>Promise.resolve().then(a.bind(a,89204)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\loading.js"],"not-found":[()=>Promise.resolve().then(a.bind(a,41888)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\not-found.js"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\page.js"],l="/account/page",p={require:a,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/account/page",pathname:"/account",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74516:(e,t,a)=>{let r={"1a41a44641fcf550a5968504b1ae5eabb3287dba":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.deleteBookingAction),"66f86fd1490cd954b5d6f7917c109be62b7801ae":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.createBookingAction),"6c6faafe8ea32be926654cc9704522ad7da6944c":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.signOutAction),"85d9eb2d26ff22ca791d19f087ca23edcd64ada3":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.updateBookingAction),aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d:()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.signInAction),dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0:()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.updateGuestAction)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"1a41a44641fcf550a5968504b1ae5eabb3287dba":s.bind(null,"1a41a44641fcf550a5968504b1ae5eabb3287dba"),"66f86fd1490cd954b5d6f7917c109be62b7801ae":s.bind(null,"66f86fd1490cd954b5d6f7917c109be62b7801ae"),"6c6faafe8ea32be926654cc9704522ad7da6944c":s.bind(null,"6c6faafe8ea32be926654cc9704522ad7da6944c"),"85d9eb2d26ff22ca791d19f087ca23edcd64ada3":s.bind(null,"85d9eb2d26ff22ca791d19f087ca23edcd64ada3"),aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d:s.bind(null,"aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d"),dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0:s.bind(null,"dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0")}},955:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createBookingAction:()=>k,deleteBookingAction:()=>P,signInAction:()=>w,signOutAction:()=>I,updateBookingAction:()=>y,updateGuestAction:()=>x});var r=a(27745);a(26461);var s=a(30207),o=a(67838),n=a(99093);let i=(0,a(84736).eI)("https://gaojwilavmullvnglpwp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdhb2p3aWxhdm11bGx2bmdscHdwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjI3MzU3NywiZXhwIjoyMDYxODQ5NTc3fQ.PuIXX70SAjnwpadolC62xY76XDkL2Ac9yHM5jQrjU1Q");var c=a(74739);async function d(e){let{data:t,error:a}=await i.from("guests").select("*").eq("email",e).single();return t}async function u(e){let{data:t,error:a,count:r}=await i.from("bookings").select("id, created_at, startDate, endDate, numNights, numGuests, totalPrice, guestId, spaceId, spaces(name, image)").eq("guestId",e).order("startDate");if(console.log(t),a)throw console.error(a),Error("Bookings could not get loaded");return t}async function l(e){let{data:t,error:a}=await i.from("guests").insert([e]);if(a)throw console.error(a),Error("Guest could not be created");return t}async function p(e){let{data:t,error:a}=await i.from("bookings").delete().eq("id",e);if(a)throw console.error(a),Error("Booking could not be deleted");return t}a(55602),a(86145);let f={providers:[(0,n.Z)({clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET})],callbacks:{authorized:({auth:e,request:t})=>!!e?.user,async signIn({user:e}){try{return await d(e.email)||await l({email:e.email,fullName:e.name}),!0}catch(e){return console.error("Sign-in error:",e),!1}},async session({session:e,user:t}){try{let t=await d(e.user.email);e.user.guestId=t?.id||null}catch(t){console.error("Error in session callback:",t),e.user.guestId=null}return e}},pages:{signIn:"/login"}},{handlers:{GET:b,POST:g},auth:m,signIn:h,signOut:v}=(0,o.ZP)(f);async function w(){await h("google",{redirectTo:"/account"})}async function I(){await v({redirectTo:"/"})}async function x(e){let t=await m();if(!t)throw Error("You must be logged in");let a=e.get("nationalID"),[r,o]=e.get("nationality").split("%");if(!/^[a-zA-Z0-9]{6,12}$/.test(a))throw Error("Please provide a valid national ID");let{data:n,error:c}=await i.from("guests").update({nationality:r,countryFlag:o,nationalID:a}).eq("id",t.user.guestId);if(c)throw Error("Guest could not be updated");(0,s.revalidatePath)("/account/profile")}async function P(e){let t=await m();if(!t)throw Error("You must be logged in");if(!(await u(t.user.guestId)).map(e=>e.id).includes(e))throw Error("You are not authorized to delete this booking");await p(e),(0,s.revalidatePath)("/account/reservations")}async function y(e){console.log(e);let t=Number(e.get("bookingId")),a=await m();if(!a)throw Error("You must be logged in");if(!(await u(a.user.guestId)).map(e=>e.id).includes(t))throw Error("You are not authorized to update this booking");let r={numGuests:Number(e.get("numGuests")),observations:e.get("observations").slice(0,1e3)},{error:o}=await i.from("bookings").update(r).eq("id",t).select().single();if(o)throw Error("Booking could not be updated");(0,s.revalidatePath)("/account/reservations"),(0,s.revalidatePath)(`/account/reservations/edit/${t}`),(0,c.redirect)("/account/reservations")}async function k(e,t){let a=await m();if(!a)throw Error("You must be logged in");let r={...e,guestId:a.user.guestId,observations:t.get("observations").slice(0,1e3),numGuests:Number(t.get("numGuests")),extrasPrice:0,totalPrice:e.spacePrice,isPaid:!1,hasBreakfast:!1,status:"unconfirmed"},{error:o}=await i.from("bookings").insert([r]);if(o)throw Error("Booking could not be created");(0,s.revalidatePath)(`/spaces/${e.spaceId}`),(0,c.redirect)("/spaces/thankyou")}(0,a(85723).h)([w,I,x,P,y,k]),(0,r.j)("aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d",w),(0,r.j)("6c6faafe8ea32be926654cc9704522ad7da6944c",I),(0,r.j)("dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0",x),(0,r.j)("1a41a44641fcf550a5968504b1ae5eabb3287dba",P),(0,r.j)("85d9eb2d26ff22ca791d19f087ca23edcd64ada3",y),(0,r.j)("66f86fd1490cd954b5d6f7917c109be62b7801ae",k)},93692:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n,metadata:()=>o});var r=a(19510);a(22901);var s=a(76177);let o={title:"Guest area"};async function n(){let e=await (0,s.I8)();return console.log(e),(0,r.jsxs)("h2",{className:"font-semibold text-2xl text-accent-400 mb-7",children:["Welcome, ",e?.user?.name.split(" ").at(0)??"Guest","!"]})}}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,782,362,650,792,822],()=>a(96849));module.exports=r})();