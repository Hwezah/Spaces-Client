(()=>{var e={};e.id=997,e.ids=[997],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},28798:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>f,tree:()=>l}),a(16250),a(48278),a(55886),a(81798),a(20784),a(89204),a(41888);var r=a(23191),s=a(88716),i=a(37922),n=a.n(i),o=a(95231),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);a.d(t,d);let l=["",{children:["account",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,16250)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\profile\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,48278)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\layout.js"],loading:[()=>Promise.resolve().then(a.bind(a,55886)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\loading.js"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,81798)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\layout.js"],error:[()=>Promise.resolve().then(a.bind(a,20784)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\error.js"],loading:[()=>Promise.resolve().then(a.bind(a,89204)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\loading.js"],"not-found":[()=>Promise.resolve().then(a.bind(a,41888)),"C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\not-found.js"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,4998))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["C:\\Users\\DELL\\Desktop\\Spaces(Client)\\app\\account\\profile\\page.js"],u="/account/profile/page",p={require:a,loadChunk:()=>Promise.resolve()},f=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/account/profile/page",pathname:"/account/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},74516:(e,t,a)=>{let r={"1a41a44641fcf550a5968504b1ae5eabb3287dba":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.deleteBookingAction),"66f86fd1490cd954b5d6f7917c109be62b7801ae":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.createBookingAction),"6c6faafe8ea32be926654cc9704522ad7da6944c":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.signOutAction),"85d9eb2d26ff22ca791d19f087ca23edcd64ada3":()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.updateBookingAction),aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d:()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.signInAction),dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0:()=>Promise.resolve().then(a.bind(a,955)).then(e=>e.updateGuestAction)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"1a41a44641fcf550a5968504b1ae5eabb3287dba":s.bind(null,"1a41a44641fcf550a5968504b1ae5eabb3287dba"),"66f86fd1490cd954b5d6f7917c109be62b7801ae":s.bind(null,"66f86fd1490cd954b5d6f7917c109be62b7801ae"),"6c6faafe8ea32be926654cc9704522ad7da6944c":s.bind(null,"6c6faafe8ea32be926654cc9704522ad7da6944c"),"85d9eb2d26ff22ca791d19f087ca23edcd64ada3":s.bind(null,"85d9eb2d26ff22ca791d19f087ca23edcd64ada3"),aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d:s.bind(null,"aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d"),dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0:s.bind(null,"dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0")}},32432:(e,t,a)=>{Promise.resolve().then(a.bind(a,73857)),Promise.resolve().then(a.t.bind(a,79404,23))},206:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var r=a(10326),s=a(60962);function i({children:e,pendingLabel:t}){let{pending:a}=(0,s.useFormStatus)();return r.jsx("button",{className:"bg-accent-500 px-8 py-4 text-primary-800 font-semibold hover:bg-accent-600 transition-all disabled:cursor-not-allowed disabled:bg-gray-500 disabled:text-gray-300",disabled:a,children:a?t:e})}},73857:(e,t,a)=>{"use strict";a.d(t,{default:()=>n});var r=a(10326),s=a(6826),i=a(206);let n=function({children:e,guest:t}){let{fullName:a,email:n,nationality:o,nationalID:d,countryFlag:l}=t;return(0,r.jsxs)("form",{action:s.VO,className:"bg-primary-900 py-8 px-12 text-lg flex gap-6 flex-col",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{children:"Full name"}),r.jsx("input",{disabled:!0,defaultValue:a,name:"fullName",className:"px-5 py-3 bg-primary-200 text-primary-800 w-full shadow-sm rounded-sm disabled:cursor-not-allowed disabled:bg-gray-600 disabled:text-gray-400"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{children:"Email address"}),r.jsx("input",{disabled:!0,defaultValue:n,name:"email",className:"px-5 py-3 bg-primary-200 text-primary-800 w-full shadow-sm rounded-sm disabled:cursor-not-allowed disabled:bg-gray-600 disabled:text-gray-400"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("label",{htmlFor:"nationality",children:"Where are you from?"}),r.jsx("img",{src:l,alt:"Country flag",className:"h-5 rounded-sm"})]}),e]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{htmlFor:"nationalID",children:"National ID number"}),r.jsx("input",{name:"nationalID",defaultValue:d,className:"px-5 py-3 bg-primary-200 text-primary-800 w-full shadow-sm rounded-sm"})]}),r.jsx("div",{className:"flex justify-end items-center gap-6",children:r.jsx(i.default,{pendingLabel:"Updating...",children:"Update Profile"})})]})}},955:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createBookingAction:()=>I,deleteBookingAction:()=>j,signInAction:()=>y,signOutAction:()=>v,updateBookingAction:()=>P,updateGuestAction:()=>w});var r=a(27745);a(26461);var s=a(30207),i=a(67838),n=a(99093);let o=(0,a(84736).eI)("https://gaojwilavmullvnglpwp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdhb2p3aWxhdm11bGx2bmdscHdwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjI3MzU3NywiZXhwIjoyMDYxODQ5NTc3fQ.PuIXX70SAjnwpadolC62xY76XDkL2Ac9yHM5jQrjU1Q");var d=a(74739);async function l(e){let{data:t,error:a}=await o.from("guests").select("*").eq("email",e).single();return t}async function c(e){let{data:t,error:a,count:r}=await o.from("bookings").select("id, created_at, startDate, endDate, numNights, numGuests, totalPrice, guestId, spaceId, spaces(name, image)").eq("guestId",e).order("startDate");if(console.log(t),a)throw console.error(a),Error("Bookings could not get loaded");return t}async function u(e){let{data:t,error:a}=await o.from("guests").insert([e]);if(a)throw console.error(a),Error("Guest could not be created");return t}async function p(e){let{data:t,error:a}=await o.from("bookings").delete().eq("id",e);if(a)throw console.error(a),Error("Booking could not be deleted");return t}a(55602),a(86145);let f={providers:[(0,n.Z)({clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET})],callbacks:{authorized:({auth:e,request:t})=>!!e?.user,async signIn({user:e}){try{return await l(e.email)||await u({email:e.email,fullName:e.name}),!0}catch(e){return console.error("Sign-in error:",e),!1}},async session({session:e,user:t}){try{let t=await l(e.user.email);e.user.guestId=t?.id||null}catch(t){console.error("Error in session callback:",t),e.user.guestId=null}return e}},pages:{signIn:"/login"}},{handlers:{GET:m,POST:b},auth:g,signIn:h,signOut:x}=(0,i.ZP)(f);async function y(){await h("google",{redirectTo:"/account"})}async function v(){await x({redirectTo:"/"})}async function w(e){let t=await g();if(!t)throw Error("You must be logged in");let a=e.get("nationalID"),[r,i]=e.get("nationality").split("%");if(!/^[a-zA-Z0-9]{6,12}$/.test(a))throw Error("Please provide a valid national ID");let{data:n,error:d}=await o.from("guests").update({nationality:r,countryFlag:i,nationalID:a}).eq("id",t.user.guestId);if(d)throw Error("Guest could not be updated");(0,s.revalidatePath)("/account/profile")}async function j(e){let t=await g();if(!t)throw Error("You must be logged in");if(!(await c(t.user.guestId)).map(e=>e.id).includes(e))throw Error("You are not authorized to delete this booking");await p(e),(0,s.revalidatePath)("/account/reservations")}async function P(e){console.log(e);let t=Number(e.get("bookingId")),a=await g();if(!a)throw Error("You must be logged in");if(!(await c(a.user.guestId)).map(e=>e.id).includes(t))throw Error("You are not authorized to update this booking");let r={numGuests:Number(e.get("numGuests")),observations:e.get("observations").slice(0,1e3)},{error:i}=await o.from("bookings").update(r).eq("id",t).select().single();if(i)throw Error("Booking could not be updated");(0,s.revalidatePath)("/account/reservations"),(0,s.revalidatePath)(`/account/reservations/edit/${t}`),(0,d.redirect)("/account/reservations")}async function I(e,t){let a=await g();if(!a)throw Error("You must be logged in");let r={...e,guestId:a.user.guestId,observations:t.get("observations").slice(0,1e3),numGuests:Number(t.get("numGuests")),extrasPrice:0,totalPrice:e.spacePrice,isPaid:!1,hasBreakfast:!1,status:"unconfirmed"},{error:i}=await o.from("bookings").insert([r]);if(i)throw Error("Booking could not be created");(0,s.revalidatePath)(`/spaces/${e.spaceId}`),(0,d.redirect)("/spaces/thankyou")}(0,a(85723).h)([y,v,w,j,P,I]),(0,r.j)("aa1ff7e5a7b0c9759d8ec35a6897f777e9d66a5d",y),(0,r.j)("6c6faafe8ea32be926654cc9704522ad7da6944c",v),(0,r.j)("dd1f09d87b9dead41fb5ef5930d6c8e69876d6c0",w),(0,r.j)("1a41a44641fcf550a5968504b1ae5eabb3287dba",j),(0,r.j)("85d9eb2d26ff22ca791d19f087ca23edcd64ada3",P),(0,r.j)("66f86fd1490cd954b5d6f7917c109be62b7801ae",I)},16250:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l,metadata:()=>d});var r=a(19510),s=a(99115);async function i({defaultCountry:e,name:t,id:a,className:i}){let n=await (0,s.ox)(),o=n.find(t=>t.name===e)?.flag??"";return(0,r.jsxs)("select",{name:t,id:a,defaultValue:`${e}%${o}`,className:i,children:[r.jsx("option",{value:"",children:"Select country..."}),n.map(e=>r.jsx("option",{value:`${e.name}%${e.flag}`,children:e.name},e.name))]})}let n=(0,a(68570).createProxy)(String.raw`C:\Users\DELL\Desktop\Spaces(Client)\app\_components\UpdateProfileForm.js#default`);var o=a(76177);let d={title:"Profile"};async function l(){let e=await (0,o.I8)(),t=await (0,s.PT)(e.user.email);return(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"font-semibold text-2xl text-accent-400 mb-4",children:"Update your guest profile"}),r.jsx("p",{className:"text-lg mb-8 text-primary-200",children:"Providing the following information will make your check-in process faster and smoother. See you soon!"}),r.jsx(n,{guest:t,children:r.jsx(i,{name:"nationality",id:"nationality",className:"px-5 py-3 bg-primary-200 text-primary-800 w-full shadow-sm rounded-sm",defaultCountry:t.nationality})})]})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,782,362,650,792,822],()=>a(28798));module.exports=r})();