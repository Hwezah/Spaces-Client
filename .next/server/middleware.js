(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[826],{67:e=>{"use strict";e.exports=require("node:async_hooks")},195:e=>{"use strict";e.exports=require("node:buffer")},776:(e,t,r)=>{"use strict";let n,i,a,s,o;r.r(t),r.d(t,{default:()=>c3});var l,c,u,d,h,p,f,g,m,y,w,b,v,_,S,k={};r.r(k),r.d(k,{parse:()=>na,serialize:()=>nl});var E={};async function x(){let e="_ENTRIES"in globalThis&&_ENTRIES.middleware_instrumentation&&(await _ENTRIES.middleware_instrumentation).register;if(e)try{await e()}catch(e){throw e.message=`An error occurred while loading instrumentation hook: ${e.message}`,e}}r.r(E),r.d(E,{config:()=>c0,middleware:()=>cQ});let T=null;function A(){return T||(T=x()),T}function P(e){return`The edge runtime does not support Node.js '${e}' module.
Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`}process!==r.g.process&&(process.env=r.g.process.env,r.g.process=process),Object.defineProperty(globalThis,"__import_unsupported",{value:function(e){let t=new Proxy(function(){},{get(t,r){if("then"===r)return{};throw Error(P(e))},construct(){throw Error(P(e))},apply(r,n,i){if("function"==typeof i[0])return i[0](t);throw Error(P(e))}});return new Proxy({},{get:()=>t})},enumerable:!1,configurable:!1}),A();class C extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class O extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class R extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}let I={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"};function j(e){var t,r,n,i,a,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,a=!1;l();)if(","===(r=e.charAt(o))){for(n=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(a=!0,o=i,s.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!a||o>=e.length)&&s.push(e.substring(t,e.length))}return s}function $(e){let t={},r=[];if(e)for(let[n,i]of e.entries())"set-cookie"===n.toLowerCase()?(r.push(...j(i)),t[n]=1===r.length?r[0]:r):t[n]=i;return t}function U(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}({...I,GROUP:{serverOnly:[I.reactServerComponents,I.actionBrowser,I.appMetadataRoute,I.appRouteHandler,I.instrument],clientOnly:[I.serverSideRendering,I.appPagesBrowser],nonClientServerTarget:[I.middleware,I.api],app:[I.reactServerComponents,I.actionBrowser,I.appMetadataRoute,I.appRouteHandler,I.serverSideRendering,I.appPagesBrowser,I.shared,I.instrument]}});let N=Symbol("response"),L=Symbol("passThrough"),D=Symbol("waitUntil");class M{constructor(e){this[D]=[],this[L]=!1}respondWith(e){this[N]||(this[N]=Promise.resolve(e))}passThroughOnException(){this[L]=!0}waitUntil(e){this[D].push(e)}}class H extends M{constructor(e){super(e.request),this.sourcePage=e.page}get request(){throw new C({page:this.sourcePage})}respondWith(){throw new C({page:this.sourcePage})}}function W(e){return e.replace(/\/$/,"")||"/"}function K(e){let t=e.indexOf("#"),r=e.indexOf("?"),n=r>-1&&(t<0||r<t);return n||t>-1?{pathname:e.substring(0,n?r:t),query:n?e.substring(r,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}function B(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=K(e);return""+t+r+n+i}function q(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:r,query:n,hash:i}=K(e);return""+r+t+n+i}function J(e,t){if("string"!=typeof e)return!1;let{pathname:r}=K(e);return r===t||r.startsWith(t+"/")}function V(e,t){let r;let n=e.split("/");return(t||[]).some(t=>!!n[1]&&n[1].toLowerCase()===t.toLowerCase()&&(r=t,n.splice(1,1),e=n.join("/")||"/",!0)),{pathname:e,detectedLocale:r}}let F=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function z(e,t){return new URL(String(e).replace(F,"localhost"),t&&String(t).replace(F,"localhost"))}let G=Symbol("NextURLInternal");class X{constructor(e,t,r){let n,i;"object"==typeof t&&"pathname"in t||"string"==typeof t?(n=t,i=r||{}):i=r||t||{},this[G]={url:z(e,n??i.base),options:i,basePath:""},this.analyze()}analyze(){var e,t,r,n,i;let a=function(e,t){var r,n;let{basePath:i,i18n:a,trailingSlash:s}=null!=(r=t.nextConfig)?r:{},o={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):s};i&&J(o.pathname,i)&&(o.pathname=function(e,t){if(!J(e,t))return e;let r=e.slice(t.length);return r.startsWith("/")?r:"/"+r}(o.pathname,i),o.basePath=i);let l=o.pathname;if(o.pathname.startsWith("/_next/data/")&&o.pathname.endsWith(".json")){let e=o.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),r=e[0];o.buildId=r,l="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(o.pathname=l)}if(a){let e=t.i18nProvider?t.i18nProvider.analyze(o.pathname):V(o.pathname,a.locales);o.locale=e.detectedLocale,o.pathname=null!=(n=e.pathname)?n:o.pathname,!e.detectedLocale&&o.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(l):V(l,a.locales)).detectedLocale&&(o.locale=e.detectedLocale)}return o}(this[G].url.pathname,{nextConfig:this[G].options.nextConfig,parseData:!0,i18nProvider:this[G].options.i18nProvider}),s=function(e,t){let r;if((null==t?void 0:t.host)&&!Array.isArray(t.host))r=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;r=e.hostname}return r.toLowerCase()}(this[G].url,this[G].options.headers);this[G].domainLocale=this[G].options.i18nProvider?this[G].options.i18nProvider.detectDomainLocale(s):function(e,t,r){if(e)for(let a of(r&&(r=r.toLowerCase()),e)){var n,i;if(t===(null==(n=a.domain)?void 0:n.split(":",1)[0].toLowerCase())||r===a.defaultLocale.toLowerCase()||(null==(i=a.locales)?void 0:i.some(e=>e.toLowerCase()===r)))return a}}(null==(t=this[G].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,s);let o=(null==(r=this[G].domainLocale)?void 0:r.defaultLocale)||(null==(i=this[G].options.nextConfig)?void 0:null==(n=i.i18n)?void 0:n.defaultLocale);this[G].url.pathname=a.pathname,this[G].defaultLocale=o,this[G].basePath=a.basePath??"",this[G].buildId=a.buildId,this[G].locale=a.locale??o,this[G].trailingSlash=a.trailingSlash}formatPathname(){var e;let t;return t=function(e,t,r,n){if(!t||t===r)return e;let i=e.toLowerCase();return!n&&(J(i,"/api")||J(i,"/"+t.toLowerCase()))?e:B(e,"/"+t)}((e={basePath:this[G].basePath,buildId:this[G].buildId,defaultLocale:this[G].options.forceLocale?void 0:this[G].defaultLocale,locale:this[G].locale,pathname:this[G].url.pathname,trailingSlash:this[G].trailingSlash}).pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix),(e.buildId||!e.trailingSlash)&&(t=W(t)),e.buildId&&(t=q(B(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=B(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:q(t,"/"):W(t)}formatSearch(){return this[G].url.search}get buildId(){return this[G].buildId}set buildId(e){this[G].buildId=e}get locale(){return this[G].locale??""}set locale(e){var t,r;if(!this[G].locale||!(null==(r=this[G].options.nextConfig)?void 0:null==(t=r.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[G].locale=e}get defaultLocale(){return this[G].defaultLocale}get domainLocale(){return this[G].domainLocale}get searchParams(){return this[G].url.searchParams}get host(){return this[G].url.host}set host(e){this[G].url.host=e}get hostname(){return this[G].url.hostname}set hostname(e){this[G].url.hostname=e}get port(){return this[G].url.port}set port(e){this[G].url.port=e}get protocol(){return this[G].url.protocol}set protocol(e){this[G].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[G].url=z(e),this.analyze()}get origin(){return this[G].url.origin}get pathname(){return this[G].url.pathname}set pathname(e){this[G].url.pathname=e}get hash(){return this[G].url.hash}set hash(e){this[G].url.hash=e}get search(){return this[G].url.search}set search(e){this[G].url.search=e}get password(){return this[G].url.password}set password(e){this[G].url.password=e}get username(){return this[G].url.username}set username(e){this[G].url.username=e}get basePath(){return this[G].basePath}set basePath(e){this[G].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new X(String(this),this[G].options)}}var Y=r(945);let Z=Symbol("internal request");class Q extends Request{constructor(e,t={}){let r="string"!=typeof e&&"url"in e?e.url:String(e);U(r),e instanceof Request?super(e,t):super(r,t);let n=new X(r,{headers:$(this.headers),nextConfig:t.nextConfig});this[Z]={cookies:new Y.RequestCookies(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:n,url:n.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[Z].cookies}get geo(){return this[Z].geo}get ip(){return this[Z].ip}get nextUrl(){return this[Z].nextUrl}get page(){throw new O}get ua(){throw new R}get url(){return this[Z].url}}class ee{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}let et=Symbol("internal response"),er=new Set([301,302,303,307,308]);function en(e,t){var r;if(null==e?void 0:null==(r=e.request)?void 0:r.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let r=[];for(let[n,i]of e.request.headers)t.set("x-middleware-request-"+n,i),r.push(n);t.set("x-middleware-override-headers",r.join(","))}}class ei extends Response{constructor(e,t={}){super(e,t);let r=this.headers,n=new Proxy(new Y.ResponseCookies(r),{get(e,n,i){switch(n){case"delete":case"set":return(...i)=>{let a=Reflect.apply(e[n],e,i),s=new Headers(r);return a instanceof Y.ResponseCookies&&r.set("x-middleware-set-cookie",a.getAll().map(e=>(0,Y.stringifyCookie)(e)).join(",")),en(t,s),a};default:return ee.get(e,n,i)}}});this[et]={cookies:n,url:t.url?new X(t.url,{headers:$(r),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[et].cookies}static json(e,t){let r=Response.json(e,t);return new ei(r.body,r)}static redirect(e,t){let r="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!er.has(r))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let n="object"==typeof t?t:{},i=new Headers(null==n?void 0:n.headers);return i.set("Location",U(e)),new ei(null,{...n,headers:i,status:r})}static rewrite(e,t){let r=new Headers(null==t?void 0:t.headers);return r.set("x-middleware-rewrite",U(e)),en(t,r),new ei(null,{...t,headers:r})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),en(e,t),new ei(null,{...e,headers:t})}}function ea(e,t){let r="string"==typeof t?new URL(t):t,n=new URL(e,t),i=r.protocol+"//"+r.host;return n.protocol+"//"+n.host===i?n.toString().replace(i,""):n.toString()}let es=[["RSC"],["Next-Router-State-Tree"],["Next-Router-Prefetch"]],eo=["__nextFallback","__nextLocale","__nextInferredLocaleFromDefault","__nextDefaultLocale","__nextIsNotFound","_rsc"],el=["__nextDataReq"];class ec extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new ec}}class eu extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return ee.get(t,r,n);let i=r.toLowerCase(),a=Object.keys(e).find(e=>e.toLowerCase()===i);if(void 0!==a)return ee.get(t,a,n)},set(t,r,n,i){if("symbol"==typeof r)return ee.set(t,r,n,i);let a=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===a);return ee.set(t,s??r,n,i)},has(t,r){if("symbol"==typeof r)return ee.has(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==i&&ee.has(t,i)},deleteProperty(t,r){if("symbol"==typeof r)return ee.deleteProperty(t,r);let n=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===i||ee.deleteProperty(t,i)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return ec.callable;default:return ee.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new eu(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}var ed=r(452);class eh extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new eh}}class ep{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return eh.callable;default:return ee.get(e,t,r)}}})}}let ef=Symbol.for("next.mutated.cookies");class eg{static wrap(e,t){let r=new Y.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let n=[],i=new Set,a=()=>{let e=ed.A.getStore();if(e&&(e.pathWasRevalidated=!0),n=r.getAll().filter(e=>i.has(e.name)),t){let e=[];for(let t of n){let r=new Y.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}};return new Proxy(r,{get(e,t,r){switch(t){case ef:return n;case"delete":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{e.delete(...t)}finally{a()}};case"set":return function(...t){i.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t)}finally{a()}};default:return ee.get(e,t,r)}}})}}!function(e){e.handleRequest="BaseServer.handleRequest",e.run="BaseServer.run",e.pipe="BaseServer.pipe",e.getStaticHTML="BaseServer.getStaticHTML",e.render="BaseServer.render",e.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",e.renderToResponse="BaseServer.renderToResponse",e.renderToHTML="BaseServer.renderToHTML",e.renderError="BaseServer.renderError",e.renderErrorToResponse="BaseServer.renderErrorToResponse",e.renderErrorToHTML="BaseServer.renderErrorToHTML",e.render404="BaseServer.render404"}(nB||(nB={})),function(e){e.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents"}(nq||(nq={})),function(e){e.getRequestHandler="NextServer.getRequestHandler",e.getServer="NextServer.getServer",e.getServerRequestHandler="NextServer.getServerRequestHandler",e.createServer="createServer.createServer"}(nJ||(nJ={})),function(e){e.compression="NextNodeServer.compression",e.getBuildId="NextNodeServer.getBuildId",e.createComponentTree="NextNodeServer.createComponentTree",e.clientComponentLoading="NextNodeServer.clientComponentLoading",e.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",e.generateStaticRoutes="NextNodeServer.generateStaticRoutes",e.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",e.generatePublicRoutes="NextNodeServer.generatePublicRoutes",e.generateImageRoutes="NextNodeServer.generateImageRoutes.route",e.sendRenderResult="NextNodeServer.sendRenderResult",e.proxyRequest="NextNodeServer.proxyRequest",e.runApi="NextNodeServer.runApi",e.render="NextNodeServer.render",e.renderHTML="NextNodeServer.renderHTML",e.imageOptimizer="NextNodeServer.imageOptimizer",e.getPagePath="NextNodeServer.getPagePath",e.getRoutesManifest="NextNodeServer.getRoutesManifest",e.findPageComponents="NextNodeServer.findPageComponents",e.getFontManifest="NextNodeServer.getFontManifest",e.getServerComponentManifest="NextNodeServer.getServerComponentManifest",e.getRequestHandler="NextNodeServer.getRequestHandler",e.renderToHTML="NextNodeServer.renderToHTML",e.renderError="NextNodeServer.renderError",e.renderErrorToHTML="NextNodeServer.renderErrorToHTML",e.render404="NextNodeServer.render404",e.startResponse="NextNodeServer.startResponse",e.route="route",e.onProxyReq="onProxyReq",e.apiResolver="apiResolver",e.internalFetch="internalFetch"}(nV||(nV={})),(nF||(nF={})).startServer="startServer.startServer",function(e){e.getServerSideProps="Render.getServerSideProps",e.getStaticProps="Render.getStaticProps",e.renderToString="Render.renderToString",e.renderDocument="Render.renderDocument",e.createBodyResult="Render.createBodyResult"}(nz||(nz={})),function(e){e.renderToString="AppRender.renderToString",e.renderToReadableStream="AppRender.renderToReadableStream",e.getBodyResult="AppRender.getBodyResult",e.fetch="AppRender.fetch"}(nG||(nG={})),(nX||(nX={})).executeRoute="Router.executeRoute",(nY||(nY={})).runHandler="Node.runHandler",(nZ||(nZ={})).runHandler="AppRouteRouteHandlers.runHandler",function(e){e.generateMetadata="ResolveMetadata.generateMetadata",e.generateViewport="ResolveMetadata.generateViewport"}(nQ||(nQ={})),(n0||(n0={})).execute="Middleware.execute";let em=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],ey=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"],{context:ew,propagation:eb,trace:ev,SpanStatusCode:e_,SpanKind:eS,ROOT_CONTEXT:ek}=n=r(439),eE=e=>null!==e&&"object"==typeof e&&"function"==typeof e.then,ex=(e,t)=>{(null==t?void 0:t.bubble)===!0?e.setAttribute("next.bubble",!0):(t&&e.recordException(t),e.setStatus({code:e_.ERROR,message:null==t?void 0:t.message})),e.end()},eT=new Map,eA=n.createContextKey("next.rootSpanId"),eP=0,eC=()=>eP++;class eO{getTracerInstance(){return ev.getTracer("next.js","0.0.1")}getContext(){return ew}getActiveScopeSpan(){return ev.getSpan(null==ew?void 0:ew.active())}withPropagatedContext(e,t,r){let n=ew.active();if(ev.getSpanContext(n))return t();let i=eb.extract(n,e,r);return ew.with(i,t)}trace(...e){var t;let[r,n,i]=e,{fn:a,options:s}="function"==typeof n?{fn:n,options:{}}:{fn:i,options:{...n}},o=s.spanName??r;if(!em.includes(r)&&"1"!==process.env.NEXT_OTEL_VERBOSE||s.hideSpan)return a();let l=this.getSpanContext((null==s?void 0:s.parentSpan)??this.getActiveScopeSpan()),c=!1;l?(null==(t=ev.getSpanContext(l))?void 0:t.isRemote)&&(c=!0):(l=(null==ew?void 0:ew.active())??ek,c=!0);let u=eC();return s.attributes={"next.span_name":o,"next.span_type":r,...s.attributes},ew.with(l.setValue(eA,u),()=>this.getTracerInstance().startActiveSpan(o,s,e=>{let t="performance"in globalThis?globalThis.performance.now():void 0,n=()=>{eT.delete(u),t&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&ey.includes(r||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(r.split(".").pop()||"").replace(/[A-Z]/g,e=>"-"+e.toLowerCase())}`,{start:t,end:performance.now()})};c&&eT.set(u,new Map(Object.entries(s.attributes??{})));try{if(a.length>1)return a(e,t=>ex(e,t));let t=a(e);if(eE(t))return t.then(t=>(e.end(),t)).catch(t=>{throw ex(e,t),t}).finally(n);return e.end(),n(),t}catch(t){throw ex(e,t),n(),t}}))}wrap(...e){let t=this,[r,n,i]=3===e.length?e:[e[0],{},e[1]];return em.includes(r)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=n;"function"==typeof e&&"function"==typeof i&&(e=e.apply(this,arguments));let a=arguments.length-1,s=arguments[a];if("function"!=typeof s)return t.trace(r,e,()=>i.apply(this,arguments));{let n=t.getContext().bind(ew.active(),s);return t.trace(r,e,(e,t)=>(arguments[a]=function(e){return null==t||t(e),n.apply(this,arguments)},i.apply(this,arguments)))}}:i}startSpan(...e){let[t,r]=e,n=this.getSpanContext((null==r?void 0:r.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,r,n)}getSpanContext(e){return e?ev.setSpan(ew.active(),e):void 0}getRootSpanAttributes(){let e=ew.active().getValue(eA);return eT.get(e)}}let eR=(()=>{let e=new eO;return()=>e})(),eI="__prerender_bypass";Symbol("__next_preview_data"),Symbol(eI);class ej{constructor(e,t,r,n){var i;let a=e&&function(e,t){let r=eu.from(e.headers);return{isOnDemandRevalidate:r.get("x-prerender-revalidate")===t.previewModeId,revalidateOnlyGenerated:r.has("x-prerender-revalidate-if-generated")}}(t,e).isOnDemandRevalidate,s=null==(i=r.get(eI))?void 0:i.value;this.isEnabled=!!(!a&&s&&e&&s===e.previewModeId),this._previewModeId=null==e?void 0:e.previewModeId,this._mutableCookies=n}enable(){if(!this._previewModeId)throw Error("Invariant: previewProps missing previewModeId this should never happen");this._mutableCookies.set({name:eI,value:this._previewModeId,httpOnly:!0,sameSite:"none",secure:!0,path:"/"})}disable(){this._mutableCookies.set({name:eI,value:"",httpOnly:!0,sameSite:"none",secure:!0,path:"/",expires:new Date(0)})}}function e$(e,t){if("x-middleware-set-cookie"in e.headers&&"string"==typeof e.headers["x-middleware-set-cookie"]){let r=e.headers["x-middleware-set-cookie"],n=new Headers;for(let e of j(r))n.append("set-cookie",e);for(let e of new Y.ResponseCookies(n).getAll())t.set(e)}}let eU={wrap(e,{req:t,res:r,renderOpts:n},i){let a;function s(e){r&&r.setHeader("Set-Cookie",e)}n&&"previewProps"in n&&(a=n.previewProps);let o={},l={get headers(){return o.headers||(o.headers=function(e){let t=eu.from(e);for(let e of es)t.delete(e.toString().toLowerCase());return eu.seal(t)}(t.headers)),o.headers},get cookies(){if(!o.cookies){let e=new Y.RequestCookies(eu.from(t.headers));e$(t,e),o.cookies=ep.seal(e)}return o.cookies},get mutableCookies(){if(!o.mutableCookies){let e=function(e,t){let r=new Y.RequestCookies(eu.from(e));return eg.wrap(r,t)}(t.headers,(null==n?void 0:n.onUpdateCookies)||(r?s:void 0));e$(t,e),o.mutableCookies=e}return o.mutableCookies},get draftMode(){return o.draftMode||(o.draftMode=new ej(a,t,this.cookies,this.mutableCookies)),o.draftMode},reactLoadableManifest:(null==n?void 0:n.reactLoadableManifest)||{},assetPrefix:(null==n?void 0:n.assetPrefix)||""};return e.run(l,i,l)}};var eN=r(228);let eL=(0,eN.P)();function eD(e){let t=eL.getStore();if(t)return t;throw Error("`"+e+"` was called outside a request scope. Read more: https://nextjs.org/docs/messages/next-dynamic-api-wrong-context")}function eM(){return{previewModeId:process.env.__NEXT_PREVIEW_MODE_ID,previewModeSigningKey:process.env.__NEXT_PREVIEW_MODE_SIGNING_KEY||"",previewModeEncryptionKey:process.env.__NEXT_PREVIEW_MODE_ENCRYPTION_KEY||""}}class eH extends Q{constructor(e){super(e.input,e.init),this.sourcePage=e.page}get request(){throw new C({page:this.sourcePage})}respondWith(){throw new C({page:this.sourcePage})}waitUntil(){throw new C({page:this.sourcePage})}}let eW={keys:e=>Array.from(e.keys()),get:(e,t)=>e.get(t)??void 0},eK=(e,t)=>eR().withPropagatedContext(e.headers,t,eW),eB=!1;async function eq(e){let t,n;!function(){if(!eB&&(eB=!0,"true"===process.env.NEXT_PRIVATE_TEST_PROXY)){let{interceptTestApis:e,wrapRequestHandler:t}=r(177);e(),eK=t(eK)}}(),await A();let i=void 0!==self.__BUILD_MANIFEST;e.request.url=e.request.url.replace(/\.rsc($|\?)/,"$1");let a=new X(e.request.url,{headers:e.request.headers,nextConfig:e.request.nextConfig});for(let e of[...a.searchParams.keys()]){let t=a.searchParams.getAll(e);!function(e,t){for(let r of["nxtP","nxtI"])e!==r&&e.startsWith(r)&&t(e.substring(r.length))}(e,r=>{for(let e of(a.searchParams.delete(r),t))a.searchParams.append(r,e);a.searchParams.delete(e)})}let s=a.buildId;a.buildId="";let o=e.request.headers["x-nextjs-data"];o&&"/index"===a.pathname&&(a.pathname="/");let l=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))for(let e of Array.isArray(n)?n:[n])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(r,e));return t}(e.request.headers),c=new Map;if(!i)for(let e of es){let t=e.toString().toLowerCase();l.get(t)&&(c.set(t,l.get(t)),l.delete(t))}let u=new eH({page:e.page,input:(function(e,t){let r="string"==typeof e,n=r?new URL(e):e;for(let e of eo)n.searchParams.delete(e);if(t)for(let e of el)n.searchParams.delete(e);return r?n.toString():n})(a,!0).toString(),init:{body:e.request.body,geo:e.request.geo,headers:l,ip:e.request.ip,method:e.request.method,nextConfig:e.request.nextConfig,signal:e.request.signal}});o&&Object.defineProperty(u,"__isData",{enumerable:!1,value:!0}),!globalThis.__incrementalCache&&e.IncrementalCache&&(globalThis.__incrementalCache=new e.IncrementalCache({appDir:!0,fetchCache:!0,minimalMode:!0,fetchCacheKeyPrefix:"",dev:!1,requestHeaders:e.request.headers,requestProtocol:"https",getPrerenderManifest:()=>({version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:eM()})}));let d=new H({request:u,page:e.page});if((t=await eK(u,()=>"/middleware"===e.page||"/src/middleware"===e.page?eR().trace(n0.execute,{spanName:`middleware ${u.method} ${u.nextUrl.pathname}`,attributes:{"http.target":u.nextUrl.pathname,"http.method":u.method}},()=>eU.wrap(eL,{req:u,renderOpts:{onUpdateCookies:e=>{n=e},previewProps:eM()}},()=>e.handler(u,d))):e.handler(u,d)))&&!(t instanceof Response))throw TypeError("Expected an instance of Response to be returned");t&&n&&t.headers.set("set-cookie",n);let h=null==t?void 0:t.headers.get("x-middleware-rewrite");if(t&&h&&!i){let r=new X(h,{forceLocale:!0,headers:e.request.headers,nextConfig:e.request.nextConfig});r.host===u.nextUrl.host&&(r.buildId=s||r.buildId,t.headers.set("x-middleware-rewrite",String(r)));let n=ea(String(r),String(a));o&&t.headers.set("x-nextjs-rewrite",n)}let p=null==t?void 0:t.headers.get("Location");if(t&&p&&!i){let r=new X(p,{forceLocale:!1,headers:e.request.headers,nextConfig:e.request.nextConfig});t=new Response(t.body,t),r.host===u.nextUrl.host&&(r.buildId=s||r.buildId,t.headers.set("Location",String(r))),o&&(t.headers.delete("Location"),t.headers.set("x-nextjs-redirect",ea(String(r),String(a))))}let f=t||ei.next(),g=f.headers.get("x-middleware-override-headers"),m=[];if(g){for(let[e,t]of c)f.headers.set(`x-middleware-request-${e}`,t),m.push(e);m.length>0&&f.headers.set("x-middleware-override-headers",g+","+m.join(","))}return{response:f,waitUntil:Promise.all(d[D]),fetchMetrics:u.fetchMetrics}}var eJ=function(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},eV=function(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};function eF(e){let t=e?"__Secure-":"";return{sessionToken:{name:`${t}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},callbackUrl:{name:`${t}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},csrfToken:{name:`${e?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},pkceCodeVerifier:{name:`${t}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},state:{name:`${t}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}},nonce:{name:`${t}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e}},webauthnChallenge:{name:`${t}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:e,maxAge:900}}}}class ez{constructor(e,t,r){if(n1.add(this),n2.set(this,{}),n5.set(this,void 0),n3.set(this,void 0),eJ(this,n3,r,"f"),eJ(this,n5,e,"f"),!t)return;let{name:n}=e;for(let[e,r]of Object.entries(t))e.startsWith(n)&&r&&(eV(this,n2,"f")[e]=r)}get value(){return Object.keys(eV(this,n2,"f")).sort((e,t)=>parseInt(e.split(".").pop()||"0")-parseInt(t.split(".").pop()||"0")).map(e=>eV(this,n2,"f")[e]).join("")}chunk(e,t){let r=eV(this,n1,"m",n4).call(this);for(let n of eV(this,n1,"m",n6).call(this,{name:eV(this,n5,"f").name,value:e,options:{...eV(this,n5,"f").options,...t}}))r[n.name]=n;return Object.values(r)}clean(){return Object.values(eV(this,n1,"m",n4).call(this))}}n2=new WeakMap,n5=new WeakMap,n3=new WeakMap,n1=new WeakSet,n6=function(e){let t=Math.ceil(e.value.length/3936);if(1===t)return eV(this,n2,"f")[e.name]=e.value,[e];let r=[];for(let n=0;n<t;n++){let t=`${e.name}.${n}`,i=e.value.substr(3936*n,3936);r.push({...e,name:t,value:i}),eV(this,n2,"f")[t]=i}return eV(this,n3,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:e.value.length,chunks:r.map(e=>e.value.length+160)}),r},n4=function(){let e={};for(let t in eV(this,n2,"f"))delete eV(this,n2,"f")?.[t],e[t]={name:t,value:"",options:{...eV(this,n5,"f").options,maxAge:0}};return e};class eG extends Error{constructor(e,t){e instanceof Error?super(void 0,{cause:{err:e,...e.cause,...t}}):"string"==typeof e?(t instanceof Error&&(t={err:t,...t.cause}),super(e,t)):super(void 0,e),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);let r=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${r}`}}class eX extends eG{}eX.kind="signIn";class eY extends eG{}eY.type="AdapterError";class eZ extends eG{}eZ.type="AccessDenied";class eQ extends eG{}eQ.type="CallbackRouteError";class e0 extends eG{}e0.type="ErrorPageLoop";class e1 extends eG{}e1.type="EventError";class e2 extends eG{}e2.type="InvalidCallbackUrl";class e5 extends eX{constructor(){super(...arguments),this.code="credentials"}}e5.type="CredentialsSignin";class e3 extends eG{}e3.type="InvalidEndpoints";class e6 extends eG{}e6.type="InvalidCheck";class e4 extends eG{}e4.type="JWTSessionError";class e8 extends eG{}e8.type="MissingAdapter";class e9 extends eG{}e9.type="MissingAdapterMethods";class e7 extends eG{}e7.type="MissingAuthorize";class te extends eG{}te.type="MissingSecret";class tt extends eX{}tt.type="OAuthAccountNotLinked";class tr extends eX{}tr.type="OAuthCallbackError";class tn extends eG{}tn.type="OAuthProfileParseError";class ti extends eG{}ti.type="SessionTokenError";class ta extends eX{}ta.type="OAuthSignInError";class ts extends eX{}ts.type="EmailSignInError";class to extends eG{}to.type="SignOutError";class tl extends eG{}tl.type="UnknownAction";class tc extends eG{}tc.type="UnsupportedStrategy";class tu extends eG{}tu.type="InvalidProvider";class td extends eG{}td.type="UntrustedHost";class th extends eG{}th.type="Verification";class tp extends eX{}tp.type="MissingCSRF";let tf=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class tg extends eG{}tg.type="DuplicateConditionalUI";class tm extends eG{}tm.type="MissingWebAuthnAutocomplete";class ty extends eG{}ty.type="WebAuthnVerificationError";class tw extends eX{}tw.type="AccountNotLinked";class tb extends eG{}tb.type="ExperimentalFeatureNotEnabled";let tv=!1;function t_(e,t){try{return/^https?:/.test(new URL(e,e.startsWith("/")?t:void 0).protocol)}catch{return!1}}let tS=!1,tk=!1,tE=!1,tx=["createVerificationToken","useVerificationToken","getUserByEmail"],tT=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],tA=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"],tP=()=>{if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw Error("unable to locate global object")},tC=async(e,t,r,n,i)=>{let{crypto:{subtle:a}}=tP();return new Uint8Array(await a.deriveBits({name:"HKDF",hash:`SHA-${e.substr(3)}`,salt:r,info:n},await a.importKey("raw",t,"HKDF",!1,["deriveBits"]),i<<3))};function tO(e,t){if("string"==typeof e)return new TextEncoder().encode(e);if(!(e instanceof Uint8Array))throw TypeError(`"${t}"" must be an instance of Uint8Array or a string`);return e}async function tR(e,t,r,n,i){return tC(function(e){switch(e){case"sha256":case"sha384":case"sha512":case"sha1":return e;default:throw TypeError('unsupported "digest" value')}}(e),function(e){let t=tO(e,"ikm");if(!t.byteLength)throw TypeError('"ikm" must be at least one byte in length');return t}(t),tO(r,"salt"),function(e){let t=tO(e,"info");if(t.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return t}(n),function(e,t){if("number"!=typeof e||!Number.isInteger(e)||e<1)throw TypeError('"keylen" must be a positive integer');if(e>255*(parseInt(t.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return e}(i,e))}let tI=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(r,t))},tj=new TextEncoder,t$=new TextDecoder;function tU(...e){let t=new Uint8Array(e.reduce((e,{length:t})=>e+t,0)),r=0;for(let n of e)t.set(n,r),r+=n.length;return t}function tN(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function tL(e){let t=new Uint8Array(8);return tN(t,Math.floor(e/4294967296),0),tN(t,e%4294967296,4),t}function tD(e){let t=new Uint8Array(4);return tN(t,e),t}function tM(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof e?e:t$.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=t$.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return function(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}(t)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function tH(e){let t=e;return("string"==typeof t&&(t=tj.encode(t)),Uint8Array.prototype.toBase64)?t.toBase64({alphabet:"base64url",omitPadding:!0}):(function(e){if(Uint8Array.prototype.toBase64)return e.toBase64();let t=[];for(let r=0;r<e.length;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join(""))})(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}class tW extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class tK extends tW{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(e,t,r="unspecified",n="unspecified"){super(e,{cause:{claim:r,reason:n,payload:t}}),this.claim=r,this.reason=n,this.payload=t}}class tB extends tW{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(e,t,r="unspecified",n="unspecified"){super(e,{cause:{claim:r,reason:n,payload:t}}),this.claim=r,this.reason=n,this.payload=t}}class tq extends tW{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class tJ extends tW{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class tV extends tW{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(e="decryption operation failed",t){super(e,t)}}class tF extends tW{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class tz extends tW{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class tG extends tW{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class tX extends tW{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}function tY(e){if(!tZ(e))throw Error("CryptoKey instance expected")}function tZ(e){return e?.[Symbol.toStringTag]==="CryptoKey"}function tQ(e){return e?.[Symbol.toStringTag]==="KeyObject"}let t0=e=>tZ(e)||tQ(e),t1=e=>{if(!function(e){return"object"==typeof e&&null!==e}(e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t};function t2(e){return t1(e)&&"string"==typeof e.kty}function t5(e,t,...r){if((r=r.filter(Boolean)).length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}let t3=(e,...t)=>t5("Key must be ",e,...t);function t6(e,t,...r){return t5(`Key for the ${e} algorithm must be `,t,...r)}async function t4(e){if(tQ(e)){if("secret"!==e.type)return e.export({format:"jwk"});e=e.export()}if(e instanceof Uint8Array)return{kty:"oct",k:tH(e)};if(!tZ(e))throw TypeError(t3(e,"CryptoKey","KeyObject","Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:n,use:i,...a}=await crypto.subtle.exportKey("jwk",e);return a}async function t8(e){return t4(e)}let t9=(e,t)=>{if("string"!=typeof e||!e)throw new tG(`${t} missing or invalid`)};async function t7(e,t){let r,n;if(t2(e))r=e;else if(t0(e))r=await t8(e);else throw TypeError(t3(e,"CryptoKey","KeyObject","JSON Web Key"));if("sha256"!==(t??="sha256")&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(r.kty){case"EC":t9(r.crv,'"crv" (Curve) Parameter'),t9(r.x,'"x" (X Coordinate) Parameter'),t9(r.y,'"y" (Y Coordinate) Parameter'),n={crv:r.crv,kty:r.kty,x:r.x,y:r.y};break;case"OKP":t9(r.crv,'"crv" (Subtype of Key Pair) Parameter'),t9(r.x,'"x" (Public Key) Parameter'),n={crv:r.crv,kty:r.kty,x:r.x};break;case"RSA":t9(r.e,'"e" (Exponent) Parameter'),t9(r.n,'"n" (Modulus) Parameter'),n={e:r.e,kty:r.kty,n:r.n};break;case"oct":t9(r.k,'"k" (Key Value) Parameter'),n={k:r.k,kty:r.kty};break;default:throw new tJ('"kty" (Key Type) Parameter missing or unsupported')}let i=tj.encode(JSON.stringify(n));return tH(await tI(t,i))}let re=Symbol();function rt(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new tJ(`Unsupported JWE Algorithm: ${e}`)}}let rr=e=>crypto.getRandomValues(new Uint8Array(rt(e)>>3)),rn=(e,t)=>{if(t.length<<3!==rt(e))throw new tF("Invalid Initialization Vector length")},ri=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new tF(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)};function ra(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function rs(e,t){return e.name===t}function ro(e,t,r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!rs(e.algorithm,"AES-GCM"))throw ra("AES-GCM");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw ra(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!rs(e.algorithm,"AES-KW"))throw ra("AES-KW");let r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw ra(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":break;default:throw ra("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!rs(e.algorithm,"PBKDF2"))throw ra("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!rs(e.algorithm,"RSA-OAEP"))throw ra("RSA-OAEP");let r=parseInt(t.slice(9),10)||1;if(parseInt(e.algorithm.hash.name.slice(4),10)!==r)throw ra(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}!function(e,t){if(t&&!e.usages.includes(t))throw TypeError(`CryptoKey does not support this operation, its usages must include ${t}.`)}(e,r)}async function rl(e,t,r,n,i){if(!(r instanceof Uint8Array))throw TypeError(t3(r,"Uint8Array"));let a=parseInt(e.slice(1,4),10),s=await crypto.subtle.importKey("raw",r.subarray(a>>3),"AES-CBC",!1,["encrypt"]),o=await crypto.subtle.importKey("raw",r.subarray(0,a>>3),{hash:`SHA-${a<<1}`,name:"HMAC"},!1,["sign"]),l=new Uint8Array(await crypto.subtle.encrypt({iv:n,name:"AES-CBC"},s,t)),c=tU(i,n,l,tL(i.length<<3));return{ciphertext:l,tag:new Uint8Array((await crypto.subtle.sign("HMAC",o,c)).slice(0,a>>3)),iv:n}}async function rc(e,t,r,n,i){let a;r instanceof Uint8Array?a=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(ro(r,e,"encrypt"),a=r);let s=new Uint8Array(await crypto.subtle.encrypt({additionalData:i,iv:n,name:"AES-GCM",tagLength:128},a,t)),o=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:o,iv:n}}let ru=async(e,t,r,n,i)=>{if(!tZ(r)&&!(r instanceof Uint8Array))throw TypeError(t3(r,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(n?rn(e,n):n=rr(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&ri(r,parseInt(e.slice(-3),10)),rl(e,t,r,n,i);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&ri(r,parseInt(e.slice(1,4),10)),rc(e,t,r,n,i);default:throw new tJ("Unsupported JWE Content Encryption Algorithm")}};function rd(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function rh(e,t,r){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"AES-KW",!0,[r]):(ro(e,t,r),e)}async function rp(e,t,r){let n=await rh(t,e,"wrapKey");rd(n,e);let i=await crypto.subtle.importKey("raw",r,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",i,n,"AES-KW"))}async function rf(e,t,r){let n=await rh(t,e,"unwrapKey");rd(n,e);let i=await crypto.subtle.unwrapKey("raw",r,n,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",i))}function rg(e){return tU(tD(e.length),e)}async function rm(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(tD(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await tI("sha256",n),32*t)}return i.slice(0,t>>3)}async function ry(e,t,r,n,i=new Uint8Array(0),a=new Uint8Array(0)){let s;ro(e,"ECDH"),ro(t,"ECDH","deriveBits");let o=tU(rg(tj.encode(r)),rg(i),rg(a),tD(n));return s="X25519"===e.algorithm.name?256:Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3,rm(new Uint8Array(await crypto.subtle.deriveBits({name:e.algorithm.name,public:e},t,s)),n,o)}function rw(e){switch(e.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return"X25519"===e.algorithm.name}}let rb=(e,t)=>tU(tj.encode(e),new Uint8Array([0]),t);async function rv(e,t,r,n){if(!(e instanceof Uint8Array)||e.length<8)throw new tF("PBES2 Salt Input must be 8 or more octets");let i=rb(t,e),a=parseInt(t.slice(13,16),10),s={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:i},o=await (n instanceof Uint8Array?crypto.subtle.importKey("raw",n,"PBKDF2",!1,["deriveBits"]):(ro(n,t,"deriveBits"),n));return new Uint8Array(await crypto.subtle.deriveBits(s,o,a))}async function r_(e,t,r,n=2048,i=crypto.getRandomValues(new Uint8Array(16))){let a=await rv(i,e,n,t);return{encryptedKey:await rp(e.slice(-6),a,r),p2c:n,p2s:tH(i)}}async function rS(e,t,r,n,i){let a=await rv(i,e,n,t);return rf(e.slice(-6),a,r)}let rk=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}},rE=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new tJ(`alg ${e} is not supported either by JOSE or your javascript runtime`)}};async function rx(e,t,r){return ro(t,e,"encrypt"),rk(e,t),new Uint8Array(await crypto.subtle.encrypt(rE(e),t,r))}async function rT(e,t,r){return ro(t,e,"decrypt"),rk(e,t),new Uint8Array(await crypto.subtle.decrypt(rE(e),t,r))}let rA=async e=>{if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:t,keyUsages:r}=function(e){let t,r;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":case"EdDSA":t={name:"Ed25519"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new tJ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new tJ('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),n={...e};return delete n.alg,delete n.use,crypto.subtle.importKey("jwk",n,t,e.ext??!e.d,e.key_ops??r)},rP=async(e,t,r,n=!1)=>{let a=(i||=new WeakMap).get(e);if(a?.[r])return a[r];let s=await rA({...t,alg:r});return n&&Object.freeze(e),a?a[r]=s:i.set(e,{[r]:s}),s},rC=(e,t)=>{let r;let n=(i||=new WeakMap).get(e);if(n?.[t])return n[t];let a="public"===e.type,s=!!a;if("x25519"===e.asymmetricKeyType){switch(t){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}r=e.toCryptoKey(e.asymmetricKeyType,s,a?[]:["deriveBits"])}if("ed25519"===e.asymmetricKeyType){if("EdDSA"!==t&&"Ed25519"!==t)throw TypeError("given KeyObject instance cannot be used for this algorithm");r=e.toCryptoKey(e.asymmetricKeyType,s,[a?"verify":"sign"])}if("rsa"===e.asymmetricKeyType){let n;switch(t){case"RSA-OAEP":n="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":n="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":n="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":n="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(t.startsWith("RSA-OAEP"))return e.toCryptoKey({name:"RSA-OAEP",hash:n},s,a?["encrypt"]:["decrypt"]);r=e.toCryptoKey({name:t.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:n},s,[a?"verify":"sign"])}if("ec"===e.asymmetricKeyType){let n=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(e.asymmetricKeyDetails?.namedCurve);if(!n)throw TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===t&&"P-256"===n&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:n},s,[a?"verify":"sign"])),"ES384"===t&&"P-384"===n&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:n},s,[a?"verify":"sign"])),"ES512"===t&&"P-521"===n&&(r=e.toCryptoKey({name:"ECDSA",namedCurve:n},s,[a?"verify":"sign"])),t.startsWith("ECDH-ES")&&(r=e.toCryptoKey({name:"ECDH",namedCurve:n},s,a?[]:["deriveBits"]))}if(!r)throw TypeError("given KeyObject instance cannot be used for this algorithm");return n?n[t]=r:i.set(e,{[t]:r}),r},rO=async(e,t)=>{if(e instanceof Uint8Array||tZ(e))return e;if(tQ(e)){if("secret"===e.type)return e.export();if("toCryptoKey"in e&&"function"==typeof e.toCryptoKey)try{return rC(e,t)}catch(e){if(e instanceof TypeError)throw e}let r=e.export({format:"jwk"});return rP(e,r,t)}if(t2(e))return e.k?tM(e.k):rP(e,e,t,!0);throw Error("unreachable")};function rR(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new tJ(`Unsupported JWE Algorithm: ${e}`)}}let rI=e=>crypto.getRandomValues(new Uint8Array(rR(e)>>3));async function rj(e,t){if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let r={name:"HMAC",hash:"SHA-256"},n=await crypto.subtle.generateKey(r,!1,["sign"]),i=new Uint8Array(await crypto.subtle.sign(r,n,e)),a=new Uint8Array(await crypto.subtle.sign(r,n,t)),s=0,o=-1;for(;++o<32;)s|=i[o]^a[o];return 0===s}async function r$(e,t,r,n,i,a){let s,o;if(!(t instanceof Uint8Array))throw TypeError(t3(t,"Uint8Array"));let l=parseInt(e.slice(1,4),10),c=await crypto.subtle.importKey("raw",t.subarray(l>>3),"AES-CBC",!1,["decrypt"]),u=await crypto.subtle.importKey("raw",t.subarray(0,l>>3),{hash:`SHA-${l<<1}`,name:"HMAC"},!1,["sign"]),d=tU(a,n,r,tL(a.length<<3)),h=new Uint8Array((await crypto.subtle.sign("HMAC",u,d)).slice(0,l>>3));try{s=await rj(i,h)}catch{}if(!s)throw new tV;try{o=new Uint8Array(await crypto.subtle.decrypt({iv:n,name:"AES-CBC"},c,r))}catch{}if(!o)throw new tV;return o}async function rU(e,t,r,n,i,a){let s;t instanceof Uint8Array?s=await crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(ro(t,e,"decrypt"),s=t);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:a,iv:n,name:"AES-GCM",tagLength:128},s,tU(r,i)))}catch{throw new tV}}let rN=async(e,t,r,n,i,a)=>{if(!tZ(t)&&!(t instanceof Uint8Array))throw TypeError(t3(t,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!n)throw new tF("JWE Initialization Vector missing");if(!i)throw new tF("JWE Authentication Tag missing");switch(rn(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&ri(t,parseInt(e.slice(-3),10)),r$(e,t,r,n,i,a);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&ri(t,parseInt(e.slice(1,4),10)),rU(e,t,r,n,i,a);default:throw new tJ("Unsupported JWE Content Encryption Algorithm")}};async function rL(e,t,r,n){let i=e.slice(0,7),a=await ru(i,r,t,n,new Uint8Array(0));return{encryptedKey:a.ciphertext,iv:tH(a.iv),tag:tH(a.tag)}}async function rD(e,t,r,n,i){return rN(e.slice(0,7),t,r,n,i,new Uint8Array(0))}let rM=async(e,t,r,n,i={})=>{let a,s,o;switch(e){case"dir":o=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let l;if(tY(r),!rw(r))throw new tJ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:c,apv:u}=i;l=i.epk?await rO(i.epk,e):(await crypto.subtle.generateKey(r.algorithm,!0,["deriveBits"])).privateKey;let{x:d,y:h,crv:p,kty:f}=await t8(l),g=await ry(r,l,"ECDH-ES"===e?t:e,"ECDH-ES"===e?rR(t):parseInt(e.slice(-5,-2),10),c,u);if(s={epk:{x:d,crv:p,kty:f}},"EC"===f&&(s.epk.y=h),c&&(s.apu=tH(c)),u&&(s.apv=tH(u)),"ECDH-ES"===e){o=g;break}o=n||rI(t);let m=e.slice(-6);a=await rp(m,g,o);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o=n||rI(t),tY(r),a=await rx(e,r,o);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{o=n||rI(t);let{p2c:l,p2s:c}=i;({encryptedKey:a,...s}=await r_(e,r,o,l,c));break}case"A128KW":case"A192KW":case"A256KW":o=n||rI(t),a=await rp(e,r,o);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{o=n||rI(t);let{iv:l}=i;({encryptedKey:a,...s}=await rL(e,r,o,l));break}default:throw new tJ('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:o,encryptedKey:a,parameters:s}},rH=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0},rW=(e,t,r,n,i)=>{let a;if(void 0!==i.crit&&n?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let s of(a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!a.has(s))throw new tJ(`Extension Header Parameter "${s}" is not recognized`);if(void 0===i[s])throw new e(`Extension Header Parameter "${s}" is missing`);if(a.get(s)&&void 0===n[s])throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(n.crit)},rK=e=>e?.[Symbol.toStringTag],rB=(e,t,r)=>{if(void 0!==t.use){let e;switch(r){case"sign":case"verify":e="sig";break;case"encrypt":case"decrypt":e="enc"}if(t.use!==e)throw TypeError(`Invalid key for this operation, its "use" must be "${e}" when present`)}if(void 0!==t.alg&&t.alg!==e)throw TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(t.key_ops)){let n;switch(!0){case"sign"===r||"verify"===r:case"dir"===e:case e.includes("CBC-HS"):n=r;break;case e.startsWith("PBES2"):n="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):n=!e.includes("GCM")&&e.endsWith("KW")?"encrypt"===r?"wrapKey":"unwrapKey":r;break;case"encrypt"===r&&e.startsWith("RSA"):n="wrapKey";break;case"decrypt"===r:n=e.startsWith("RSA")?"unwrapKey":"deriveBits"}if(n&&t.key_ops?.includes?.(n)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${n}" when present`)}return!0},rq=(e,t,r)=>{if(!(t instanceof Uint8Array)){if(t2(t)){if(function(e){return"oct"===e.kty&&"string"==typeof e.k}(t)&&rB(e,t,r))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!t0(t))throw TypeError(t6(e,t,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==t.type)throw TypeError(`${rK(t)} instances for symmetric algorithms must be of type "secret"`)}},rJ=(e,t,r)=>{if(t2(t))switch(r){case"decrypt":case"sign":if(function(e){return"oct"!==e.kty&&"string"==typeof e.d}(t)&&rB(e,t,r))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(function(e){return"oct"!==e.kty&&void 0===e.d}(t)&&rB(e,t,r))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!t0(t))throw TypeError(t6(e,t,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===t.type)throw TypeError(`${rK(t)} instances for asymmetric algorithms must not be of type "secret"`);if("public"===t.type)switch(r){case"sign":throw TypeError(`${rK(t)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${rK(t)} instances for asymmetric algorithm decryption must be of type "private"`)}if("private"===t.type)switch(r){case"verify":throw TypeError(`${rK(t)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${rK(t)} instances for asymmetric algorithm encryption must be of type "public"`)}},rV=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(e)||/^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(e)?rq(e,t,r):rJ(e,t,r)};class rF{#e;#t;#r;#n;#i;#a;#s;#o;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#e=e}setKeyManagementParameters(e){if(this.#o)throw TypeError("setKeyManagementParameters can only be called once");return this.#o=e,this}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setSharedUnprotectedHeader(e){if(this.#r)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#r=e,this}setUnprotectedHeader(e){if(this.#n)throw TypeError("setUnprotectedHeader can only be called once");return this.#n=e,this}setAdditionalAuthenticatedData(e){return this.#i=e,this}setContentEncryptionKey(e){if(this.#a)throw TypeError("setContentEncryptionKey can only be called once");return this.#a=e,this}setInitializationVector(e){if(this.#s)throw TypeError("setInitializationVector can only be called once");return this.#s=e,this}async encrypt(e,t){let r,n,i,a,s;if(!this.#t&&!this.#n&&!this.#r)throw new tF("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!rH(this.#t,this.#n,this.#r))throw new tF("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let o={...this.#t,...this.#n,...this.#r};if(rW(tF,new Map,t?.crit,this.#t,o),void 0!==o.zip)throw new tJ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:l,enc:c}=o;if("string"!=typeof l||!l)throw new tF('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof c||!c)throw new tF('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#a&&("dir"===l||"ECDH-ES"===l))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${l}`);rV("dir"===l?c:l,e,"encrypt");{let i;let a=await rO(e,l);({cek:n,encryptedKey:r,parameters:i}=await rM(l,c,a,this.#a,this.#o)),i&&(t&&re in t?this.#n?this.#n={...this.#n,...i}:this.setUnprotectedHeader(i):this.#t?this.#t={...this.#t,...i}:this.setProtectedHeader(i))}a=this.#t?tj.encode(tH(JSON.stringify(this.#t))):tj.encode(""),this.#i?(s=tH(this.#i),i=tU(a,tj.encode("."),tj.encode(s))):i=a;let{ciphertext:u,tag:d,iv:h}=await ru(c,this.#e,n,this.#s,i),p={ciphertext:tH(u)};return h&&(p.iv=tH(h)),d&&(p.tag=tH(d)),r&&(p.encrypted_key=tH(r)),s&&(p.aad=s),this.#t&&(p.protected=t$.decode(a)),this.#r&&(p.unprotected=this.#r),this.#n&&(p.header=this.#n),p}}class rz{#l;constructor(e){this.#l=new rF(e)}setContentEncryptionKey(e){return this.#l.setContentEncryptionKey(e),this}setInitializationVector(e){return this.#l.setInitializationVector(e),this}setProtectedHeader(e){return this.#l.setProtectedHeader(e),this}setKeyManagementParameters(e){return this.#l.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this.#l.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}let rG=e=>Math.floor(e.getTime()/1e3),rX=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,rY=e=>{let t;let r=rX.exec(e);if(!r||r[4]&&r[1])throw TypeError("Invalid time period format");let n=parseFloat(r[2]);switch(r[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*n);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*n);break;case"day":case"days":case"d":t=Math.round(86400*n);break;case"week":case"weeks":case"w":t=Math.round(604800*n);break;default:t=Math.round(31557600*n)}return"-"===r[1]||"ago"===r[4]?-t:t};function rZ(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t}let rQ=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,r0=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class r1{#c;constructor(e){if(!t1(e))throw TypeError("JWT Claims Set MUST be an object");this.#c=structuredClone(e)}data(){return tj.encode(JSON.stringify(this.#c))}get iss(){return this.#c.iss}set iss(e){this.#c.iss=e}get sub(){return this.#c.sub}set sub(e){this.#c.sub=e}get aud(){return this.#c.aud}set aud(e){this.#c.aud=e}set jti(e){this.#c.jti=e}set nbf(e){"number"==typeof e?this.#c.nbf=rZ("setNotBefore",e):e instanceof Date?this.#c.nbf=rZ("setNotBefore",rG(e)):this.#c.nbf=rG(new Date)+rY(e)}set exp(e){"number"==typeof e?this.#c.exp=rZ("setExpirationTime",e):e instanceof Date?this.#c.exp=rZ("setExpirationTime",rG(e)):this.#c.exp=rG(new Date)+rY(e)}set iat(e){void 0===e?this.#c.iat=rG(new Date):e instanceof Date?this.#c.iat=rZ("setIssuedAt",rG(e)):"string"==typeof e?this.#c.iat=rZ("setIssuedAt",rG(new Date)+rY(e)):this.#c.iat=rZ("setIssuedAt",e)}}class r2{#a;#s;#o;#t;#u;#d;#h;#p;constructor(e={}){this.#p=new r1(e)}setIssuer(e){return this.#p.iss=e,this}setSubject(e){return this.#p.sub=e,this}setAudience(e){return this.#p.aud=e,this}setJti(e){return this.#p.jti=e,this}setNotBefore(e){return this.#p.nbf=e,this}setExpirationTime(e){return this.#p.exp=e,this}setIssuedAt(e){return this.#p.iat=e,this}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this}setKeyManagementParameters(e){if(this.#o)throw TypeError("setKeyManagementParameters can only be called once");return this.#o=e,this}setContentEncryptionKey(e){if(this.#a)throw TypeError("setContentEncryptionKey can only be called once");return this.#a=e,this}setInitializationVector(e){if(this.#s)throw TypeError("setInitializationVector can only be called once");return this.#s=e,this}replicateIssuerAsHeader(){return this.#u=!0,this}replicateSubjectAsHeader(){return this.#d=!0,this}replicateAudienceAsHeader(){return this.#h=!0,this}async encrypt(e,t){let r=new rz(this.#p.data());return this.#t&&(this.#u||this.#d||this.#h)&&(this.#t={...this.#t,iss:this.#u?this.#p.iss:void 0,sub:this.#d?this.#p.sub:void 0,aud:this.#h?this.#p.aud:void 0}),r.setProtectedHeader(this.#t),this.#s&&r.setInitializationVector(this.#s),this.#a&&r.setContentEncryptionKey(this.#a),this.#o&&r.setKeyManagementParameters(this.#o),r.encrypt(e,t)}}async function r5(e,t,r){let n;if(!t1(e))throw TypeError("JWK must be an object");switch(t??=e.alg,n??=r?.extractable??e.ext,e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');return tM(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new tJ('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return rA({...e,alg:t,ext:n});default:throw new tJ('Unsupported "kty" (Key Type) Parameter value')}}let r3=async(e,t,r,n,i)=>{switch(e){case"dir":if(void 0!==r)throw new tF("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new tF("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,a;if(!t1(n.epk))throw new tF('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(tY(t),!rw(t))throw new tJ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let s=await r5(n.epk,e);if(tY(s),void 0!==n.apu){if("string"!=typeof n.apu)throw new tF('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=tM(n.apu)}catch{throw new tF("Failed to base64url decode the apu")}}if(void 0!==n.apv){if("string"!=typeof n.apv)throw new tF('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{a=tM(n.apv)}catch{throw new tF("Failed to base64url decode the apv")}}let o=await ry(s,t,"ECDH-ES"===e?n.enc:e,"ECDH-ES"===e?rR(n.enc):parseInt(e.slice(-5,-2),10),i,a);if("ECDH-ES"===e)return o;if(void 0===r)throw new tF("JWE Encrypted Key missing");return rf(e.slice(-6),o,r)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new tF("JWE Encrypted Key missing");return tY(t),rT(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new tF("JWE Encrypted Key missing");if("number"!=typeof n.p2c)throw new tF('JOSE Header "p2c" (PBES2 Count) missing or invalid');let s=i?.maxPBES2Count||1e4;if(n.p2c>s)throw new tF('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof n.p2s)throw new tF('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=tM(n.p2s)}catch{throw new tF("Failed to base64url decode the p2s")}return rS(e,t,r,n.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new tF("JWE Encrypted Key missing");return rf(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let i,a;if(void 0===r)throw new tF("JWE Encrypted Key missing");if("string"!=typeof n.iv)throw new tF('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof n.tag)throw new tF('JOSE Header "tag" (Authentication Tag) missing or invalid');try{i=tM(n.iv)}catch{throw new tF("Failed to base64url decode the iv")}try{a=tM(n.tag)}catch{throw new tF("Failed to base64url decode the tag")}return rD(e,t,r,i,a)}default:throw new tJ('Invalid or unsupported "alg" (JWE Algorithm) header value')}},r6=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function r4(e,t,r){let n,i,a,s,o,l,c;if(!t1(e))throw new tF("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new tF("JOSE Header missing");if(void 0!==e.iv&&"string"!=typeof e.iv)throw new tF("JWE Initialization Vector incorrect type");if("string"!=typeof e.ciphertext)throw new tF("JWE Ciphertext missing or incorrect type");if(void 0!==e.tag&&"string"!=typeof e.tag)throw new tF("JWE Authentication Tag incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new tF("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new tF("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new tF("JWE AAD incorrect type");if(void 0!==e.header&&!t1(e.header))throw new tF("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!t1(e.unprotected))throw new tF("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=tM(e.protected);n=JSON.parse(t$.decode(t))}catch{throw new tF("JWE Protected Header is invalid")}if(!rH(n,e.header,e.unprotected))throw new tF("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let u={...n,...e.header,...e.unprotected};if(rW(tF,new Map,r?.crit,n,u),void 0!==u.zip)throw new tJ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:d,enc:h}=u;if("string"!=typeof d||!d)throw new tF("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new tF("missing JWE Encryption Algorithm (enc) in JWE Header");let p=r&&r6("keyManagementAlgorithms",r.keyManagementAlgorithms),f=r&&r6("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(p&&!p.has(d)||!p&&d.startsWith("PBES2"))throw new tq('"alg" (Algorithm) Header Parameter value not allowed');if(f&&!f.has(h))throw new tq('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==e.encrypted_key)try{i=tM(e.encrypted_key)}catch{throw new tF("Failed to base64url decode the encrypted_key")}let g=!1;"function"==typeof t&&(t=await t(n,e),g=!0),rV("dir"===d?h:d,t,"decrypt");let m=await rO(t,d);try{a=await r3(d,m,i,u,r)}catch(e){if(e instanceof TypeError||e instanceof tF||e instanceof tJ)throw e;a=rI(h)}if(void 0!==e.iv)try{s=tM(e.iv)}catch{throw new tF("Failed to base64url decode the iv")}if(void 0!==e.tag)try{o=tM(e.tag)}catch{throw new tF("Failed to base64url decode the tag")}let y=tj.encode(e.protected??"");l=void 0!==e.aad?tU(y,tj.encode("."),tj.encode(e.aad)):y;try{c=tM(e.ciphertext)}catch{throw new tF("Failed to base64url decode the ciphertext")}let w={plaintext:await rN(h,a,c,s,o,l)};if(void 0!==e.protected&&(w.protectedHeader=n),void 0!==e.aad)try{w.additionalAuthenticatedData=tM(e.aad)}catch{throw new tF("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(w.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(w.unprotectedHeader=e.header),g)?{...w,key:m}:w}async function r8(e,t,r){if(e instanceof Uint8Array&&(e=t$.decode(e)),"string"!=typeof e)throw new tF("Compact JWE must be a string or Uint8Array");let{0:n,1:i,2:a,3:s,4:o,length:l}=e.split(".");if(5!==l)throw new tF("Invalid Compact JWE");let c=await r4({ciphertext:s,iv:a||void 0,protected:n,tag:o||void 0,encrypted_key:i||void 0},t,r),u={plaintext:c.plaintext,protectedHeader:c.protectedHeader};return"function"==typeof t?{...u,key:c.key}:u}async function r9(e,t,r){let n=await r8(e,t,r),i=function(e,t,r={}){let n,i;try{n=JSON.parse(t$.decode(t))}catch{}if(!t1(n))throw new tz("JWT Claims Set must be a top-level JSON object");let{typ:a}=r;if(a&&("string"!=typeof e.typ||rQ(e.typ)!==rQ(a)))throw new tK('unexpected "typ" JWT header value',n,"typ","check_failed");let{requiredClaims:s=[],issuer:o,subject:l,audience:c,maxTokenAge:u}=r,d=[...s];for(let e of(void 0!==u&&d.push("iat"),void 0!==c&&d.push("aud"),void 0!==l&&d.push("sub"),void 0!==o&&d.push("iss"),new Set(d.reverse())))if(!(e in n))throw new tK(`missing required "${e}" claim`,n,e,"missing");if(o&&!(Array.isArray(o)?o:[o]).includes(n.iss))throw new tK('unexpected "iss" claim value',n,"iss","check_failed");if(l&&n.sub!==l)throw new tK('unexpected "sub" claim value',n,"sub","check_failed");if(c&&!r0(n.aud,"string"==typeof c?[c]:c))throw new tK('unexpected "aud" claim value',n,"aud","check_failed");switch(typeof r.clockTolerance){case"string":i=rY(r.clockTolerance);break;case"number":i=r.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:h}=r,p=rG(h||new Date);if((void 0!==n.iat||u)&&"number"!=typeof n.iat)throw new tK('"iat" claim must be a number',n,"iat","invalid");if(void 0!==n.nbf){if("number"!=typeof n.nbf)throw new tK('"nbf" claim must be a number',n,"nbf","invalid");if(n.nbf>p+i)throw new tK('"nbf" claim timestamp check failed',n,"nbf","check_failed")}if(void 0!==n.exp){if("number"!=typeof n.exp)throw new tK('"exp" claim must be a number',n,"exp","invalid");if(n.exp<=p-i)throw new tB('"exp" claim timestamp check failed',n,"exp","check_failed")}if(u){let e=p-n.iat;if(e-i>("number"==typeof u?u:rY(u)))throw new tB('"iat" claim timestamp check failed (too far in the past)',n,"iat","check_failed");if(e<0-i)throw new tK('"iat" claim timestamp check failed (it should be in the past)',n,"iat","check_failed")}return n}(n.protectedHeader,n.plaintext,r),{protectedHeader:a}=n;if(void 0!==a.iss&&a.iss!==i.iss)throw new tK('replicated "iss" claim header parameter mismatch',i,"iss","mismatch");if(void 0!==a.sub&&a.sub!==i.sub)throw new tK('replicated "sub" claim header parameter mismatch',i,"sub","mismatch");if(void 0!==a.aud&&JSON.stringify(a.aud)!==JSON.stringify(i.aud))throw new tK('replicated "aud" claim header parameter mismatch',i,"aud","mismatch");let s={payload:i,protectedHeader:a};return"function"==typeof t?{...s,key:n.key}:s}let r7=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,ne=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,nt=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,nr=/^[\u0020-\u003A\u003D-\u007E]*$/,nn=Object.prototype.toString,ni=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function na(e,t){let r=new ni,n=e.length;if(n<2)return r;let i=t?.decode||nc,a=0;do{let t=e.indexOf("=",a);if(-1===t)break;let s=e.indexOf(";",a),o=-1===s?n:s;if(t>o){a=e.lastIndexOf(";",t-1)+1;continue}let l=ns(e,a,t),c=no(e,t,l),u=e.slice(l,c);if(void 0===r[u]){let n=ns(e,t+1,o),a=no(e,o,n),s=i(e.slice(n,a));r[u]=s}a=o+1}while(a<n);return r}function ns(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r);return r}function no(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function nl(e,t,r){let n=r?.encode||encodeURIComponent;if(!r7.test(e))throw TypeError(`argument name is invalid: ${e}`);let i=n(t);if(!ne.test(i))throw TypeError(`argument val is invalid: ${t}`);let a=e+"="+i;if(!r)return a;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);a+="; Max-Age="+r.maxAge}if(r.domain){if(!nt.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);a+="; Domain="+r.domain}if(r.path){if(!nr.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);a+="; Path="+r.path}if(r.expires){var s;if(s=r.expires,"[object Date]"!==nn.call(s)||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.partitioned&&(a+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return a}function nc(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}let{parse:nu}=k,nd=()=>Date.now()/1e3|0,nh="A256CBC-HS512";async function np(e){let{token:t={},secret:r,maxAge:n=2592e3,salt:i}=e,a=Array.isArray(r)?r:[r],s=await ng(nh,a[0],i),o=await t7({kty:"oct",k:tH(s)},`sha${s.byteLength<<3}`);return await new r2(t).setProtectedHeader({alg:"dir",enc:nh,kid:o}).setIssuedAt().setExpirationTime(nd()+n).setJti(crypto.randomUUID()).encrypt(s)}async function nf(e){let{token:t,secret:r,salt:n}=e,i=Array.isArray(r)?r:[r];if(!t)return null;let{payload:a}=await r9(t,async({kid:e,enc:t})=>{for(let r of i){let i=await ng(t,r,n);if(void 0===e||e===await t7({kty:"oct",k:tH(i)},`sha${i.byteLength<<3}`))return i}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[nh,"A256GCM"]});return a}async function ng(e,t,r){let n;switch(e){case"A256CBC-HS512":n=64;break;case"A256GCM":n=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await tR("sha256",t,r,`Auth.js Generated Encryption Key (${r})`,n)}async function nm({options:e,paramValue:t,cookieValue:r}){let{url:n,callbacks:i}=e,a=n.origin;return t?a=await i.redirect({url:t,baseUrl:n.origin}):r&&(a=await i.redirect({url:r,baseUrl:n.origin})),{callbackUrl:a,callbackUrlCookie:a!==r?a:void 0}}let ny="\x1b[31m",nw="\x1b[0m",nb={error(e){let t=e instanceof eG?e.type:e.name;if(console.error(`${ny}[auth][error]${nw} ${t}: ${e.message}`),e.cause&&"object"==typeof e.cause&&"err"in e.cause&&e.cause.err instanceof Error){let{err:t,...r}=e.cause;console.error(`${ny}[auth][cause]${nw}:`,t.stack),r&&console.error(`${ny}[auth][details]${nw}:`,JSON.stringify(r,null,2))}else e.stack&&console.error(e.stack.replace(/.*/,"").substring(1))},warn(e){console.warn(`\x1b[33m[auth][warn][${e}]${nw}`,"Read more: https://warnings.authjs.dev")},debug(e,t){console.log(`\x1b[90m[auth][debug]:${nw} ${e}`,JSON.stringify(t,null,2))}};function nv(e){let t={...nb};return e.debug||(t.debug=()=>{}),e.logger?.error&&(t.error=e.logger.error),e.logger?.warn&&(t.warn=e.logger.warn),e.logger?.debug&&(t.debug=e.logger.debug),e.logger??(e.logger=t),t}let n_=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"],{parse:nS,serialize:nk}=k;async function nE(e){if(!("body"in e)||!e.body||"POST"!==e.method)return;let t=e.headers.get("content-type");return t?.includes("application/json")?await e.json():t?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await e.text())):void 0}async function nx(e,t){try{if("GET"!==e.method&&"POST"!==e.method)throw new tl("Only GET and POST requests are supported");t.basePath??(t.basePath="/auth");let r=new URL(e.url),{action:n,providerId:i}=function(e,t){let r=e.match(RegExp(`^${t}(.+)`));if(null===r)throw new tl(`Cannot parse action at ${e}`);let n=r.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(1!==n.length&&2!==n.length)throw new tl(`Cannot parse action at ${e}`);let[i,a]=n;if(!n_.includes(i)||a&&!["signin","callback","webauthn-options"].includes(i))throw new tl(`Cannot parse action at ${e}`);return{action:i,providerId:a}}(r.pathname,t.basePath);return{url:r,action:n,providerId:i,method:e.method,headers:Object.fromEntries(e.headers),body:e.body?await nE(e):void 0,cookies:nS(e.headers.get("cookie")??"")??{},error:r.searchParams.get("error")??void 0,query:Object.fromEntries(r.searchParams)}}catch(n){let r=nv(t);r.error(n),r.debug("request",e)}}function nT(e){let t=new Headers(e.headers);e.cookies?.forEach(e=>{let{name:r,value:n,options:i}=e,a=nk(r,n,i);t.has("Set-Cookie")?t.append("Set-Cookie",a):t.set("Set-Cookie",a)});let r=e.body;"application/json"===t.get("content-type")?r=JSON.stringify(e.body):"application/x-www-form-urlencoded"===t.get("content-type")&&(r=new URLSearchParams(e.body).toString());let n=new Response(r,{headers:t,status:e.redirect?302:e.status??200});return e.redirect&&n.headers.set("Location",e.redirect),n}async function nA(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("").toString()}function nP(e){let t=e=>("0"+e.toString(16)).slice(-2);return Array.from(crypto.getRandomValues(new Uint8Array(e))).reduce((e,r)=>e+t(r),"")}async function nC({options:e,cookieValue:t,isPost:r,bodyValue:n}){if(t){let[i,a]=t.split("|");if(a===await nA(`${i}${e.secret}`))return{csrfTokenVerified:r&&i===n,csrfToken:i}}let i=nP(32),a=await nA(`${i}${e.secret}`);return{cookie:`${i}|${a}`,csrfToken:i}}function nO(e,t){if(!t)throw new tp(`CSRF token was missing during an action ${e}`)}function nR(e){return null!==e&&"object"==typeof e}function nI(e,...t){if(!t.length)return e;let r=t.shift();if(nR(e)&&nR(r))for(let t in r)nR(r[t])?(nR(e[t])||(e[t]=Array.isArray(r[t])?[]:{}),nI(e[t],r[t])):void 0!==r[t]&&(e[t]=r[t]);return nI(e,...t)}let nj=Symbol("skip-csrf-check"),n$=Symbol("return-type-raw"),nU=Symbol("custom-fetch"),nN=Symbol("conform-internal"),nL=e=>nM({id:e.sub??e.id??crypto.randomUUID(),name:e.name??e.nickname??e.preferred_username,email:e.email,image:e.picture}),nD=e=>nM({access_token:e.access_token,id_token:e.id_token,refresh_token:e.refresh_token,expires_at:e.expires_at,scope:e.scope,token_type:e.token_type,session_state:e.session_state});function nM(e){let t={};for(let[r,n]of Object.entries(e))void 0!==n&&(t[r]=n);return t}function nH(e,t){if(!e&&t)return;if("string"==typeof e)return{url:new URL(e)};let r=new URL(e?.url??"https://authjs.dev");if(e?.params!=null)for(let[t,n]of Object.entries(e.params))"claims"===t&&(n=JSON.stringify(n)),r.searchParams.set(t,String(n));return{url:r,request:e?.request,conform:e?.conform,...e?.clientPrivateKey?{clientPrivateKey:e?.clientPrivateKey}:null}}let nW={signIn:()=>!0,redirect:({url:e,baseUrl:t})=>e.startsWith("/")?`${t}${e}`:new URL(e).origin===t?e:t,session:({session:e})=>({user:{name:e.user?.name,email:e.user?.email,image:e.user?.image},expires:e.expires?.toISOString?.()??e.expires}),jwt:({token:e})=>e};async function nK({authOptions:e,providerId:t,action:r,url:n,cookies:i,callbackUrl:a,csrfToken:s,csrfDisabled:o,isPost:l}){var c;let u=nv(e),{providers:d,provider:h}=function(e){let{providerId:t,config:r}=e,n=new URL(r.basePath??"/auth",e.url.origin),i=r.providers.map(e=>{let t="function"==typeof e?e():e,{options:i,...a}=t,s=i?.id??a.id,o=nI(a,i,{signinUrl:`${n}/signin/${s}`,callbackUrl:`${n}/callback/${s}`});if("oauth"===t.type||"oidc"===t.type){o.redirectProxyUrl??(o.redirectProxyUrl=i?.redirectProxyUrl??r.redirectProxyUrl);let e=function(e){e.issuer&&(e.wellKnown??(e.wellKnown=`${e.issuer}/.well-known/openid-configuration`));let t=nH(e.authorization,e.issuer);t&&!t.url?.searchParams.has("scope")&&t.url.searchParams.set("scope","openid profile email");let r=nH(e.token,e.issuer),n=nH(e.userinfo,e.issuer),i=e.checks??["pkce"];return e.redirectProxyUrl&&(i.includes("state")||i.push("state"),e.redirectProxyUrl=`${e.redirectProxyUrl}/callback/${e.id}`),{...e,authorization:t,token:r,checks:i,userinfo:n,profile:e.profile??nL,account:e.account??nD}}(o);return e.authorization?.url.searchParams.get("response_mode")==="form_post"&&delete e.redirectProxyUrl,e[nU]??(e[nU]=i?.[nU]),e}return o}),a=i.find(({id:e})=>e===t);if(t&&!a){let e=i.map(e=>e.id).join(", ");throw Error(`Provider with id "${t}" not found. Available providers: [${e}].`)}return{providers:i,provider:a}}({url:n,providerId:t,config:e}),p=!1;if((h?.type==="oauth"||h?.type==="oidc")&&h.redirectProxyUrl)try{p=new URL(h.redirectProxyUrl).origin===n.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${h.redirectProxyUrl}`)}let f={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...e,url:n,action:r,provider:h,cookies:nI(eF(e.useSecureCookies??"https:"===n.protocol),e.cookies),providers:d,session:{strategy:e.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...e.session},jwt:{secret:e.secret,maxAge:e.session?.maxAge??2592e3,encode:np,decode:nf,...e.jwt},events:Object.keys(c=e.events??{}).reduce((e,t)=>(e[t]=async(...e)=>{try{let r=c[t];return await r(...e)}catch(e){u.error(new e1(e))}},e),{}),adapter:function(e,t){if(e)return Object.keys(e).reduce((r,n)=>(r[n]=async(...r)=>{try{t.debug(`adapter_${n}`,{args:r});let i=e[n];return await i(...r)}catch(r){let e=new eY(r);throw t.error(e),e}},r),{})}(e.adapter,u),callbacks:{...nW,...e.callbacks},logger:u,callbackUrl:n.origin,isOnRedirectProxy:p,experimental:{...e.experimental}},g=[];if(o)f.csrfTokenVerified=!0;else{let{csrfToken:e,cookie:t,csrfTokenVerified:r}=await nC({options:f,cookieValue:i?.[f.cookies.csrfToken.name],isPost:l,bodyValue:s});f.csrfToken=e,f.csrfTokenVerified=r,t&&g.push({name:f.cookies.csrfToken.name,value:t,options:f.cookies.csrfToken.options})}let{callbackUrl:m,callbackUrlCookie:y}=await nm({options:f,cookieValue:i?.[f.cookies.callbackUrl.name],paramValue:a});return f.callbackUrl=m,y&&g.push({name:f.cookies.callbackUrl.name,value:y,options:f.cookies.callbackUrl.options}),{options:f,cookies:g}}var nB,nq,nJ,nV,nF,nz,nG,nX,nY,nZ,nQ,n0,n1,n2,n5,n3,n6,n4,n8,n9,n7,ie,it,ir,ii,ia,is,io,il={},ic=[],iu=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,id=Array.isArray;function ih(e,t){for(var r in t)e[r]=t[r];return e}function ip(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ig(e,t,r){var n,i,a,s={};for(a in t)"key"==a?n=t[a]:"ref"==a?i=t[a]:s[a]=t[a];if(arguments.length>2&&(s.children=arguments.length>3?n8.call(arguments,2):r),"function"==typeof e&&null!=e.defaultProps)for(a in e.defaultProps)void 0===s[a]&&(s[a]=e.defaultProps[a]);return im(e,s,n,i,null)}function im(e,t,r,n,i){var a={type:e,props:t,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==i?++n7:i,__i:-1,__u:0};return null==i&&null!=n9.vnode&&n9.vnode(a),a}function iy(e){return e.children}function iw(e,t){this.props=e,this.context=t}function ib(e,t){if(null==t)return e.__?ib(e.__,e.__i+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?ib(e):null}function iv(e){(!e.__d&&(e.__d=!0)&&ie.push(e)&&!i_.__r++||it!==n9.debounceRendering)&&((it=n9.debounceRendering)||ir)(i_)}function i_(){var e,t,r,n,i,a,s,o;for(ie.sort(ii);e=ie.shift();)e.__d&&(t=ie.length,n=void 0,a=(i=(r=e).__v).__e,s=[],o=[],r.__P&&((n=ih({},i)).__v=i.__v+1,n9.vnode&&n9.vnode(n),iT(r.__P,n,i,r.__n,r.__P.namespaceURI,32&i.__u?[a]:null,s,null==a?ib(i):a,!!(32&i.__u),o),n.__v=i.__v,n.__.__k[n.__i]=n,iA(s,n,o),n.__e!=a&&function e(t){var r,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(n=t.__k[r])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return e(t)}}(n)),ie.length>t&&ie.sort(ii));i_.__r=0}function iS(e,t,r,n,i,a,s,o,l,c,u){var d,h,p,f,g,m=n&&n.__k||ic,y=t.length;for(r.__d=l,function(e,t,r){var n,i,a,s,o,l=t.length,c=r.length,u=c,d=0;for(e.__k=[],n=0;n<l;n++)null!=(i=t[n])&&"boolean"!=typeof i&&"function"!=typeof i?(s=n+d,(i=e.__k[n]="string"==typeof i||"number"==typeof i||"bigint"==typeof i||i.constructor==String?im(null,i,null,null,null):id(i)?im(iy,{children:i},null,null,null):void 0===i.constructor&&i.__b>0?im(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=e,i.__b=e.__b+1,a=null,-1!==(o=i.__i=function(e,t,r,n){var i=e.key,a=e.type,s=r-1,o=r+1,l=t[r];if(null===l||l&&i==l.key&&a===l.type&&0==(131072&l.__u))return r;if(n>(null!=l&&0==(131072&l.__u)?1:0))for(;s>=0||o<t.length;){if(s>=0){if((l=t[s])&&0==(131072&l.__u)&&i==l.key&&a===l.type)return s;s--}if(o<t.length){if((l=t[o])&&0==(131072&l.__u)&&i==l.key&&a===l.type)return o;o++}}return -1}(i,r,s,u))&&(u--,(a=r[o])&&(a.__u|=131072)),null==a||null===a.__v?(-1==o&&d--,"function"!=typeof i.type&&(i.__u|=65536)):o!==s&&(o==s-1?d--:o==s+1?d++:(o>s?d--:d++,i.__u|=65536))):i=e.__k[n]=null;if(u)for(n=0;n<c;n++)null!=(a=r[n])&&0==(131072&a.__u)&&(a.__e==e.__d&&(e.__d=ib(a)),function e(t,r,n){var i,a;if(n9.unmount&&n9.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||iP(i,null,r)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){n9.__e(e,r)}i.base=i.__P=null}if(i=t.__k)for(a=0;a<i.length;a++)i[a]&&e(i[a],r,n||"function"!=typeof t.type);n||ip(t.__e),t.__c=t.__=t.__e=t.__d=void 0}(a,a))}(r,t,m),l=r.__d,d=0;d<y;d++)null!=(p=r.__k[d])&&(h=-1===p.__i?il:m[p.__i]||il,p.__i=d,iT(e,p,h,i,a,s,o,l,c,u),f=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&iP(h.ref,null,p),u.push(p.ref,p.__c||f,p)),null==g&&null!=f&&(g=f),65536&p.__u||h.__k===p.__k?l=function e(t,r,n){var i,a;if("function"==typeof t.type){for(i=t.__k,a=0;i&&a<i.length;a++)i[a]&&(i[a].__=t,r=e(i[a],r,n));return r}t.__e!=r&&(r&&t.type&&!n.contains(r)&&(r=ib(t)),n.insertBefore(t.__e,r||null),r=t.__e);do r=r&&r.nextSibling;while(null!=r&&8===r.nodeType);return r}(p,l,e):"function"==typeof p.type&&void 0!==p.__d?l=p.__d:f&&(l=f.nextSibling),p.__d=void 0,p.__u&=-196609);r.__d=l,r.__e=g}function ik(e,t,r){"-"===t[0]?e.setProperty(t,null==r?"":r):e[t]=null==r?"":"number"!=typeof r||iu.test(t)?r:r+"px"}function iE(e,t,r,n,i){var a;e:if("style"===t){if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof n&&(e.style.cssText=n=""),n)for(t in n)r&&t in r||ik(e.style,t,"");if(r)for(t in r)n&&r[t]===n[t]||ik(e.style,t,r[t])}}else if("o"===t[0]&&"n"===t[1])a=t!==(t=t.replace(/(PointerCapture)$|Capture$/i,"$1")),t=t.toLowerCase() in e||"onFocusOut"===t||"onFocusIn"===t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=r,r?n?r.u=n.u:(r.u=ia,e.addEventListener(t,a?io:is,a)):e.removeEventListener(t,a?io:is,a);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==r?"":r;break e}catch(e){}"function"==typeof r||(null==r||!1===r&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==r?"":r))}}function ix(e){return function(t){if(this.l){var r=this.l[t.type+e];if(null==t.t)t.t=ia++;else if(t.t<r.u)return;return r(n9.event?n9.event(t):t)}}}function iT(e,t,r,n,i,a,s,o,l,c){var u,d,h,p,f,g,m,y,w,b,v,_,S,k,E,x,T=t.type;if(void 0!==t.constructor)return null;128&r.__u&&(l=!!(32&r.__u),a=[o=t.__e=r.__e]),(u=n9.__b)&&u(t);e:if("function"==typeof T)try{if(y=t.props,w="prototype"in T&&T.prototype.render,b=(u=T.contextType)&&n[u.__c],v=u?b?b.props.value:u.__:n,r.__c?m=(d=t.__c=r.__c).__=d.__E:(w?t.__c=d=new T(y,v):(t.__c=d=new iw(y,v),d.constructor=T,d.render=iC),b&&b.sub(d),d.props=y,d.state||(d.state={}),d.context=v,d.__n=n,h=d.__d=!0,d.__h=[],d._sb=[]),w&&null==d.__s&&(d.__s=d.state),w&&null!=T.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=ih({},d.__s)),ih(d.__s,T.getDerivedStateFromProps(y,d.__s))),p=d.props,f=d.state,d.__v=t,h)w&&null==T.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),w&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(w&&null==T.getDerivedStateFromProps&&y!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(y,v),!d.__e&&(null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(y,d.__s,v)||t.__v===r.__v)){for(t.__v!==r.__v&&(d.props=y,d.state=d.__s,d.__d=!1),t.__e=r.__e,t.__k=r.__k,t.__k.some(function(e){e&&(e.__=t)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&s.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(y,d.__s,v),w&&null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(p,f,g)})}if(d.context=v,d.props=y,d.__P=e,d.__e=!1,S=n9.__r,k=0,w){for(d.state=d.__s,d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),E=0;E<d._sb.length;E++)d.__h.push(d._sb[E]);d._sb=[]}else do d.__d=!1,S&&S(t),u=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++k<25);d.state=d.__s,null!=d.getChildContext&&(n=ih(ih({},n),d.getChildContext())),w&&!h&&null!=d.getSnapshotBeforeUpdate&&(g=d.getSnapshotBeforeUpdate(p,f)),iS(e,id(x=null!=u&&u.type===iy&&null==u.key?u.props.children:u)?x:[x],t,r,n,i,a,s,o,l,c),d.base=t.__e,t.__u&=-161,d.__h.length&&s.push(d),m&&(d.__E=d.__=null)}catch(e){if(t.__v=null,l||null!=a){for(t.__u|=l?160:128;o&&8===o.nodeType&&o.nextSibling;)o=o.nextSibling;a[a.indexOf(o)]=null,t.__e=o}else t.__e=r.__e,t.__k=r.__k;n9.__e(e,t,r)}else null==a&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=function(e,t,r,n,i,a,s,o,l){var c,u,d,h,p,f,g,m=r.props,y=t.props,w=t.type;if("svg"===w?i="http://www.w3.org/2000/svg":"math"===w?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=a){for(c=0;c<a.length;c++)if((p=a[c])&&"setAttribute"in p==!!w&&(w?p.localName===w:3===p.nodeType)){e=p,a[c]=null;break}}if(null==e){if(null===w)return document.createTextNode(y);e=document.createElementNS(i,w,y.is&&y),o&&(n9.__m&&n9.__m(t,a),o=!1),a=null}if(null===w)m===y||o&&e.data===y||(e.data=y);else{if(a=a&&n8.call(e.childNodes),m=r.props||il,!o&&null!=a)for(m={},c=0;c<e.attributes.length;c++)m[(p=e.attributes[c]).name]=p.value;for(c in m)if(p=m[c],"children"==c);else if("dangerouslySetInnerHTML"==c)d=p;else if(!(c in y)){if("value"==c&&"defaultValue"in y||"checked"==c&&"defaultChecked"in y)continue;iE(e,c,null,p,i)}for(c in y)p=y[c],"children"==c?h=p:"dangerouslySetInnerHTML"==c?u=p:"value"==c?f=p:"checked"==c?g=p:o&&"function"!=typeof p||m[c]===p||iE(e,c,p,m[c],i);if(u)o||d&&(u.__html===d.__html||u.__html===e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(d&&(e.innerHTML=""),iS(e,id(h)?h:[h],t,r,n,"foreignObject"===w?"http://www.w3.org/1999/xhtml":i,a,s,a?a[0]:r.__k&&ib(r,0),o,l),null!=a)for(c=a.length;c--;)ip(a[c]);o||(c="value","progress"===w&&null==f?e.removeAttribute("value"):void 0===f||f===e[c]&&("progress"!==w||f)&&("option"!==w||f===m[c])||iE(e,c,f,m[c],i),c="checked",void 0!==g&&g!==e[c]&&iE(e,c,g,m[c],i))}return e}(r.__e,t,r,n,i,a,s,l,c);(u=n9.diffed)&&u(t)}function iA(e,t,r){t.__d=void 0;for(var n=0;n<r.length;n++)iP(r[n],r[++n],r[++n]);n9.__c&&n9.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){n9.__e(e,t.__v)}})}function iP(e,t,r){try{if("function"==typeof e){var n="function"==typeof e.__u;n&&e.__u(),n&&null==t||(e.__u=e(t))}else e.current=t}catch(e){n9.__e(e,r)}}function iC(e,t,r){return this.constructor(e,r)}function iO(e,t){var r,n,i,a,s;r=e,n9.__&&n9.__(r,t),i=(n="function"==typeof iO)?null:iO&&iO.__k||t.__k,a=[],s=[],iT(t,r=(!n&&iO||t).__k=ig(iy,null,[r]),i||il,il,t.namespaceURI,!n&&iO?[iO]:i?null:t.firstChild?n8.call(t.childNodes):null,a,!n&&iO?iO:i?i.__e:t.firstChild,n,s),iA(a,r,s)}n8=ic.slice,n9={__e:function(e,t,r,n){for(var i,a,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((a=i.constructor)&&null!=a.getDerivedStateFromError&&(i.setState(a.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,n||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},n7=0,iw.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=ih({},this.state),"function"==typeof e&&(e=e(ih({},r),this.props)),e&&ih(r,e),null!=e&&this.__v&&(t&&this._sb.push(t),iv(this))},iw.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),iv(this))},iw.prototype.render=iy,ie=[],ir="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ii=function(e,t){return e.__v.__b-t.__v.__b},i_.__r=0,ia=0,is=ix(!1),io=ix(!0);var iR=/[\s\n\\/='"\0<>]/,iI=/^(xlink|xmlns|xml)([A-Z])/,ij=/^accessK|^auto[A-Z]|^cell|^ch|^col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z]/,i$=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,iU=new Set(["draggable","spellcheck"]),iN=/["&<]/;function iL(e){if(0===e.length||!1===iN.test(e))return e;for(var t=0,r=0,n="",i="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=i,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var iD={},iM=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),iH=/[A-Z]/g;function iW(){this.__d=!0}var iK,iB,iq,iJ,iV={},iF=[],iz=Array.isArray,iG=Object.assign;function iX(e,t){var r,n=e.type,i=!0;return e.__c?(i=!1,(r=e.__c).state=r.__s):r=new n(e.props,t),e.__c=r,r.__v=e,r.props=e.props,r.context=t,r.__d=!0,null==r.state&&(r.state=iV),null==r.__s&&(r.__s=r.state),n.getDerivedStateFromProps?r.state=iG({},r.state,n.getDerivedStateFromProps(r.props,r.state)):i&&r.componentWillMount?(r.componentWillMount(),r.state=r.__s!==r.state?r.__s:r.state):!i&&r.componentWillUpdate&&r.componentWillUpdate(),iq&&iq(e),r.render(r.props,r.state,t)}var iY=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),iZ=0;function iQ(e,t,r,n,i,a){t||(t={});var s,o,l=t;"ref"in t&&(s=t.ref,delete t.ref);var c={type:e,props:l,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--iZ,__i:-1,__u:0,__source:i,__self:a};if("function"==typeof e&&(s=e.defaultProps))for(o in s)void 0===l[o]&&(l[o]=s[o]);return n9.vnode&&n9.vnode(c),c}async function i0(e,t){let r=window.SimpleWebAuthnBrowser;async function n(r){let n=new URL(`${e}/webauthn-options/${t}`);r&&n.searchParams.append("action",r),a().forEach(e=>{n.searchParams.append(e.name,e.value)});let i=await fetch(n);if(!i.ok){console.error("Failed to fetch options",i);return}return i.json()}function i(){let e=`#${t}-form`,r=document.querySelector(e);if(!r)throw Error(`Form '${e}' not found`);return r}function a(){return Array.from(i().querySelectorAll("input[data-form-field]"))}async function s(e,t){let r=i();if(e){let t=document.createElement("input");t.type="hidden",t.name="action",t.value=e,r.appendChild(t)}if(t){let e=document.createElement("input");e.type="hidden",e.name="data",e.value=JSON.stringify(t),r.appendChild(e)}return r.submit()}async function o(e,t){let n=await r.startAuthentication(e,t);return await s("authenticate",n)}async function l(e){a().forEach(e=>{if(e.required&&!e.value)throw Error(`Missing required field: ${e.name}`)});let t=await r.startRegistration(e);return await s("register",t)}async function c(){if(!r.browserSupportsWebAuthnAutofill())return;let e=await n("authenticate");if(!e){console.error("Failed to fetch option for autofill authentication");return}try{await o(e.options,!0)}catch(e){console.error(e)}}(async function(){let e=i();if(!r.browserSupportsWebAuthn()){e.style.display="none";return}e&&e.addEventListener("submit",async e=>{e.preventDefault();let t=await n(void 0);if(!t){console.error("Failed to fetch options for form submission");return}if("authenticate"===t.action)try{await o(t.options,!1)}catch(e){console.error(e)}else if("register"===t.action)try{await l(t.options)}catch(e){console.error(e)}})})(),c()}let i1={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},i2=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
  --provider-bg: #fff;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #fff
  );
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
  --provider-bg: #161b22;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #000
  );
}

.__next-auth-theme-dark img[src$="42-school.svg"],
  .__next-auth-theme-dark img[src$="apple.svg"],
  .__next-auth-theme-dark img[src$="boxyhq-saml.svg"],
  .__next-auth-theme-dark img[src$="eveonline.svg"],
  .__next-auth-theme-dark img[src$="github.svg"],
  .__next-auth-theme-dark img[src$="mailchimp.svg"],
  .__next-auth-theme-dark img[src$="medium.svg"],
  .__next-auth-theme-dark img[src$="okta.svg"],
  .__next-auth-theme-dark img[src$="patreon.svg"],
  .__next-auth-theme-dark img[src$="ping-id.svg"],
  .__next-auth-theme-dark img[src$="roblox.svg"],
  .__next-auth-theme-dark img[src$="threads.svg"],
  .__next-auth-theme-dark img[src$="wikimedia.svg"] {
    filter: invert(1);
  }

.__next-auth-theme-dark #submitButton {
    background-color: var(--provider-bg, var(--color-info));
  }

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
    --provider-bg: #161b22;
    --provider-bg-hover: color-mix(
      in srgb,
      var(--provider-brand-color) 30%,
      #000
    );
  }
    .__next-auth-theme-auto img[src$="42-school.svg"],
    .__next-auth-theme-auto img[src$="apple.svg"],
    .__next-auth-theme-auto img[src$="boxyhq-saml.svg"],
    .__next-auth-theme-auto img[src$="eveonline.svg"],
    .__next-auth-theme-auto img[src$="github.svg"],
    .__next-auth-theme-auto img[src$="mailchimp.svg"],
    .__next-auth-theme-auto img[src$="medium.svg"],
    .__next-auth-theme-auto img[src$="okta.svg"],
    .__next-auth-theme-auto img[src$="patreon.svg"],
    .__next-auth-theme-auto img[src$="ping-id.svg"],
    .__next-auth-theme-auto img[src$="roblox.svg"],
    .__next-auth-theme-auto img[src$="threads.svg"],
    .__next-auth-theme-auto img[src$="wikimedia.svg"] {
      filter: invert(1);
    }
    .__next-auth-theme-auto #submitButton {
      background-color: var(--provider-bg, var(--color-info));
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: var(--provider-bg);
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function i5({html:e,title:t,status:r,cookies:n,theme:i,headTags:a}){return{cookies:n,status:r,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${i2}</style><title>${t}</title>${a??""}</head><body class="__next-auth-theme-${i?.colorScheme??"auto"}"><div class="page">${function(e,t,r){var n=n9.__s;n9.__s=!0,iK=n9.__b,iB=n9.diffed,iq=n9.__r,iJ=n9.unmount;var i=ig(iy,null);i.__k=[e];try{var a=function e(t,r,n,i,a,s,o){if(null==t||!0===t||!1===t||""===t)return"";var l=typeof t;if("object"!=l)return"function"==l?"":"string"==l?iL(t):t+"";if(iz(t)){var c,u="";a.__k=t;for(var d=0;d<t.length;d++){var h=t[d];if(null!=h&&"boolean"!=typeof h){var p,f=e(h,r,n,i,a,s,o);"string"==typeof f?u+=f:(c||(c=[]),u&&c.push(u),u="",iz(f)?(p=c).push.apply(p,f):c.push(f))}}return c?(u&&c.push(u),c):u}if(void 0!==t.constructor)return"";t.__=a,iK&&iK(t);var g=t.type,m=t.props;if("function"==typeof g){var y,w,b,v=r;if(g===iy){if("tpl"in m){for(var _="",S=0;S<m.tpl.length;S++)if(_+=m.tpl[S],m.exprs&&S<m.exprs.length){var k=m.exprs[S];if(null==k)continue;"object"==typeof k&&(void 0===k.constructor||iz(k))?_+=e(k,r,n,i,t,s,o):_+=k}return _}if("UNSTABLE_comment"in m)return"<!--"+iL(m.UNSTABLE_comment)+"-->";w=m.children}else{if(null!=(y=g.contextType)){var E=r[y.__c];v=E?E.props.value:y.__}var x=g.prototype&&"function"==typeof g.prototype.render;if(x)w=iX(t,v),b=t.__c;else{t.__c=b={__v:t,context:v,props:t.props,setState:iW,forceUpdate:iW,__d:!0,__h:[]};for(var T=0;b.__d&&T++<25;)b.__d=!1,iq&&iq(t),w=g.call(b,m,v);b.__d=!0}if(null!=b.getChildContext&&(r=iG({},r,b.getChildContext())),x&&n9.errorBoundaries&&(g.getDerivedStateFromError||b.componentDidCatch)){w=null!=w&&w.type===iy&&null==w.key&&null==w.props.tpl?w.props.children:w;try{return e(w,r,n,i,t,s,o)}catch(a){return g.getDerivedStateFromError&&(b.__s=g.getDerivedStateFromError(a)),b.componentDidCatch&&b.componentDidCatch(a,iV),b.__d?(w=iX(t,r),null!=(b=t.__c).getChildContext&&(r=iG({},r,b.getChildContext())),e(w=null!=w&&w.type===iy&&null==w.key&&null==w.props.tpl?w.props.children:w,r,n,i,t,s,o)):""}finally{iB&&iB(t),t.__=null,iJ&&iJ(t)}}}w=null!=w&&w.type===iy&&null==w.key&&null==w.props.tpl?w.props.children:w;try{var A=e(w,r,n,i,t,s,o);return iB&&iB(t),t.__=null,n9.unmount&&n9.unmount(t),A}catch(a){if(!s&&o&&o.onError){var P=o.onError(a,t,function(a){return e(a,r,n,i,t,s,o)});if(void 0!==P)return P;var C=n9.__e;return C&&C(a,t),""}if(!s||!a||"function"!=typeof a.then)throw a;return a.then(function a(){try{return e(w,r,n,i,t,s,o)}catch(l){if(!l||"function"!=typeof l.then)throw l;return l.then(function(){return e(w,r,n,i,t,s,o)},a)}})}}var O,R="<"+g,I="";for(var j in m){var $=m[j];if("function"!=typeof $||"class"===j||"className"===j){switch(j){case"children":O=$;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in m)continue;j="for";break;case"className":if("class"in m)continue;j="class";break;case"defaultChecked":j="checked";break;case"defaultSelected":j="selected";break;case"defaultValue":case"value":switch(j="value",g){case"textarea":O=$;continue;case"select":i=$;continue;case"option":i!=$||"selected"in m||(R+=" selected")}break;case"dangerouslySetInnerHTML":I=$&&$.__html;continue;case"style":"object"==typeof $&&($=function(e){var t="";for(var r in e){var n=e[r];if(null!=n&&""!==n){var i="-"==r[0]?r:iD[r]||(iD[r]=r.replace(iH,"-$&").toLowerCase()),a=";";"number"!=typeof n||i.startsWith("--")||iM.has(i)||(a="px;"),t=t+i+":"+n+a}}return t||void 0}($));break;case"acceptCharset":j="accept-charset";break;case"httpEquiv":j="http-equiv";break;default:if(iI.test(j))j=j.replace(iI,"$1:$2").toLowerCase();else{if(iR.test(j))continue;("-"===j[4]||iU.has(j))&&null!=$?$+="":n?i$.test(j)&&(j="panose1"===j?"panose-1":j.replace(/([A-Z])/g,"-$1").toLowerCase()):ij.test(j)&&(j=j.toLowerCase())}}null!=$&&!1!==$&&(R=!0===$||""===$?R+" "+j:R+" "+j+'="'+("string"==typeof $?iL($):$+"")+'"')}}if(iR.test(g))throw Error(g+" is not a valid HTML tag name in "+R+">");if(I||("string"==typeof O?I=iL(O):null!=O&&!1!==O&&!0!==O&&(I=e(O,r,"svg"===g||"foreignObject"!==g&&n,i,t,s,o))),iB&&iB(t),t.__=null,iJ&&iJ(t),!I&&iY.has(g))return R+"/>";var U="</"+g+">",N=R+">";return iz(I)?[N].concat(I,[U]):"string"!=typeof I?[N,I,U]:N+I+U}(e,iV,!1,void 0,i,!1,void 0);return iz(a)?a.join(""):a}catch(e){if(e.then)throw Error('Use "renderToStringAsync" for suspenseful rendering.');throw e}finally{n9.__c&&n9.__c(e,iF),n9.__s=n,iF.length=0}}(e)}</div></body></html>`}}function i3(e){let{url:t,theme:r,query:n,cookies:i,pages:a,providers:s}=e;return{csrf:(e,t,r)=>e?(t.logger.warn("csrf-disabled"),r.push({name:t.cookies.csrfToken.name,value:"",options:{...t.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:r}):{headers:{"Content-Type":"application/json","Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"},body:{csrfToken:t.csrfToken},cookies:r},providers:e=>({headers:{"Content-Type":"application/json"},body:e.reduce((e,{id:t,name:r,type:n,signinUrl:i,callbackUrl:a})=>(e[t]={id:t,name:r,type:n,signinUrl:i,callbackUrl:a},e),{})}),signin(t,o){if(t)throw new tl("Unsupported action");if(a?.signIn){let t=`${a.signIn}${a.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:e.callbackUrl??"/"})}`;return o&&(t=`${t}&${new URLSearchParams({error:o})}`),{redirect:t,cookies:i}}let l=s?.find(e=>"webauthn"===e.type&&e.enableConditionalUI&&!!e.simpleWebAuthnBrowserVersion),c="";if(l){let{simpleWebAuthnBrowserVersion:e}=l;c=`<script src="https://unpkg.com/@simplewebauthn/browser@${e}/dist/bundle/index.umd.min.js" crossorigin="anonymous"></script>`}return i5({cookies:i,theme:r,html:function(e){let{csrfToken:t,providers:r=[],callbackUrl:n,theme:i,email:a,error:s}=e;"undefined"!=typeof document&&i?.brandColor&&document.documentElement.style.setProperty("--brand-color",i.brandColor),"undefined"!=typeof document&&i?.buttonText&&document.documentElement.style.setProperty("--button-text-color",i.buttonText);let o=s&&(i1[s]??i1.default),l=r.find(e=>"webauthn"===e.type&&e.enableConditionalUI)?.id;return iQ("div",{className:"signin",children:[i?.brandColor&&iQ("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${i.brandColor}}`}}),i?.buttonText&&iQ("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${i.buttonText}
        }
      `}}),iQ("div",{className:"card",children:[o&&iQ("div",{className:"error",children:iQ("p",{children:o})}),i?.logo&&iQ("img",{src:i.logo,alt:"Logo",className:"logo"}),r.map((e,i)=>{let s,o,l;("oauth"===e.type||"oidc"===e.type)&&({bg:s="#fff",brandColor:o,logo:l=`https://authjs.dev/img/providers/${e.id}.svg`}=e.style??{});let c=o??s??"#fff";return iQ("div",{className:"provider",children:["oauth"===e.type||"oidc"===e.type?iQ("form",{action:e.signinUrl,method:"POST",children:[iQ("input",{type:"hidden",name:"csrfToken",value:t}),n&&iQ("input",{type:"hidden",name:"callbackUrl",value:n}),iQ("button",{type:"submit",className:"button",style:{"--provider-brand-color":c},tabIndex:0,children:[iQ("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",e.name]}),l&&iQ("img",{loading:"lazy",height:24,src:l})]})]}):null,("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&i>0&&"email"!==r[i-1].type&&"credentials"!==r[i-1].type&&"webauthn"!==r[i-1].type&&iQ("hr",{}),"email"===e.type&&iQ("form",{action:e.signinUrl,method:"POST",children:[iQ("input",{type:"hidden",name:"csrfToken",value:t}),iQ("label",{className:"section-header",htmlFor:`input-email-for-${e.id}-provider`,children:"Email"}),iQ("input",{id:`input-email-for-${e.id}-provider`,autoFocus:!0,type:"email",name:"email",value:a,placeholder:"email@example.com",required:!0}),iQ("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"credentials"===e.type&&iQ("form",{action:e.callbackUrl,method:"POST",children:[iQ("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.credentials).map(t=>iQ("div",{children:[iQ("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.credentials[t].label??t}),iQ("input",{name:t,id:`input-${t}-for-${e.id}-provider`,type:e.credentials[t].type??"text",placeholder:e.credentials[t].placeholder??"",...e.credentials[t]})]},`input-group-${e.id}`)),iQ("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),"webauthn"===e.type&&iQ("form",{action:e.callbackUrl,method:"POST",id:`${e.id}-form`,children:[iQ("input",{type:"hidden",name:"csrfToken",value:t}),Object.keys(e.formFields).map(t=>iQ("div",{children:[iQ("label",{className:"section-header",htmlFor:`input-${t}-for-${e.id}-provider`,children:e.formFields[t].label??t}),iQ("input",{name:t,"data-form-field":!0,id:`input-${t}-for-${e.id}-provider`,type:e.formFields[t].type??"text",placeholder:e.formFields[t].placeholder??"",...e.formFields[t]})]},`input-group-${e.id}`)),iQ("button",{id:`submitButton-${e.id}`,type:"submit",tabIndex:0,children:["Sign in with ",e.name]})]}),("email"===e.type||"credentials"===e.type||"webauthn"===e.type)&&i+1<r.length&&iQ("hr",{})]},e.id)})]}),l&&iQ(iy,{children:iQ("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${i0})(authURL, "${l}");
`}})})]})}({csrfToken:e.csrfToken,providers:e.providers?.filter(e=>["email","oauth","oidc"].includes(e.type)||"credentials"===e.type&&e.credentials||"webauthn"===e.type&&e.formFields||!1),callbackUrl:e.callbackUrl,theme:e.theme,error:o,...n}),title:"Sign In",headTags:c})},signout:()=>a?.signOut?{redirect:a.signOut,cookies:i}:i5({cookies:i,theme:r,html:function(e){let{url:t,csrfToken:r,theme:n}=e;return iQ("div",{className:"signout",children:[n?.brandColor&&iQ("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${n.brandColor}
        }
      `}}),n?.buttonText&&iQ("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${n.buttonText}
        }
      `}}),iQ("div",{className:"card",children:[n?.logo&&iQ("img",{src:n.logo,alt:"Logo",className:"logo"}),iQ("h1",{children:"Signout"}),iQ("p",{children:"Are you sure you want to sign out?"}),iQ("form",{action:t?.toString(),method:"POST",children:[iQ("input",{type:"hidden",name:"csrfToken",value:r}),iQ("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:e.csrfToken,url:t,theme:r}),title:"Sign Out"}),verifyRequest:e=>a?.verifyRequest?{redirect:`${a.verifyRequest}${t?.search??""}`,cookies:i}:i5({cookies:i,theme:r,html:function(e){let{url:t,theme:r}=e;return iQ("div",{className:"verify-request",children:[r.brandColor&&iQ("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${r.brandColor}
        }
      `}}),iQ("div",{className:"card",children:[r.logo&&iQ("img",{src:r.logo,alt:"Logo",className:"logo"}),iQ("h1",{children:"Check your email"}),iQ("p",{children:"A sign in link has been sent to your email address."}),iQ("p",{children:iQ("a",{className:"site",href:t.origin,children:t.host})})]})]})}({url:t,theme:r,...e}),title:"Verify Request"}),error:e=>a?.error?{redirect:`${a.error}${a.error.includes("?")?"&":"?"}error=${e}`,cookies:i}:i5({cookies:i,theme:r,...function(e){let{url:t,error:r="default",theme:n}=e,i=`${t}/signin`,a={default:{status:200,heading:"Error",message:iQ("p",{children:iQ("a",{className:"site",href:t?.origin,children:t?.host})})},Configuration:{status:500,heading:"Server error",message:iQ("div",{children:[iQ("p",{children:"There is a problem with the server configuration."}),iQ("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:iQ("div",{children:[iQ("p",{children:"You do not have permission to sign in."}),iQ("p",{children:iQ("a",{className:"button",href:i,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:iQ("div",{children:[iQ("p",{children:"The sign in link is no longer valid."}),iQ("p",{children:"It may have been used already or it may have expired."})]}),signin:iQ("a",{className:"button",href:i,children:"Sign in"})}},{status:s,heading:o,message:l,signin:c}=a[r]??a.default;return{status:s,html:iQ("div",{className:"error",children:[n?.brandColor&&iQ("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${n?.brandColor}
        }
      `}}),iQ("div",{className:"card",children:[n?.logo&&iQ("img",{src:n?.logo,alt:"Logo",className:"logo"}),iQ("h1",{children:o}),iQ("div",{className:"message",children:l}),c]})]})}}({url:t,theme:r,error:e}),title:"Error"})}}function i6(e,t=Date.now()){return new Date(t+1e3*e)}async function i4(e,t,r,n){if(!r?.providerAccountId||!r.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(r.type))throw Error("Provider not supported");let{adapter:i,jwt:a,events:s,session:{strategy:o,generateSessionToken:l}}=n;if(!i)return{user:t,account:r};let c=r,{createUser:u,updateUser:d,getUser:h,getUserByAccount:p,getUserByEmail:f,linkAccount:g,createSession:m,getSessionAndUser:y,deleteSession:w}=i,b=null,v=null,_=!1,S="jwt"===o;if(e){if(S)try{let t=n.cookies.sessionToken.name;(b=await a.decode({...a,token:e,salt:t}))&&"sub"in b&&b.sub&&(v=await h(b.sub))}catch{}else{let t=await y(e);t&&(b=t.session,v=t.user)}}if("email"===c.type){let r=await f(t.email);return r?(v?.id!==r.id&&!S&&e&&await w(e),v=await d({id:r.id,emailVerified:new Date}),await s.updateUser?.({user:v})):(v=await u({...t,emailVerified:new Date}),await s.createUser?.({user:v}),_=!0),{session:b=S?{}:await m({sessionToken:l(),userId:v.id,expires:i6(n.session.maxAge)}),user:v,isNewUser:_}}if("webauthn"===c.type){let e=await p({providerAccountId:c.providerAccountId,provider:c.provider});if(e){if(v){if(e.id===v.id){let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}throw new tw("The account is already associated with another user",{provider:c.provider})}b=S?{}:await m({sessionToken:l(),userId:e.id,expires:i6(n.session.maxAge)});let t={...c,userId:e.id};return{session:b,user:e,isNewUser:_,account:t}}{if(v){await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:_,account:e}}if(t.email?await f(t.email):null)throw new tw("Another account already exists with the same e-mail address",{provider:c.provider});v=await u({...t}),await s.createUser?.({user:v}),await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),b=S?{}:await m({sessionToken:l(),userId:v.id,expires:i6(n.session.maxAge)});let e={...c,userId:v.id};return{session:b,user:v,isNewUser:!0,account:e}}}let k=await p({providerAccountId:c.providerAccountId,provider:c.provider});if(k){if(v){if(k.id===v.id)return{session:b,user:v,isNewUser:_};throw new tt("The account is already associated with another user",{provider:c.provider})}return{session:b=S?{}:await m({sessionToken:l(),userId:k.id,expires:i6(n.session.maxAge)}),user:k,isNewUser:_}}{let{provider:e}=n,{type:r,provider:i,providerAccountId:a,userId:o,...d}=c;if(c=Object.assign(e.account(d)??{},{providerAccountId:a,provider:i,type:r,userId:o}),v)return await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),{session:b,user:v,isNewUser:_};let h=t.email?await f(t.email):null;if(h){let e=n.provider;if(e?.allowDangerousEmailAccountLinking)v=h,_=!1;else throw new tt("Another account already exists with the same e-mail address",{provider:c.provider})}else v=await u({...t,emailVerified:null}),_=!0;return await s.createUser?.({user:v}),await g({...c,userId:v.id}),await s.linkAccount?.({user:v,account:c,profile:t}),{session:b=S?{}:await m({sessionToken:l(),userId:v.id,expires:i6(n.session.maxAge)}),user:v,isNewUser:_}}}function i8(e,t){if(null==e)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(a="oauth4webapi/v3.5.1");let i9="ERR_INVALID_ARG_VALUE",i7="ERR_INVALID_ARG_TYPE";function ae(e,t,r){let n=TypeError(e,{cause:r});return Object.assign(n,{code:t}),n}let at=Symbol(),ar=Symbol(),an=Symbol(),ai=Symbol(),aa=Symbol(),as=Symbol(),ao=Symbol(),al=new TextEncoder,ac=new TextDecoder;function au(e){return"string"==typeof e?al.encode(e):ac.decode(e)}function ad(e){return"string"==typeof e?function(e){try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}catch(e){throw ae("The input to be decoded is not correctly encoded.",i9,e)}}(e):function(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(e)}class ah extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=sm,Error.captureStackTrace?.(this,this.constructor)}}class ap extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,t?.code&&(this.code=t?.code),Error.captureStackTrace?.(this,this.constructor)}}function af(e,t,r){return new ap(e,{code:t,cause:r})}function ag(e){return!(null===e||"object"!=typeof e||Array.isArray(e))}function am(e){i8(e,Headers)&&(e=Object.fromEntries(e.entries()));let t=new Headers(e);if(a&&!t.has("user-agent")&&t.set("user-agent",a),t.has("authorization"))throw ae('"options.headers" must not include the "authorization" header name',i9);return t}function ay(e){if("function"==typeof e&&(e=e()),!(e instanceof AbortSignal))throw ae('"options.signal" must return or be an instance of AbortSignal',i7);return e}function aw(e){return e.includes("//")?e.replace("//","/"):e}async function ab(e,t,r,n){if(!(e instanceof URL))throw ae(`"${t}" must be an instance of URL`,i7);aL(e,n?.[at]!==!0);let i=r(new URL(e.href)),a=am(n?.headers);return a.set("accept","application/json"),(n?.[ai]||fetch)(i.href,{body:void 0,headers:Object.fromEntries(a.entries()),method:"GET",redirect:"manual",signal:n?.signal?ay(n.signal):void 0})}async function av(e,t){return ab(e,"issuerIdentifier",e=>{switch(t?.algorithm){case void 0:case"oidc":e.pathname=aw(`${e.pathname}/.well-known/openid-configuration`);break;case"oauth2":var r;r=".well-known/oauth-authorization-server","/"===e.pathname?e.pathname=r:e.pathname=aw(`${r}/${e.pathname}`);break;default:throw ae('"options.algorithm" must be "oidc" (default), or "oauth2"',i9)}return e},t)}function a_(e,t,r,n,i){try{if("number"!=typeof e||!Number.isFinite(e))throw ae(`${r} must be a number`,i7,i);if(e>0)return;if(t){if(0!==e)throw ae(`${r} must be a non-negative number`,i9,i);return}throw ae(`${r} must be a positive number`,i9,i)}catch(e){if(n)throw af(e.message,n,i);throw e}}function aS(e,t,r,n){try{if("string"!=typeof e)throw ae(`${t} must be a string`,i7,n);if(0===e.length)throw ae(`${t} must not be empty`,i9,n)}catch(e){if(r)throw af(e.message,r,n);throw e}}async function ak(e,t){if(!(e instanceof URL)&&e!==sV)throw ae('"expectedIssuerIdentifier" must be an instance of URL',i7);if(!i8(t,Response))throw ae('"response" must be an instance of Response',i7);if(200!==t.status)throw af('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',sS,t);sR(t);let r=await sq(t);if(aS(r.issuer,'"response" body "issuer" property',sv,{body:r}),e!==sV&&new URL(r.issuer).href!==e.href)throw af('"response" body "issuer" property does not match the expected value',sA,{expected:e.href,body:r,attribute:"issuer"});return r}function aE(e){!function(e,t){if(a2(e)!==t)throw ax(e,t)}(e,"application/json")}function ax(e,...t){let r='"response" content-type must be ';if(t.length>2){let e=t.pop();r+=`${t.join(", ")}, or ${e}`}else 2===t.length?r+=`${t[0]} or ${t[1]}`:r+=t[0];return af(r,s_,e)}function aT(){return ad(crypto.getRandomValues(new Uint8Array(32)))}async function aA(e){return aS(e,"codeVerifier"),ad(await crypto.subtle.digest("SHA-256",au(e)))}function aP(e){let t=e?.[ar];return"number"==typeof t&&Number.isFinite(t)?t:0}function aC(e){let t=e?.[an];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function aO(){return Math.floor(Date.now()/1e3)}function aR(e){if("object"!=typeof e||null===e)throw ae('"as" must be an object',i7);aS(e.issuer,'"as.issuer"')}function aI(e){if("object"!=typeof e||null===e)throw ae('"client" must be an object',i7);aS(e.client_id,'"client.client_id"')}function aj(e,t){let r=aO()+aP(t);return{jti:aT(),aud:e.issuer,exp:r+60,iat:r,nbf:r,iss:t.client_id,sub:t.client_id}}async function a$(e,t,r){if(!r.usages.includes("sign"))throw ae('CryptoKey instances used for signing assertions must include "sign" in their "usages"',i9);let n=`${ad(au(JSON.stringify(e)))}.${ad(au(JSON.stringify(t)))}`,i=ad(await crypto.subtle.sign(sU(r),r,au(n)));return`${n}.${i}`}async function aU(e){let{kty:t,e:r,n,x:i,y:a,crv:o}=await crypto.subtle.exportKey("jwk",e),l={kty:t,e:r,n,x:i,y:a,crv:o};return s.set(e,l),l}let aN=URL.parse?(e,t)=>URL.parse(e,t):(e,t)=>{try{return new URL(e,t)}catch{return null}};function aL(e,t){if(t&&"https:"!==e.protocol)throw af("only requests to HTTPS are allowed",sk,e);if("https:"!==e.protocol&&"http:"!==e.protocol)throw af("only HTTP and HTTPS requests are allowed",sE,e)}function aD(e,t,r,n){let i;if("string"!=typeof e||!(i=aN(e)))throw af(`authorization server metadata does not contain a valid ${r?`"as.mtls_endpoint_aliases.${t}"`:`"as.${t}"`}`,void 0===e?sC:sO,{attribute:r?`mtls_endpoint_aliases.${t}`:t});return aL(i,n),i}function aM(e,t,r,n){return r&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?aD(e.mtls_endpoint_aliases[t],t,r,n):aD(e[t],t,r,n)}class aH extends Error{cause;code;error;status;error_description;response;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=sg,this.cause=t.cause,this.error=t.cause.error,this.status=t.response.status,this.error_description=t.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:t.response}),Error.captureStackTrace?.(this,this.constructor)}}class aW extends Error{cause;code;error;error_description;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=sy,this.cause=t.cause,this.error=t.cause.get("error"),this.error_description=t.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class aK extends Error{cause;code;response;status;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=sf,this.cause=t.cause,this.status=t.response.status,this.response=t.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let aB="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",aq=RegExp("^[,\\s]*("+aB+")\\s(.*)"),aJ=RegExp("^[,\\s]*("+aB+')\\s*=\\s*"((?:[^"\\\\]|\\\\.)*)"[,\\s]*(.*)'),aV=RegExp("^[,\\s]*("+aB+")\\s*=\\s*("+aB+")[,\\s]*(.*)"),aF=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+[=]{0,2})(?:$|[,\\s])(.*)");async function az(e){if(e.status>399&&e.status<500){sR(e),aE(e);try{let t=await e.clone().json();if(ag(t)&&"string"==typeof t.error&&t.error.length)return t}catch{}}}async function aG(e,t,r){if(e.status!==t){let t;if(t=await az(e))throw await e.body?.cancel(),new aH("server responded with an error in the response body",{cause:t,response:e});throw af(`"response" is not a conform ${r} response (unexpected HTTP status code)`,sS,e)}}function aX(e){if(!sa.has(e))throw ae('"options.DPoP" is not a valid DPoPHandle',i9)}async function aY(e,t,r,n,i,a){if(aS(e,'"accessToken"'),!(r instanceof URL))throw ae('"url" must be an instance of URL',i7);aL(r,a?.[at]!==!0),n=am(n),a?.DPoP&&(aX(a.DPoP),await a.DPoP.addProof(r,n,t.toUpperCase(),e)),n.set("authorization",`${n.has("dpop")?"DPoP":"Bearer"} ${e}`);let s=await (a?.[ai]||fetch)(r.href,{body:i,headers:Object.fromEntries(n.entries()),method:t,redirect:"manual",signal:a?.signal?ay(a.signal):void 0});return a?.DPoP?.cacheNonce(s),s}async function aZ(e,t,r,n){aR(e),aI(t);let i=aM(e,"userinfo_endpoint",t.use_mtls_endpoint_aliases,n?.[at]!==!0),a=am(n?.headers);return t.userinfo_signed_response_alg?a.set("accept","application/jwt"):(a.set("accept","application/json"),a.append("accept","application/jwt")),aY(r,"GET",i,a,null,{...n,[ar]:aP(t)})}function aQ(e,t,r,n){(o||=new WeakMap).set(e,{jwks:t,uat:r,get age(){return aO()-this.uat}}),n&&Object.assign(n,{jwks:structuredClone(t),uat:r})}function a0(e,t){o?.delete(e),delete t?.jwks,delete t?.uat}let a1=Symbol();function a2(e){return e.headers.get("content-type")?.split(";")[0]}async function a5(e,t,r,n,i){let a;if(aR(e),aI(t),!i8(n,Response))throw ae('"response" must be an instance of Response',i7);if(se(n),200!==n.status)throw af('"response" is not a conform UserInfo Endpoint response (unexpected HTTP status code)',sS,n);if(sR(n),"application/jwt"===a2(n)){let{claims:r,jwt:s}=await sN(await n.text(),sM.bind(void 0,t.userinfo_signed_response_alg,e.userinfo_signing_alg_values_supported,void 0),aP(t),aC(t),i?.[as]).then(st.bind(void 0,t.client_id)).then(sn.bind(void 0,e));a8.set(n,s),a=r}else{if(t.userinfo_signed_response_alg)throw af("JWT UserInfo Response expected",sw,n);a=await sq(n)}if(aS(a.sub,'"response" body "sub" property',sv,{body:a}),r===a1);else if(aS(r,'"expectedSubject"'),a.sub!==r)throw af('unexpected "response" body "sub" property value',sA,{expected:r,body:a,attribute:"sub"});return a}async function a3(e,t,r,n,i,a,s){return await r(e,t,i,a),a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(s?.[ai]||fetch)(n.href,{body:i,headers:Object.fromEntries(a.entries()),method:"POST",redirect:"manual",signal:s?.signal?ay(s.signal):void 0})}async function a6(e,t,r,n,i,a){let s=aM(e,"token_endpoint",t.use_mtls_endpoint_aliases,a?.[at]!==!0);i.set("grant_type",n);let o=am(a?.headers);o.set("accept","application/json"),a?.DPoP!==void 0&&(aX(a.DPoP),await a.DPoP.addProof(s,o,"POST"));let l=await a3(e,t,r,s,i,o,a);return a?.DPoP?.cacheNonce(l),l}let a4=new WeakMap,a8=new WeakMap;function a9(e){if(!e.id_token)return;let t=a4.get(e);if(!t)throw ae('"ref" was already garbage collected or did not resolve from the proper sources',i9);return t}async function a7(e,t,r,n,i){if(aR(e),aI(t),!i8(r,Response))throw ae('"response" must be an instance of Response',i7);se(r),await aG(r,200,"Token Endpoint"),sR(r);let a=await sq(r);if(aS(a.access_token,'"response" body "access_token" property',sv,{body:a}),aS(a.token_type,'"response" body "token_type" property',sv,{body:a}),a.token_type=a.token_type.toLowerCase(),"dpop"!==a.token_type&&"bearer"!==a.token_type)throw new ah("unsupported `token_type` value",{cause:{body:a}});if(void 0!==a.expires_in){let e="number"!=typeof a.expires_in?parseFloat(a.expires_in):a.expires_in;a_(e,!1,'"response" body "expires_in" property',sv,{body:a}),a.expires_in=e}if(void 0!==a.refresh_token&&aS(a.refresh_token,'"response" body "refresh_token" property',sv,{body:a}),void 0!==a.scope&&"string"!=typeof a.scope)throw af('"response" body "scope" property must be a string',sv,{body:a});if(void 0!==a.id_token){aS(a.id_token,'"response" body "id_token" property',sv,{body:a});let s=["aud","exp","iat","iss","sub"];!0===t.require_auth_time&&s.push("auth_time"),void 0!==t.default_max_age&&(a_(t.default_max_age,!1,'"client.default_max_age"'),s.push("auth_time")),n?.length&&s.push(...n);let{claims:o,jwt:l}=await sN(a.id_token,sM.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported,"RS256"),aP(t),aC(t),i?.[as]).then(sl.bind(void 0,s)).then(si.bind(void 0,e)).then(sr.bind(void 0,t.client_id));if(Array.isArray(o.aud)&&1!==o.aud.length){if(void 0===o.azp)throw af('ID Token "aud" (audience) claim includes additional untrusted audiences',sT,{claims:o,claim:"aud"});if(o.azp!==t.client_id)throw af('unexpected ID Token "azp" (authorized party) claim value',sT,{expected:t.client_id,claims:o,claim:"azp"})}void 0!==o.auth_time&&a_(o.auth_time,!1,'ID Token "auth_time" (authentication time)',sv,{claims:o}),a8.set(r,l),a4.set(a,o)}return a}function se(e){let t;if(t=function(e){if(!i8(e,Response))throw ae('"response" must be an instance of Response',i7);let t=e.headers.get("www-authenticate");if(null===t)return;let r=[],n=t;for(;n;){let e,t=n.match(aq),i=t?.["1"].toLowerCase();if(n=t?.["2"],!i)return;let a={};for(;n;){let r,i;if(t=n.match(aJ)){if([,r,i,n]=t,i.includes("\\"))try{i=JSON.parse(`"${i}"`)}catch{}a[r.toLowerCase()]=i;continue}if(t=n.match(aV)){[,r,i,n]=t,a[r.toLowerCase()]=i;continue}if(t=n.match(aF)){if(Object.keys(a).length)break;[,e,n]=t;break}return}let s={scheme:i,parameters:a};e&&(s.token68=e),r.push(s)}if(r.length)return r}(e))throw new aK("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:t,response:e})}function st(e,t){return void 0!==t.claims.aud?sr(e,t):t}function sr(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw af('unexpected JWT "aud" (audience) claim value',sT,{expected:e,claims:t.claims,claim:"aud"})}else if(t.claims.aud!==e)throw af('unexpected JWT "aud" (audience) claim value',sT,{expected:e,claims:t.claims,claim:"aud"});return t}function sn(e,t){return void 0!==t.claims.iss?si(e,t):t}function si(e,t){let r=e[sF]?.(t)??e.issuer;if(t.claims.iss!==r)throw af('unexpected JWT "iss" (issuer) claim value',sT,{expected:r,claims:t.claims,claim:"iss"});return t}let sa=new WeakSet;async function ss(e,t,r,n,i,a,s){if(aR(e),aI(t),!sa.has(n))throw ae('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',i9);aS(i,'"redirectUri"');let o=sH(n,"code");if(!o)throw af('no authorization code in "callbackParameters"',sv);let l=new URLSearchParams(s?.additionalParameters);return l.set("redirect_uri",i),l.set("code",o),a!==sJ&&(aS(a,'"codeVerifier"'),l.set("code_verifier",a)),a6(e,t,r,"authorization_code",l,s)}let so={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function sl(e,t){for(let r of e)if(void 0===t.claims[r])throw af(`JWT "${r}" (${so[r]}) claim missing`,sv,{claims:t.claims});return t}let sc=Symbol(),su=Symbol();async function sd(e,t,r,n){return"string"==typeof n?.expectedNonce||"number"==typeof n?.maxAge||n?.requireIdToken?sh(e,t,r,n.expectedNonce,n.maxAge,{[as]:n[as]}):sp(e,t,r,n)}async function sh(e,t,r,n,i,a){let s=[];switch(n){case void 0:n=sc;break;case sc:break;default:aS(n,'"expectedNonce" argument'),s.push("nonce")}switch(i??=t.default_max_age){case void 0:i=su;break;case su:break;default:a_(i,!1,'"maxAge" argument'),s.push("auth_time")}let o=await a7(e,t,r,s,a);aS(o.id_token,'"response" body "id_token" property',sv,{body:o});let l=a9(o);if(i!==su){let e=aO()+aP(t),r=aC(t);if(l.auth_time+i<e-r)throw af("too much time has elapsed since the last End-User authentication",sx,{claims:l,now:e,tolerance:r,claim:"auth_time"})}if(n===sc){if(void 0!==l.nonce)throw af('unexpected ID Token "nonce" claim value',sT,{expected:void 0,claims:l,claim:"nonce"})}else if(l.nonce!==n)throw af('unexpected ID Token "nonce" claim value',sT,{expected:n,claims:l,claim:"nonce"});return o}async function sp(e,t,r,n){let i=await a7(e,t,r,void 0,n),a=a9(i);if(a){if(void 0!==t.default_max_age){a_(t.default_max_age,!1,'"client.default_max_age"');let e=aO()+aP(t),r=aC(t);if(a.auth_time+t.default_max_age<e-r)throw af("too much time has elapsed since the last End-User authentication",sx,{claims:a,now:e,tolerance:r,claim:"auth_time"})}if(void 0!==a.nonce)throw af('unexpected ID Token "nonce" claim value',sT,{expected:void 0,claims:a,claim:"nonce"})}return i}let sf="OAUTH_WWW_AUTHENTICATE_CHALLENGE",sg="OAUTH_RESPONSE_BODY_ERROR",sm="OAUTH_UNSUPPORTED_OPERATION",sy="OAUTH_AUTHORIZATION_RESPONSE_ERROR",sw="OAUTH_JWT_USERINFO_EXPECTED",sb="OAUTH_PARSE_ERROR",sv="OAUTH_INVALID_RESPONSE",s_="OAUTH_RESPONSE_IS_NOT_JSON",sS="OAUTH_RESPONSE_IS_NOT_CONFORM",sk="OAUTH_HTTP_REQUEST_FORBIDDEN",sE="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",sx="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",sT="OAUTH_JWT_CLAIM_COMPARISON_FAILED",sA="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",sP="OAUTH_KEY_SELECTION_FAILED",sC="OAUTH_MISSING_SERVER_METADATA",sO="OAUTH_INVALID_SERVER_METADATA";function sR(e){if(e.bodyUsed)throw ae('"response" body has been used already',i9)}async function sI(e,t){aR(e);let r=aM(e,"jwks_uri",!1,t?.[at]!==!0),n=am(t?.headers);return n.set("accept","application/json"),n.append("accept","application/jwk-set+json"),(t?.[ai]||fetch)(r.href,{body:void 0,headers:Object.fromEntries(n.entries()),method:"GET",redirect:"manual",signal:t?.signal?ay(t.signal):void 0})}async function sj(e){if(!i8(e,Response))throw ae('"response" must be an instance of Response',i7);if(200!==e.status)throw af('"response" is not a conform JSON Web Key Set response (unexpected HTTP status code)',sS,e);sR(e);let t=await sq(e,e=>(function(e,...t){if(!t.includes(a2(e)))throw ax(e,...t)})(e,"application/json","application/jwk-set+json"));if(!Array.isArray(t.keys))throw af('"response" body "keys" property must be an array',sv,{body:t});if(!Array.prototype.every.call(t.keys,ag))throw af('"response" body "keys" property members must be JWK formatted objects',sv,{body:t});return t}function s$(e){let{algorithm:t}=e;if("number"!=typeof t.modulusLength||t.modulusLength<2048)throw new ah(`unsupported ${t.name} modulusLength`,{cause:e})}function sU(e){switch(e.algorithm.name){case"ECDSA":return{name:e.algorithm.name,hash:function(e){let{algorithm:t}=e;switch(t.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new ah("unsupported ECDSA namedCurve",{cause:e})}}(e)};case"RSA-PSS":switch(s$(e),e.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:e.algorithm.name,saltLength:parseInt(e.algorithm.hash.name.slice(-3),10)>>3};default:throw new ah("unsupported RSA-PSS hash name",{cause:e})}case"RSASSA-PKCS1-v1_5":return s$(e),e.algorithm.name;case"Ed25519":return e.algorithm.name}throw new ah("unsupported CryptoKey algorithm name",{cause:e})}async function sN(e,t,r,n,i){let a,s,{0:o,1:l,length:c}=e.split(".");if(5===c){if(void 0!==i)e=await i(e),{0:o,1:l,length:c}=e.split(".");else throw new ah("JWE decryption is not configured",{cause:e})}if(3!==c)throw af("Invalid JWT",sv,e);try{a=JSON.parse(au(ad(o)))}catch(e){throw af("failed to parse JWT Header body as base64url encoded JSON",sb,e)}if(!ag(a))throw af("JWT Header must be a top level object",sv,e);if(t(a),void 0!==a.crit)throw new ah('no JWT "crit" header parameter extensions are supported',{cause:{header:a}});try{s=JSON.parse(au(ad(l)))}catch(e){throw af("failed to parse JWT Payload body as base64url encoded JSON",sb,e)}if(!ag(s))throw af("JWT Payload must be a top level object",sv,e);let u=aO()+r;if(void 0!==s.exp){if("number"!=typeof s.exp)throw af('unexpected JWT "exp" (expiration time) claim type',sv,{claims:s});if(s.exp<=u-n)throw af('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',sx,{claims:s,now:u,tolerance:n,claim:"exp"})}if(void 0!==s.iat&&"number"!=typeof s.iat)throw af('unexpected JWT "iat" (issued at) claim type',sv,{claims:s});if(void 0!==s.iss&&"string"!=typeof s.iss)throw af('unexpected JWT "iss" (issuer) claim type',sv,{claims:s});if(void 0!==s.nbf){if("number"!=typeof s.nbf)throw af('unexpected JWT "nbf" (not before) claim type',sv,{claims:s});if(s.nbf>u+n)throw af('unexpected JWT "nbf" (not before) claim value',sx,{claims:s,now:u,tolerance:n,claim:"nbf"})}if(void 0!==s.aud&&"string"!=typeof s.aud&&!Array.isArray(s.aud))throw af('unexpected JWT "aud" (audience) claim type',sv,{claims:s});return{header:a,claims:s,jwt:e}}async function sL(e,t,r){let n;switch(t.alg){case"RS256":case"PS256":case"ES256":n="SHA-256";break;case"RS384":case"PS384":case"ES384":n="SHA-384";break;case"RS512":case"PS512":case"ES512":case"Ed25519":case"EdDSA":n="SHA-512";break;default:throw new ah(`unsupported JWS algorithm for ${r} calculation`,{cause:{alg:t.alg}})}let i=await crypto.subtle.digest(n,au(e));return ad(i.slice(0,i.byteLength/2))}async function sD(e){if(e.bodyUsed)throw ae("form_post Request instances must contain a readable body",i9,{cause:e});return e.text()}function sM(e,t,r,n){if(void 0!==e){if("string"==typeof e?n.alg!==e:!e.includes(n.alg))throw af('unexpected JWT "alg" header parameter',sv,{header:n,expected:e,reason:"client configuration"});return}if(Array.isArray(t)){if(!t.includes(n.alg))throw af('unexpected JWT "alg" header parameter',sv,{header:n,expected:t,reason:"authorization server metadata"});return}if(void 0!==r){if("string"==typeof r?n.alg!==r:"function"==typeof r?!r(n.alg):!r.includes(n.alg))throw af('unexpected JWT "alg" header parameter',sv,{header:n,expected:r,reason:"default value"});return}throw af('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:e,issuer:t,fallback:r})}function sH(e,t){let{0:r,length:n}=e.getAll(t);if(n>1)throw af(`"${t}" parameter must be provided only once`,sv);return r}let sW=Symbol(),sK=Symbol();async function sB(e,t){let{ext:r,key_ops:n,use:i,...a}=t;return crypto.subtle.importKey("jwk",a,function(e){switch(e){case"PS256":case"PS384":case"PS512":return{name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`};case"RS256":case"RS384":case"RS512":return{name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`};case"ES256":case"ES384":return{name:"ECDSA",namedCurve:`P-${e.slice(-3)}`};case"ES512":return{name:"ECDSA",namedCurve:"P-521"};case"Ed25519":case"EdDSA":return"Ed25519";default:throw new ah("unsupported JWS algorithm",{cause:{alg:e}})}}(e),!0,["verify"])}async function sq(e,t=aE){let r;try{r=await e.json()}catch(r){throw t(e),af('failed to parse "response" body as JSON',sb,r)}if(!ag(r))throw af('"response" body must be a top level object',sv,{body:r});return r}let sJ=Symbol(),sV=Symbol(),sF=Symbol();async function sz(e,t,r){let{cookies:n,logger:i}=r,a=n[e],s=new Date;s.setTime(s.getTime()+9e5),i.debug(`CREATE_${e.toUpperCase()}`,{name:a.name,payload:t,COOKIE_TTL:900,expires:s});let o=await np({...r.jwt,maxAge:900,token:{value:t},salt:a.name}),l={...a.options,expires:s};return{name:a.name,value:o,options:l}}async function sG(e,t,r){try{let{logger:n,cookies:i,jwt:a}=r;if(n.debug(`PARSE_${e.toUpperCase()}`,{cookie:t}),!t)throw new e6(`${e} cookie was missing`);let s=await nf({...a,token:t,salt:i[e].name});if(s?.value)return s.value;throw Error("Invalid cookie")}catch(t){throw new e6(`${e} value could not be parsed`,{cause:t})}}function sX(e,t,r){let{logger:n,cookies:i}=t,a=i[e];n.debug(`CLEAR_${e.toUpperCase()}`,{cookie:a}),r.push({name:a.name,value:"",options:{...i[e].options,maxAge:0}})}function sY(e,t){return async function(r,n,i){let{provider:a,logger:s}=i;if(!a?.checks?.includes(e))return;let o=r?.[i.cookies[t].name];s.debug(`USE_${t.toUpperCase()}`,{value:o});let l=await sG(t,o,i);return sX(t,i,n),l}}let sZ={async create(e){let t=aT(),r=await aA(t);return{cookie:await sz("pkceCodeVerifier",t,e),value:r}},use:sY("pkce","pkceCodeVerifier")},sQ="encodedState",s0={async create(e,t){let{provider:r}=e;if(!r.checks.includes("state")){if(t)throw new e6("State data was provided but the provider is not configured to use state");return}let n={origin:t,random:aT()},i=await np({secret:e.jwt.secret,token:n,salt:sQ,maxAge:900});return{cookie:await sz("state",i,e),value:i}},use:sY("state","state"),async decode(e,t){try{t.logger.debug("DECODE_STATE",{state:e});let r=await nf({secret:t.jwt.secret,token:e,salt:sQ});if(r)return r;throw Error("Invalid state")}catch(e){throw new e6("State could not be decoded",{cause:e})}}},s1={async create(e){if(!e.provider.checks.includes("nonce"))return;let t=aT();return{cookie:await sz("nonce",t,e),value:t}},use:sY("nonce","nonce")},s2="encodedWebauthnChallenge",s5={create:async(e,t,r)=>({cookie:await sz("webauthnChallenge",await np({secret:e.jwt.secret,token:{challenge:t,registerData:r},salt:s2,maxAge:900}),e)}),async use(e,t,r){let n=t?.[e.cookies.webauthnChallenge.name],i=await sG("webauthnChallenge",n,e),a=await nf({secret:e.jwt.secret,token:i,salt:s2});if(sX("webauthnChallenge",e,r),!a)throw new e6("WebAuthn challenge was missing");return a}};function s3(e){return encodeURIComponent(e).replace(/%20/g,"+")}async function s6(e,t,r){let n,i,a;let{logger:s,provider:o}=r,{token:l,userinfo:c}=o;if(l?.url&&"authjs.dev"!==l.url.host||c?.url&&"authjs.dev"!==c.url.host)n={issuer:o.issuer??"https://authjs.dev",token_endpoint:l?.url.toString(),userinfo_endpoint:c?.url.toString()};else{let e=new URL(o.issuer),t=await av(e,{[at]:!0,[ai]:o[nU]});if(!(n=await ak(e,t)).token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!n.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.")}let u={client_id:o.clientId,...o.client};switch(u.token_endpoint_auth_method){case void 0:case"client_secret_basic":i=(e,t,r,n)=>{n.set("authorization",function(e,t){let r=s3(e),n=s3(t),i=btoa(`${r}:${n}`);return`Basic ${i}`}(o.clientId,o.clientSecret))};break;case"client_secret_post":var d;aS(d=o.clientSecret,'"clientSecret"'),i=(e,t,r,n)=>{r.set("client_id",t.client_id),r.set("client_secret",d)};break;case"client_secret_jwt":i=function(e,t){let r;aS(e,'"clientSecret"');let n=void 0;return async(t,i,a,s)=>{r||=await crypto.subtle.importKey("raw",au(e),{hash:"SHA-256",name:"HMAC"},!1,["sign"]);let o={alg:"HS256"},l=aj(t,i);n?.(o,l);let c=`${ad(au(JSON.stringify(o)))}.${ad(au(JSON.stringify(l)))}`,u=await crypto.subtle.sign(r.algorithm,r,au(c));a.set("client_id",i.client_id),a.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),a.set("client_assertion",`${c}.${ad(new Uint8Array(u))}`)}}(o.clientSecret);break;case"private_key_jwt":i=function(e,t){let{key:r,kid:n}=e instanceof CryptoKey?{key:e}:e?.key instanceof CryptoKey?(void 0!==e.kid&&aS(e.kid,'"kid"'),{key:e.key,kid:e.kid}):{};return function(e,t){if(function(e,t){if(!(e instanceof CryptoKey))throw ae(`${t} must be a CryptoKey`,i7)}(e,t),"private"!==e.type)throw ae(`${t} must be a private CryptoKey`,i9)}(r,'"clientPrivateKey.key"'),async(e,i,a,s)=>{let o={alg:function(e){switch(e.algorithm.name){case"RSA-PSS":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new ah("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}}(e);case"RSASSA-PKCS1-v1_5":return function(e){switch(e.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new ah("unsupported RsaHashedKeyAlgorithm hash name",{cause:e})}}(e);case"ECDSA":return function(e){switch(e.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new ah("unsupported EcKeyAlgorithm namedCurve",{cause:e})}}(e);case"Ed25519":case"EdDSA":return"Ed25519";default:throw new ah("unsupported CryptoKey algorithm name",{cause:e})}}(r),kid:n},l=aj(e,i);t?.[aa]?.(o,l),a.set("client_id",i.client_id),a.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),a.set("client_assertion",await a$(o,l,r))}}(o.token.clientPrivateKey,{[aa](e,t){t.aud=[n.issuer,n.token_endpoint]}});break;case"none":i=(e,t,r,n)=>{r.set("client_id",t.client_id)};break;default:throw Error("unsupported client authentication method")}let h=[],p=await s0.use(t,h,r);try{a=function(e,t,r,n){var i;if(aR(e),aI(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw ae('"parameters" must be an instance of URLSearchParams, or URL',i7);if(sH(r,"response"))throw af('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',sv,{parameters:r});let a=sH(r,"iss"),s=sH(r,"state");if(!a&&e.authorization_response_iss_parameter_supported)throw af('response parameter "iss" (issuer) missing',sv,{parameters:r});if(a&&a!==e.issuer)throw af('unexpected "iss" (issuer) response parameter value',sv,{expected:e.issuer,parameters:r});switch(n){case void 0:case sK:if(void 0!==s)throw af('unexpected "state" response parameter encountered',sv,{expected:void 0,parameters:r});break;case sW:break;default:if(aS(n,'"expectedState" argument'),s!==n)throw af(void 0===s?'response parameter "state" missing':'unexpected "state" response parameter value',sv,{expected:n,parameters:r})}if(sH(r,"error"))throw new aW("authorization response from the server is an error",{cause:r});let o=sH(r,"id_token"),l=sH(r,"token");if(void 0!==o||void 0!==l)throw new ah("implicit and hybrid flows are not supported");return i=new URLSearchParams(r),sa.add(i),i}(n,u,new URLSearchParams(e),o.checks.includes("state")?p:sW)}catch(e){if(e instanceof aW){let t={providerId:o.id,...Object.fromEntries(e.cause.entries())};throw s.debug("OAuthCallbackError",t),new tr("OAuth Provider returned an error",t)}throw e}let f=await sZ.use(t,h,r),g=o.callbackUrl;!r.isOnRedirectProxy&&o.redirectProxyUrl&&(g=o.redirectProxyUrl);let m=await ss(n,u,i,a,g,f??"decoy",{[at]:!0,[ai]:(...e)=>(o.checks.includes("pkce")||e[1].body.delete("code_verifier"),(o[nU]??fetch)(...e))});o.token?.conform&&(m=await o.token.conform(m.clone())??m);let y={},w="oidc"===o.type;if(o[nN])switch(o.id){case"microsoft-entra-id":case"azure-ad":{let e=await m.clone().json();if(e.error){let t={providerId:o.id,...e};throw new tr(`OAuth Provider returned an error: ${e.error}`,t)}let{tid:t}=function(e){let t,r;if("string"!=typeof e)throw new tz("JWTs must use Compact JWS serialization, JWT must be a string");let{1:n,length:i}=e.split(".");if(5===i)throw new tz("Only JWTs using Compact JWS serialization can be decoded");if(3!==i)throw new tz("Invalid JWT");if(!n)throw new tz("JWTs must contain a payload");try{t=tM(n)}catch{throw new tz("Failed to base64url decode the payload")}try{r=JSON.parse(t$.decode(t))}catch{throw new tz("Failed to parse the decoded payload as JSON")}if(!t1(r))throw new tz("Invalid JWT Claims Set");return r}(e.id_token);if("string"==typeof t){let e=n.issuer?.match(/microsoftonline\.com\/(\w+)\/v2\.0/)?.[1]??"common",r=new URL(n.issuer.replace(e,t)),i=await av(r,{[ai]:o[nU]});n=await ak(r,i)}}}let b=await sd(n,u,m,{expectedNonce:await s1.use(t,h,r),requireIdToken:w});if(w){let t=a9(b);if(y=t,o[nN]&&"apple"===o.id)try{y.user=JSON.parse(e?.user)}catch{}if(!1===o.idToken){let e=await aZ(n,u,b.access_token,{[ai]:o[nU],[at]:!0});y=await a5(n,u,t.sub,e)}}else if(c?.request){let e=await c.request({tokens:b,provider:o});e instanceof Object&&(y=e)}else if(c?.url){let e=await aZ(n,u,b.access_token,{[ai]:o[nU],[at]:!0});y=await e.json()}else throw TypeError("No userinfo endpoint configured");return b.expires_in&&(b.expires_at=Math.floor(Date.now()/1e3)+Number(b.expires_in)),{...await s4(y,o,b,s),profile:y,cookies:h}}async function s4(e,t,r,n){try{let n=await t.profile(e,r);return{user:{...n,id:crypto.randomUUID(),email:n.email?.toLowerCase()},account:{...r,provider:t.id,type:t.type,providerAccountId:n.id??crypto.randomUUID()}}}catch(r){n.debug("getProfile error details",e),n.error(new tn(r,{provider:t.id}))}}var s8=r(195).Buffer;async function s9(e,t,r,n){let i=await on(e,t,r),{cookie:a}=await s5.create(e,i.challenge,r);return{status:200,cookies:[...n??[],a],body:{action:"register",options:i},headers:{"Content-Type":"application/json"}}}async function s7(e,t,r,n){let i=await or(e,t,r),{cookie:a}=await s5.create(e,i.challenge);return{status:200,cookies:[...n??[],a],body:{action:"authenticate",options:i},headers:{"Content-Type":"application/json"}}}async function oe(e,t,r){let n;let{adapter:i,provider:a}=e,s=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!s||"object"!=typeof s||!("id"in s)||"string"!=typeof s.id)throw new eG("Invalid WebAuthn Authentication response");let o=os(oa(s.id)),l=await i.getAuthenticator(o);if(!l)throw new eG(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:o})}`);let{challenge:c}=await s5.use(e,t.cookies,r);try{let r=a.getRelayingParty(e,t);n=await a.simpleWebAuthn.verifyAuthenticationResponse({...a.verifyAuthenticationOptions,expectedChallenge:c,response:s,authenticator:{...l,credentialDeviceType:l.credentialDeviceType,transports:oo(l.transports),credentialID:oa(l.credentialID),credentialPublicKey:oa(l.credentialPublicKey)},expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new ty(e)}let{verified:u,authenticationInfo:d}=n;if(!u)throw new ty("WebAuthn authentication response could not be verified");try{let{newCounter:e}=d;await i.updateAuthenticatorCounter(l.credentialID,e)}catch(e){throw new eY(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:o,oldCounter:l.counter,newCounter:d.newCounter})}`,e)}let h=await i.getAccount(l.providerAccountId,a.id);if(!h)throw new eG(`WebAuthn account not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId})}`);let p=await i.getUser(h.userId);if(!p)throw new eG(`WebAuthn user not found in database: ${JSON.stringify({credentialID:o,providerAccountId:l.providerAccountId,userID:h.userId})}`);return{account:h,user:p}}async function ot(e,t,r){var n;let i;let{provider:a}=e,s=t.body&&"string"==typeof t.body.data?JSON.parse(t.body.data):void 0;if(!s||"object"!=typeof s||!("id"in s)||"string"!=typeof s.id)throw new eG("Invalid WebAuthn Registration response");let{challenge:o,registerData:l}=await s5.use(e,t.cookies,r);if(!l)throw new eG("Missing user registration data in WebAuthn challenge cookie");try{let r=a.getRelayingParty(e,t);i=await a.simpleWebAuthn.verifyRegistrationResponse({...a.verifyRegistrationOptions,expectedChallenge:o,response:s,expectedOrigin:r.origin,expectedRPID:r.id})}catch(e){throw new ty(e)}if(!i.verified||!i.registrationInfo)throw new ty("WebAuthn registration response could not be verified");let c={providerAccountId:os(i.registrationInfo.credentialID),provider:e.provider.id,type:a.type},u={providerAccountId:c.providerAccountId,counter:i.registrationInfo.counter,credentialID:os(i.registrationInfo.credentialID),credentialPublicKey:os(i.registrationInfo.credentialPublicKey),credentialBackedUp:i.registrationInfo.credentialBackedUp,credentialDeviceType:i.registrationInfo.credentialDeviceType,transports:(n=s.response.transports,n?.join(","))};return{user:l,account:c,authenticator:u}}async function or(e,t,r){let{provider:n,adapter:i}=e,a=r&&r.id?await i.listAuthenticatorsByUserId(r.id):null,s=n.getRelayingParty(e,t);return await n.simpleWebAuthn.generateAuthenticationOptions({...n.authenticationOptions,rpID:s.id,allowCredentials:a?.map(e=>({id:oa(e.credentialID),type:"public-key",transports:oo(e.transports)}))})}async function on(e,t,r){let{provider:n,adapter:i}=e,a=r.id?await i.listAuthenticatorsByUserId(r.id):null,s=nP(32),o=n.getRelayingParty(e,t);return await n.simpleWebAuthn.generateRegistrationOptions({...n.registrationOptions,userID:s,userName:r.email,userDisplayName:r.name??void 0,rpID:o.id,rpName:o.name,excludeCredentials:a?.map(e=>({id:oa(e.credentialID),type:"public-key",transports:oo(e.transports)}))})}function oi(e){let{provider:t,adapter:r}=e;if(!r)throw new e8("An adapter is required for the WebAuthn provider");if(!t||"webauthn"!==t.type)throw new tu("Provider must be WebAuthn");return{...e,provider:t,adapter:r}}function oa(e){return new Uint8Array(s8.from(e,"base64"))}function os(e){return s8.from(e).toString("base64")}function oo(e){return e?e.split(","):void 0}async function ol(e,t,r,n){if(!t.provider)throw new tu("Callback route called without provider");let{query:i,body:a,method:s,headers:o}=e,{provider:l,adapter:c,url:u,callbackUrl:d,pages:h,jwt:p,events:f,callbacks:g,session:{strategy:m,maxAge:y},logger:w}=t,b="jwt"===m;try{if("oauth"===l.type||"oidc"===l.type){let s;let o=l.authorization?.url.searchParams.get("response_mode")==="form_post"?a:i;if(t.isOnRedirectProxy&&o?.state){let e=await s0.decode(o.state,t);if(e?.origin&&new URL(e.origin).origin!==t.url.origin){let t=`${e.origin}?${new URLSearchParams(o)}`;return w.debug("Proxy redirecting to",t),{redirect:t,cookies:n}}}let m=await s6(o,e.cookies,t);m.cookies.length&&n.push(...m.cookies),w.debug("authorization result",m);let{user:v,account:_,profile:S}=m;if(!v||!_||!S)return{redirect:`${u}/signin`,cookies:n};if(c){let{getUserByAccount:e}=c;s=await e({providerAccountId:_.providerAccountId,provider:l.id})}let k=await oc({user:s??v,account:_,profile:S},t);if(k)return{redirect:k,cookies:n};let{user:E,session:x,isNewUser:T}=await i4(r.value,v,_,t);if(b){let e={name:E.name,email:E.email,picture:E.image,sub:E.id?.toString()},i=await g.jwt({token:e,user:E,account:_,profile:S,isNewUser:T,trigger:T?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*y);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:x.sessionToken,options:{...t.cookies.sessionToken.options,expires:x.expires}});if(await f.signIn?.({user:E,account:_,profile:S,isNewUser:T}),T&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}if("email"===l.type){let e=i?.token,a=i?.email;if(!e){let t=TypeError("Missing token. The sign-in URL was manually opened without token or the link was not sent correctly in the email.",{cause:{hasToken:!!e}});throw t.name="Configuration",t}let s=l.secret??t.secret,o=await c.useVerificationToken({identifier:a,token:await nA(`${e}${s}`)}),u=!!o,m=u&&o.expires.valueOf()<Date.now();if(!u||m||a&&o.identifier!==a)throw new th({hasInvite:u,expired:m});let{identifier:w}=o,v=await c.getUserByEmail(w)??{id:crypto.randomUUID(),email:w,emailVerified:null},_={providerAccountId:v.email,userId:v.id,type:"email",provider:l.id},S=await oc({user:v,account:_},t);if(S)return{redirect:S,cookies:n};let{user:k,session:E,isNewUser:x}=await i4(r.value,v,_,t);if(b){let e={name:k.name,email:k.email,picture:k.image,sub:k.id?.toString()},i=await g.jwt({token:e,user:k,account:_,isNewUser:x,trigger:x?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*y);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:E.sessionToken,options:{...t.cookies.sessionToken.options,expires:E.expires}});if(await f.signIn?.({user:k,account:_,isNewUser:x}),x&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}if("credentials"===l.type&&"POST"===s){let e=a??{};Object.entries(i??{}).forEach(([e,t])=>u.searchParams.set(e,t));let c=await l.authorize(e,new Request(u,{headers:o,method:s,body:JSON.stringify(a)}));if(c)c.id=c.id?.toString()??crypto.randomUUID();else throw new e5;let h={providerAccountId:c.id,type:"credentials",provider:l.id},m=await oc({user:c,account:h,credentials:e},t);if(m)return{redirect:m,cookies:n};let w={name:c.name,email:c.email,picture:c.image,sub:c.id},b=await g.jwt({token:w,user:c,account:h,isNewUser:!1,trigger:"signIn"});if(null===b)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,i=await p.encode({...p,token:b,salt:e}),a=new Date;a.setTime(a.getTime()+1e3*y);let s=r.chunk(i,{expires:a});n.push(...s)}return await f.signIn?.({user:c,account:h}),{redirect:d,cookies:n}}if("webauthn"===l.type&&"POST"===s){let i,a,s;let o=e.body?.action;if("string"!=typeof o||"authenticate"!==o&&"register"!==o)throw new eG("Invalid action parameter");let l=oi(t);switch(o){case"authenticate":{let t=await oe(l,e,n);i=t.user,a=t.account;break}case"register":{let r=await ot(t,e,n);i=r.user,a=r.account,s=r.authenticator}}await oc({user:i,account:a},t);let{user:c,isNewUser:u,session:m,account:w}=await i4(r.value,i,a,t);if(!w)throw new eG("Error creating or finding account");if(s&&c.id&&await l.adapter.createAuthenticator({...s,userId:c.id}),b){let e={name:c.name,email:c.email,picture:c.image,sub:c.id?.toString()},i=await g.jwt({token:e,user:c,account:w,isNewUser:u,trigger:u?"signUp":"signIn"});if(null===i)n.push(...r.clean());else{let e=t.cookies.sessionToken.name,a=await p.encode({...p,token:i,salt:e}),s=new Date;s.setTime(s.getTime()+1e3*y);let o=r.chunk(a,{expires:s});n.push(...o)}}else n.push({name:t.cookies.sessionToken.name,value:m.sessionToken,options:{...t.cookies.sessionToken.options,expires:m.expires}});if(await f.signIn?.({user:c,account:w,isNewUser:u}),u&&h.newUser)return{redirect:`${h.newUser}${h.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:d})}`,cookies:n};return{redirect:d,cookies:n}}throw new tu(`Callback for provider type (${l.type}) is not supported`)}catch(t){if(t instanceof eG)throw t;let e=new eQ(t,{provider:l.id});throw w.debug("callback route error details",{method:s,query:i,body:a}),e}}async function oc(e,t){let r;let{signIn:n,redirect:i}=t.callbacks;try{r=await n(e)}catch(e){if(e instanceof eG)throw e;throw new eZ(e)}if(!r)throw new eZ("AccessDenied");if("string"==typeof r)return await i({url:r,baseUrl:t.url.origin})}async function ou(e,t,r,n,i){let{adapter:a,jwt:s,events:o,callbacks:l,logger:c,session:{strategy:u,maxAge:d}}=e,h={body:null,headers:{"Content-Type":"application/json",...!n&&{"Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"}},cookies:r},p=t.value;if(!p)return h;if("jwt"===u){try{let r=e.cookies.sessionToken.name,a=await s.decode({...s,token:p,salt:r});if(!a)throw Error("Invalid JWT");let c=await l.jwt({token:a,...n&&{trigger:"update"},session:i}),u=i6(d);if(null!==c){let e={user:{name:c.name,email:c.email,image:c.picture},expires:u.toISOString()},n=await l.session({session:e,token:c});h.body=n;let i=await s.encode({...s,token:c,salt:r}),a=t.chunk(i,{expires:u});h.cookies?.push(...a),await o.session?.({session:n,token:c})}else h.cookies?.push(...t.clean())}catch(e){c.error(new e4(e)),h.cookies?.push(...t.clean())}return h}try{let{getSessionAndUser:r,deleteSession:s,updateSession:c}=a,u=await r(p);if(u&&u.session.expires.valueOf()<Date.now()&&(await s(p),u=null),u){let{user:t,session:r}=u,a=e.session.updateAge,s=r.expires.valueOf()-1e3*d+1e3*a,f=i6(d);s<=Date.now()&&await c({sessionToken:p,expires:f});let g=await l.session({session:{...r,user:t},user:t,newSession:i,...n?{trigger:"update"}:{}});h.body=g,h.cookies?.push({name:e.cookies.sessionToken.name,value:p,options:{...e.cookies.sessionToken.options,expires:f}}),await o.session?.({session:g})}else p&&h.cookies?.push(...t.clean())}catch(e){c.error(new ti(e))}return h}async function od(e,t){let r,n;let{logger:i,provider:a}=t,s=a.authorization?.url;if(!s||"authjs.dev"===s.host){let e=new URL(a.issuer),t=await av(e,{[ai]:a[nU],[at]:!0}),r=await ak(e,t).catch(t=>{if(!(t instanceof TypeError)||"Invalid URL"!==t.message)throw t;throw TypeError(`Discovery request responded with an invalid issuer. expected: ${e}`)});if(!r.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");s=new URL(r.authorization_endpoint)}let o=s.searchParams,l=a.callbackUrl;!t.isOnRedirectProxy&&a.redirectProxyUrl&&(l=a.redirectProxyUrl,n=a.callbackUrl,i.debug("using redirect proxy",{redirect_uri:l,data:n}));let c=Object.assign({response_type:"code",client_id:a.clientId,redirect_uri:l,...a.authorization?.params},Object.fromEntries(a.authorization?.url.searchParams??[]),e);for(let e in c)o.set(e,c[e]);let u=[];a.authorization?.url.searchParams.get("response_mode")==="form_post"&&(t.cookies.state.options.sameSite="none",t.cookies.state.options.secure=!0,t.cookies.nonce.options.sameSite="none",t.cookies.nonce.options.secure=!0);let d=await s0.create(t,n);if(d&&(o.set("state",d.value),u.push(d.cookie)),a.checks?.includes("pkce")){if(r&&!r.code_challenge_methods_supported?.includes("S256"))"oidc"===a.type&&(a.checks=["nonce"]);else{let{value:e,cookie:r}=await sZ.create(t);o.set("code_challenge",e),o.set("code_challenge_method","S256"),u.push(r)}}let h=await s1.create(t);return h&&(o.set("nonce",h.value),u.push(h.cookie)),"oidc"!==a.type||s.searchParams.has("scope")||s.searchParams.set("scope","openid profile email"),i.debug("authorization url is ready",{url:s,cookies:u,provider:a}),{redirect:s.toString(),cookies:u}}async function oh(e,t){let r;let{body:n}=e,{provider:i,callbacks:a,adapter:s}=t,o=(i.normalizeIdentifier??function(e){if(!e)throw Error("Missing email from request body.");let[t,r]=e.toLowerCase().trim().split("@");return r=r.split(",")[0],`${t}@${r}`})(n?.email),l={id:crypto.randomUUID(),email:o,emailVerified:null},c=await s.getUserByEmail(o)??l,u={providerAccountId:o,userId:c.id,type:"email",provider:i.id};try{r=await a.signIn({user:c,account:u,email:{verificationRequest:!0}})}catch(e){throw new eZ(e)}if(!r)throw new eZ("AccessDenied");if("string"==typeof r)return{redirect:await a.redirect({url:r,baseUrl:t.url.origin})};let{callbackUrl:d,theme:h}=t,p=await i.generateVerificationToken?.()??nP(32),f=new Date(Date.now()+(i.maxAge??86400)*1e3),g=i.secret??t.secret,m=new URL(t.basePath,t.url.origin),y=i.sendVerificationRequest({identifier:o,token:p,expires:f,url:`${m}/callback/${i.id}?${new URLSearchParams({callbackUrl:d,token:p,email:o})}`,provider:i,theme:h,request:new Request(e.url,{headers:e.headers,method:e.method,body:"POST"===e.method?JSON.stringify(e.body??{}):void 0})}),w=s.createVerificationToken?.({identifier:o,token:await nA(`${p}${g}`),expires:f});return await Promise.all([y,w]),{redirect:`${m}/verify-request?${new URLSearchParams({provider:i.id,type:i.type})}`}}async function op(e,t,r){let n=`${r.url.origin}${r.basePath}/signin`;if(!r.provider)return{redirect:n,cookies:t};switch(r.provider.type){case"oauth":case"oidc":{let{redirect:n,cookies:i}=await od(e.query,r);return i&&t.push(...i),{redirect:n,cookies:t}}case"email":return{...await oh(e,r),cookies:t};default:return{redirect:n,cookies:t}}}async function of(e,t,r){let{jwt:n,events:i,callbackUrl:a,logger:s,session:o}=r,l=t.value;if(!l)return{redirect:a,cookies:e};try{if("jwt"===o.strategy){let e=r.cookies.sessionToken.name,t=await n.decode({...n,token:l,salt:e});await i.signOut?.({token:t})}else{let e=await r.adapter?.deleteSession(l);await i.signOut?.({session:e})}}catch(e){s.error(new to(e))}return e.push(...t.clean()),{redirect:a,cookies:e}}async function og(e,t){let{adapter:r,jwt:n,session:{strategy:i}}=e,a=t.value;if(!a)return null;if("jwt"===i){let t=e.cookies.sessionToken.name,r=await n.decode({...n,token:a,salt:t});if(r&&r.sub)return{id:r.sub,name:r.name,email:r.email,image:r.picture}}else{let e=await r?.getSessionAndUser(a);if(e)return e.user}return null}async function om(e,t,r,n){let i=oi(t),{provider:a}=i,{action:s}=e.query??{};if("register"!==s&&"authenticate"!==s&&void 0!==s)return{status:400,body:{error:"Invalid action"},cookies:n,headers:{"Content-Type":"application/json"}};let o=await og(t,r),l=o?{user:o,exists:!0}:await a.getUserInfo(t,e),c=l?.user;switch(function(e,t,r){let{user:n,exists:i=!1}=r??{};switch(e){case"authenticate":return"authenticate";case"register":if(n&&t===i)return"register";break;case void 0:if(!t){if(!n||i)return"authenticate";return"register"}}return null}(s,!!o,l)){case"authenticate":return s7(i,e,c,n);case"register":if("string"==typeof c?.email)return s9(i,e,c,n);break;default:return{status:400,body:{error:"Invalid request"},cookies:n,headers:{"Content-Type":"application/json"}}}}async function oy(e,t){let{action:r,providerId:n,error:i,method:a}=e,s=t.skipCSRFCheck===nj,{options:o,cookies:l}=await nK({authOptions:t,action:r,providerId:n,url:e.url,callbackUrl:e.body?.callbackUrl??e.query?.callbackUrl,csrfToken:e.body?.csrfToken,cookies:e.cookies,isPost:"POST"===a,csrfDisabled:s}),c=new ez(o.cookies.sessionToken,e.cookies,o.logger);if("GET"===a){let t=i3({...o,query:e.query,cookies:l});switch(r){case"callback":return await ol(e,o,c,l);case"csrf":return t.csrf(s,o,l);case"error":return t.error(i);case"providers":return t.providers(o.providers);case"session":return await ou(o,c,l);case"signin":return t.signin(n,i);case"signout":return t.signout();case"verify-request":return t.verifyRequest();case"webauthn-options":return await om(e,o,c,l)}}else{let{csrfTokenVerified:t}=o;switch(r){case"callback":return"credentials"===o.provider.type&&nO(r,t),await ol(e,o,c,l);case"session":return nO(r,t),await ou(o,c,l,!0,e.body?.data);case"signin":return nO(r,t),await op(e,l,o);case"signout":return nO(r,t),await of(l,c,o)}}throw new tl(`Cannot handle action: ${r}`)}function ow(e,t,r,n,i){let a;let s=i?.basePath,o=n.AUTH_URL??n.NEXTAUTH_URL;if(o)a=new URL(o),s&&"/"!==s&&"/"!==a.pathname&&(a.pathname!==s&&nv(i).warn("env-url-basepath-mismatch"),a.pathname="/");else{let e=r.get("x-forwarded-host")??r.get("host"),n=r.get("x-forwarded-proto")??t??"https",i=n.endsWith(":")?n:n+":";a=new URL(`${i}//${e}`)}let l=a.toString().replace(/\/$/,"");if(s){let t=s?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${l}/${t}/${e}`)}return new URL(`${l}/${e}`)}async function ob(e,t){let r=nv(t),n=await nx(e,t);if(!n)return Response.json("Bad request.",{status:400});let i=function(e,t){let{url:r}=e,n=[];if(!tv&&t.debug&&n.push("debug-enabled"),!t.trustHost)return new td(`Host must be trusted. URL was: ${e.url}`);if(!t.secret?.length)return new te("Please define a `secret`");let i=e.query?.callbackUrl;if(i&&!t_(i,r.origin))return new e2(`Invalid callback URL. Received: ${i}`);let{callbackUrl:a}=eF(t.useSecureCookies??"https:"===r.protocol),s=e.cookies?.[t.cookies?.callbackUrl?.name??a.name];if(s&&!t_(s,r.origin))return new e2(`Invalid callback URL. Received: ${s}`);let o=!1;for(let e of t.providers){let t="function"==typeof e?e():e;if(("oauth"===t.type||"oidc"===t.type)&&!(t.issuer??t.options?.issuer)){let e;let{authorization:r,token:n,userinfo:i}=t;if("string"==typeof r||r?.url?"string"==typeof n||n?.url?"string"==typeof i||i?.url||(e="userinfo"):e="token":e="authorization",e)return new e3(`Provider "${t.id}" is missing both \`issuer\` and \`${e}\` endpoint config. At least one of them is required`)}if("credentials"===t.type)tS=!0;else if("email"===t.type)tk=!0;else if("webauthn"===t.type){var l;if(tE=!0,t.simpleWebAuthnBrowserVersion&&(l=t.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(l)))return new eG(`Invalid provider config for "${t.id}": simpleWebAuthnBrowserVersion "${t.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(t.enableConditionalUI){if(o)return new tg("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(o=!0,!Object.values(t.formFields).some(e=>e.autocomplete&&e.autocomplete.toString().indexOf("webauthn")>-1))return new tm(`Provider "${t.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(tS){let e=t.session?.strategy==="database",r=!t.providers.some(e=>"credentials"!==("function"==typeof e?e():e).type);if(e&&r)return new tc("Signing in with credentials only supported if JWT strategy is enabled");if(t.providers.some(e=>{let t="function"==typeof e?e():e;return"credentials"===t.type&&!t.authorize}))return new e7("Must define an authorize() handler to use credentials authentication provider")}let{adapter:c,session:u}=t,d=[];if(tk||u?.strategy==="database"||!u?.strategy&&c){if(tk){if(!c)return new e8("Email login requires an adapter");d.push(...tx)}else{if(!c)return new e8("Database session requires an adapter");d.push(...tT)}}if(tE){if(!t.experimental?.enableWebAuthn)return new tb("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(n.push("experimental-webauthn"),!c)return new e8("WebAuthn requires an adapter");d.push(...tA)}if(c){let e=d.filter(e=>!(e in c));if(e.length)return new e9(`Required adapter methods were missing: ${e.join(", ")}`)}return tv||(tv=!0),n}(n,t);if(Array.isArray(i))i.forEach(r.warn);else if(i){if(r.error(i),!new Set(["signin","signout","error","verify-request"]).has(n.action)||"GET"!==n.method)return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:e,theme:a}=t,s=e?.error&&n.url.searchParams.get("callbackUrl")?.startsWith(e.error);if(!e?.error||s)return s&&r.error(new e0(`The error page ${e?.error} should not require authentication`)),nT(i3({theme:a}).error("Configuration"));let o=`${n.url.origin}${e.error}?error=Configuration`;return Response.redirect(o)}let a=e.headers?.has("X-Auth-Return-Redirect"),s=t.raw===n$;try{let e=await oy(n,t);if(s)return e;let r=nT(e),i=r.headers.get("Location");if(!a||!i)return r;return Response.json({url:i},{headers:r.headers})}catch(d){r.error(d);let i=d instanceof eG;if(i&&s&&!a)throw d;if("POST"===e.method&&"session"===n.action)return Response.json(null,{status:400});let o=new URLSearchParams({error:d instanceof eG&&tf.has(d.type)?d.type:"Configuration"});d instanceof e5&&o.set("code",d.code);let l=i&&d.kind||"error",c=t.pages?.[l]??`${t.basePath}/${l.toLowerCase()}`,u=`${n.url.origin}${c}?${o}`;if(a)return Response.json({url:u});return Response.redirect(u)}}function ov(e){let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return e;let{origin:r}=new URL(t),{href:n,origin:i}=e.nextUrl;return new Q(n.replace(i,r),e)}function o_(e){try{e.secret??(e.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let t=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!t)return;let{pathname:r}=new URL(t);if("/"===r)return;e.basePath||(e.basePath=r)}catch{}finally{e.basePath||(e.basePath="/api/auth"),function(e,t,r=!1){try{let n=e.AUTH_URL;n&&(t.basePath?r||nv(t).warn("env-url-basepath-redundant"):t.basePath=new URL(n).pathname)}catch{}finally{t.basePath??(t.basePath="/auth")}if(!t.secret?.length){t.secret=[];let r=e.AUTH_SECRET;for(let n of(r&&t.secret.push(r),[1,2,3])){let r=e[`AUTH_SECRET_${n}`];r&&t.secret.unshift(r)}}t.redirectProxyUrl??(t.redirectProxyUrl=e.AUTH_REDIRECT_PROXY_URL),t.trustHost??(t.trustHost=!!(e.AUTH_URL??e.AUTH_TRUST_HOST??e.VERCEL??e.CF_PAGES??"production"!==e.NODE_ENV)),t.providers=t.providers.map(t=>{let{id:r}="function"==typeof t?t({}):t,n=r.toUpperCase().replace(/-/g,"_"),i=e[`AUTH_${n}_ID`],a=e[`AUTH_${n}_SECRET`],s=e[`AUTH_${n}_ISSUER`],o=e[`AUTH_${n}_KEY`],l="function"==typeof t?t({clientId:i,clientSecret:a,issuer:s,apiKey:o}):t;return"oauth"===l.type||"oidc"===l.type?(l.clientId??(l.clientId=i),l.clientSecret??(l.clientSecret=a),l.issuer??(l.issuer=s)):"email"===l.type&&(l.apiKey??(l.apiKey=o)),l})}(process.env,e,!0)}}r(340),"undefined"==typeof URLPattern||URLPattern;let oS=(0,eN.P)();var ok=r(23);class oE extends Error{constructor(e){super("Dynamic server usage: "+e),this.description=e,this.digest="DYNAMIC_SERVER_USAGE"}}class ox extends Error{constructor(...e){super(...e),this.code="NEXT_STATIC_GEN_BAILOUT"}}let oT="function"==typeof ok.unstable_postpone;function oA(e,t){let r=new URL(e.urlPathname,"http://n").pathname;if(e.isUnstableCacheCallback)throw Error(`Route ${r} used "${t}" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "${t}" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`);if(e.dynamicShouldError)throw new ox(`Route ${r} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${t}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`);if(e.prerenderState)!function(e,t,r){!function(){if(!oT)throw Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js")}();let n=`Route ${r} needs to bail out of prerendering at this point because it used ${t}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`;e.dynamicAccesses.push({stack:e.isDebugSkeleton?Error().stack:void 0,expression:t}),ok.unstable_postpone(n)}(e.prerenderState,t,r);else if(e.revalidate=0,e.isStaticGeneration){let n=new oE(`Route ${r} couldn't be rendered statically because it used \`${t}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`);throw e.dynamicUsageDescription=t,e.dynamicUsageStack=n.stack,n}}function oP(){let e="headers",t=ed.A.getStore();if(t){if(t.forceStatic)return eu.seal(new Headers({}));oA(t,e)}return eD(e).headers}function oC(){let e="cookies",t=ed.A.getStore();if(t){if(t.forceStatic)return ep.seal(new Y.RequestCookies(new Headers({})));oA(t,e)}let r=eD(e),n=oS.getStore();return(null==n?void 0:n.isAction)||(null==n?void 0:n.isAppRoute)?r.mutableCookies:r.cookies}async function oO(e,t){return ob(new Request(ow("session",e.get("x-forwarded-proto"),e,process.env,t),{headers:{cookie:e.get("cookie")??""}}),{...t,callbacks:{...t.callbacks,async session(...e){let r=await t.callbacks?.session?.(...e)??{...e[0].session,expires:e[0].session.expires?.toISOString?.()??e[0].session.expires};return{user:e[0].user??e[0].token,...r}}}})}function oR(e){return"function"==typeof e}function oI(e,t){return"function"==typeof e?async(...r)=>{if(!r.length){let r=await oP(),n=await e(void 0);return t?.(n),oO(r,n).then(e=>e.json())}if(r[0]instanceof Request){let n=r[0],i=r[1],a=await e(n);return t?.(a),oj([n,i],a)}if(oR(r[0])){let n=r[0];return async(...r)=>{let i=await e(r[0]);return t?.(i),oj(r,i,n)}}let n="req"in r[0]?r[0].req:r[0],i="res"in r[0]?r[0].res:r[1],a=await e(n);return t?.(a),oO(new Headers(n.headers),a).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in i?i.headers.append("set-cookie",t):i.appendHeader("set-cookie",t);return t})}:(...t)=>{if(!t.length)return Promise.resolve(oP()).then(t=>oO(t,e).then(e=>e.json()));if(t[0]instanceof Request)return oj([t[0],t[1]],e);if(oR(t[0])){let r=t[0];return async(...t)=>oj(t,e,r).then(e=>e)}let r="req"in t[0]?t[0].req:t[0],n="res"in t[0]?t[0].res:t[1];return oO(new Headers(r.headers),e).then(async e=>{let t=await e.json();for(let t of e.headers.getSetCookie())"headers"in n?n.headers.append("set-cookie",t):n.appendHeader("set-cookie",t);return t})}}async function oj(e,t,r){let n=ov(e[0]),i=await oO(n.headers,t),a=await i.json(),s=!0;t.callbacks?.authorized&&(s=await t.callbacks.authorized({request:n,auth:a}));let o=ei.next?.();if(s instanceof Response){o=s;let e=s.headers.get("Location"),{pathname:r}=n.nextUrl;e&&function(e,t,r){let n=t.replace(`${e}/`,""),i=Object.values(r.pages??{});return(o$.has(n)||i.includes(t))&&t===e}(r,new URL(e).pathname,t)&&(s=!0)}else if(r)n.auth=a,o=await r(n,e[1])??ei.next();else if(!s){let e=t.pages?.signIn??`${t.basePath}/signin`;if(n.nextUrl.pathname!==e){let t=n.nextUrl.clone();t.pathname=e,t.searchParams.set("callbackUrl",n.nextUrl.href),o=ei.redirect(t)}}let l=new Response(o?.body,o);for(let e of i.headers.getSetCookie())l.headers.append("set-cookie",e);return l}let o$=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);!function(e){e[e.SeeOther=303]="SeeOther",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect"}(l||(l={}));let oU="NEXT_REDIRECT";function oN(e,t){void 0===t&&(t="replace");let r=oS.getStore();throw function(e,t,r){void 0===r&&(r=l.TemporaryRedirect);let n=Error(oU);n.digest=oU+";"+t+";"+e+";"+r+";";let i=eL.getStore();return i&&(n.mutableCookies=i.mutableCookies),n}(e,t,(null==r?void 0:r.isAction)?l.SeeOther:l.TemporaryRedirect)}async function oL(e,t={},r,n){let i=new Headers(await oP()),{redirect:a=!0,redirectTo:s,...o}=t instanceof FormData?Object.fromEntries(t):t,l=s?.toString()??i.get("Referer")??"/",c=ow("signin",i.get("x-forwarded-proto"),i,process.env,n);if(!e)return c.searchParams.append("callbackUrl",l),a&&oN(c.toString()),c.toString();let u=`${c}/${e}?${new URLSearchParams(r)}`,d={};for(let t of n.providers){let{options:r,...n}="function"==typeof t?t():t,i=r?.id??n.id;if(i===e){d={id:i,type:r?.type??n.type};break}}if(!d.id){let e=`${c}?${new URLSearchParams({callbackUrl:l})}`;return a&&oN(e),e}"credentials"===d.type&&(u=u.replace("signin","callback")),i.set("Content-Type","application/x-www-form-urlencoded");let h=new Request(u,{method:"POST",headers:i,body:new URLSearchParams({...o,callbackUrl:l})}),p=await ob(h,{...n,raw:n$,skipCSRFCheck:nj}),f=await oC();for(let e of p?.cookies??[])f.set(e.name,e.value,e.options);let g=(p instanceof Response?p.headers.get("Location"):p.redirect)??u;return a?oN(g):g}async function oD(e,t){let r=new Headers(await oP());r.set("Content-Type","application/x-www-form-urlencoded");let n=ow("signout",r.get("x-forwarded-proto"),r,process.env,t),i=new URLSearchParams({callbackUrl:e?.redirectTo??r.get("Referer")??"/"}),a=new Request(n,{method:"POST",headers:r,body:i}),s=await ob(a,{...t,raw:n$,skipCSRFCheck:nj}),o=await oC();for(let e of s?.cookies??[])o.set(e.name,e.value,e.options);return e?.redirect??!0?oN(s.redirect):s}async function oM(e,t){let r=new Headers(await oP());r.set("Content-Type","application/json");let n=new Request(ow("session",r.get("x-forwarded-proto"),r,process.env,t),{method:"POST",headers:r,body:JSON.stringify({data:e})}),i=await ob(n,{...t,raw:n$,skipCSRFCheck:nj}),a=await oC();for(let e of i?.cookies??[])a.set(e.name,e.value,e.options);return i.body}!function(e){e.push="push",e.replace="replace"}(c||(c={}));let oH=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,254)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)};class oW extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class oK extends oW{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class oB extends oW{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class oq extends oW{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(u||(u={}));class oJ{constructor(e,{headers:t={},customFetch:r,region:n=u.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=oH(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,n,i,a,s;return n=this,i=void 0,a=void 0,s=function*(){try{let n;let{headers:i,method:a,body:s}=t,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("undefined"!=typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",n=s):"string"==typeof s?(o["Content-Type"]="text/plain",n=s):"undefined"!=typeof FormData&&s instanceof FormData?n=s:(o["Content-Type"]="application/json",n=JSON.stringify(s)));let c=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:n}).catch(e=>{throw new oK(e)}),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new oB(c);if(!c.ok)throw new oq(c);let d=(null!==(r=c.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"text/event-stream"===d?c:"multipart/form-data"===d?yield c.formData():yield c.text(),error:null}}catch(e){return{data:null,error:e}}},new(a||(a=Promise))(function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):((n=t.value)instanceof a?n:new a(function(e){e(n)})).then(r,o)}l((s=s.apply(n,i||[])).next())})}}let{PostgrestClient:oV,PostgrestQueryBuilder:oF,PostgrestFilterBuilder:oz,PostgrestTransformBuilder:oG,PostgrestBuilder:oX,PostgrestError:oY}=r(690),oZ={"X-Client-Info":"realtime-js/2.11.2"};!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(d||(d={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(h||(h={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(p||(p={})),(f||(f={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(g||(g={}));class oQ{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let n=t.getUint8(1),i=t.getUint8(2),a=this.HEADER_LENGTH+2,s=r.decode(e.slice(a,a+n));a+=n;let o=r.decode(e.slice(a,a+i));return a+=i,{ref:null,topic:s,event:o,payload:JSON.parse(r.decode(e.slice(a,e.byteLength)))}}}class o0{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(m||(m={}));let o1=(e,t,r={})=>{var n;let i=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=o2(n,e,t,i),r),{})},o2=(e,t,r,n)=>{let i=t.find(t=>t.name===e),a=null==i?void 0:i.type,s=r[e];return a&&!n.includes(a)?o5(a,s):o3(s)},o5=(e,t)=>{if("_"===e.charAt(0))return o9(t,e.slice(1,e.length));switch(e){case m.bool:return o6(t);case m.float4:case m.float8:case m.int2:case m.int4:case m.int8:case m.numeric:case m.oid:return o4(t);case m.json:case m.jsonb:return o8(t);case m.timestamp:return o7(t);case m.abstime:case m.date:case m.daterange:case m.int4range:case m.int8range:case m.money:case m.reltime:case m.text:case m.time:case m.timestamptz:case m.timetz:case m.tsrange:case m.tstzrange:default:return o3(t)}},o3=e=>e,o6=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},o4=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},o8=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},o9=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;let i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(e){n=i?i.split(","):[]}return n.map(e=>o5(t,e))}return e},o7=e=>"string"==typeof e?e.replace(" ","T"):e,le=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class lt{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(y||(y={}));class lr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lr.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=lr.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=lr.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){let i=this.cloneDeep(e),a=this.transformState(t),s={},o={};return this.map(i,(e,t)=>{a[e]||(o[e]=t)}),this.map(a,(e,t)=>{let r=i[e];if(r){let n=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),a=t.filter(e=>0>i.indexOf(e.presence_ref)),l=r.filter(e=>0>n.indexOf(e.presence_ref));a.length>0&&(s[e]=a),l.length>0&&(o[e]=l)}else s[e]=t}),this.syncDiff(i,{joins:s,leaves:o},r,n)}static syncDiff(e,t,r,n){let{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{var i;let a=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),a.length>0){let r=e[t].map(e=>e.presence_ref),n=a.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...n)}r(t,a,n)}),this.map(a,(t,r)=>{let i=e[t];if(!i)return;let a=r.map(e=>e.presence_ref);i=i.filter(e=>0>a.indexOf(e.presence_ref)),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let n=e[r];return"metas"in n?t[r]=n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(w||(w={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(b||(b={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(v||(v={}));class ln{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=h.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new lt(this,p.join,this.params,this.timeout),this.rejoinTimer=new o0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=h.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=h.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=h.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=h.errored,this.rejoinTimer.scheduleTimeout())}),this._on(p.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new lr(this),this.broadcastEndpointURL=le(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:i,presence:a,private:s}}=this.params;this._onError(t=>null==e?void 0:e(v.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(v.CLOSED));let o={},l={broadcast:i,presence:a,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],private:s};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(v.SUBSCRIBED);return}{let n=this.bindings.postgres_changes,i=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,a=[];for(let r=0;r<i;r++){let i=n[r],{filter:{event:s,schema:o,table:l,filter:c}}=i,u=t&&t[r];if(u&&u.event===s&&u.schema===o&&u.table===l&&u.filter===c)a.push(Object.assign(Object.assign({},i),{id:u.id}));else{this.unsubscribe(),null==e||e(v.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=a,e&&e(v.SUBSCRIBED);return}}).receive("error",t=>{null==e||e(v.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(v.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,i,a;let s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===a?void 0:a.ack)||r("ok"),s.receive("ok",()=>r("ok")),s.receive("error",()=>r("error")),s.receive("timeout",()=>r("timed out"))});{let{event:i,payload:a}=e,s={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await (null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=h.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(p.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let n=new lt(this,p.leave,{},e);n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){let n=new AbortController,i=setTimeout(()=>n.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new lt(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;let a=e.toLocaleLowerCase(),{close:s,error:o,leave:l,join:c}=p;if(r&&[s,o,l,c].indexOf(a)>=0&&r!==this._joinRef())return;let u=this._onMessage(a,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===a}).map(e=>e.callback(u,r)):null===(i=this.bindings[a])||void 0===i||i.filter(e=>{var r,n,i,s,o,l;if(!["broadcast","presence","postgres_changes"].includes(a))return e.type.toLocaleLowerCase()===a;if("id"in e){let a=e.id,s=null===(r=e.filter)||void 0===r?void 0:r.event;return a&&(null===(n=t.ids)||void 0===n?void 0:n.includes(a))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{let r=null===(o=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof u&&"ids"in u){let e=u.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:a}=e;u=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:a}),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===h.closed}_isJoined(){return this.state===h.joined}_isJoining(){return this.state===h.joining}_isLeaving(){return this.state===h.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&ln.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(p.close,{},e)}_onError(e){this._on(p.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=h.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=o1(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=o1(e.columns,e.old_record)),t}}let li=()=>{},la="undefined"!=typeof WebSocket,ls=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class lo{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=oZ,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=li,this.conn=null,this.sendBuffer=[],this.serializer=new oQ,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,254)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},this.endPoint=`${e}/${f.websocket}`,this.httpEndpoint=le(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let i=null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new o0(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(la){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ll(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Promise.resolve().then(r.t.bind(r,809,23)).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case d.connecting:return g.Connecting;case d.open:return g.Open;case d.closing:return g.Closing;default:return g.Closed}}isConnected(){return this.connectionState()===g.Open}channel(e,t={config:{}}){let r=new ln(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:n,ref:i}=e,a=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(e){}if(e&&e.exp&&!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`);this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(p.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:n,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(p.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([ls],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ll{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=d.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class lc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function lu(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class ld extends lc{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class lh extends lc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let lp=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,254)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},lf=()=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,254))).Response:Response}),lg=e=>{if(Array.isArray(e))return e.map(e=>lg(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=lg(r)}),t};var lm=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let ly=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),lw=(e,t,r)=>lm(void 0,void 0,void 0,function*(){e instanceof(yield lf())&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{t(new ld(ly(r),e.status||500))}).catch(e=>{t(new lh(ly(e),e))}):t(new lh(ly(e),e))}),lb=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function lv(e,t,r,n,i,a){return lm(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,lb(t,n,i,a)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>s(e)).catch(e=>lw(e,o,n))})})}function l_(e,t,r,n){return lm(this,void 0,void 0,function*(){return lv(e,"GET",t,r,n)})}function lS(e,t,r,n,i){return lm(this,void 0,void 0,function*(){return lv(e,"POST",t,n,i,r)})}function lk(e,t,r,n,i){return lm(this,void 0,void 0,function*(){return lv(e,"DELETE",t,n,i,r)})}var lE=r(195).Buffer,lx=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};let lT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lP{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=lp(n)}uploadOrUpdate(e,t,r,n){return lx(this,void 0,void 0,function*(){try{let i;let a=Object.assign(Object.assign({},lA),n),s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)}),o=a.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((i=r).append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=r,s["cache-control"]=`max-age=${a.cacheControl}`,s["content-type"]=a.contentType,o&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==n?void 0:n.headers)&&(s=Object.assign(Object.assign({},s),n.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:s},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{})),d=yield u.json();if(u.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}upload(e,t,r){return lx(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return lx(this,void 0,void 0,function*(){let i=this._removeEmptyFolders(e),a=this._getFinalPath(i),s=new URL(this.url+`/object/upload/sign/${a}`);s.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:lA.upsert},n),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);let o=yield this.fetch(s.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return lx(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");let i=yield lS(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),a=new URL(this.url+i.url),s=a.searchParams.get("token");if(!s)throw new lc("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:s},error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}update(e,t,r){return lx(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return lx(this,void 0,void 0,function*(){try{return{data:yield lS(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}copy(e,t,r){return lx(this,void 0,void 0,function*(){try{return{data:{path:(yield lS(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return lx(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield lS(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),a=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return lx(this,void 0,void 0,function*(){try{let n=yield lS(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}download(e,t){return lx(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{let t=this._getFinalPath(e),n=yield l_(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}info(e){return lx(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield l_(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:lg(e),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}exists(e){return lx(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,n){return lm(this,void 0,void 0,function*(){return lv(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(lu(e)&&e instanceof lh){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),n=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);let a=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&n.push(s);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return lx(this,void 0,void 0,function*(){try{return{data:yield lk(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}list(e,t,r){return lx(this,void 0,void 0,function*(){try{let n=Object.assign(Object.assign(Object.assign({},lT),t),{prefix:e||""});return{data:yield lS(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==lE?lE.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let lC={"X-Client-Info":"storage-js/2.7.1"};var lO=function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})};class lR{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},lC),t),this.fetch=lp(r)}listBuckets(){return lO(this,void 0,void 0,function*(){try{return{data:yield l_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}getBucket(e){return lO(this,void 0,void 0,function*(){try{return{data:yield l_(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return lO(this,void 0,void 0,function*(){try{return{data:yield lS(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return lO(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,n,i){return lm(this,void 0,void 0,function*(){return lv(e,"PUT",t,n,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}emptyBucket(e){return lO(this,void 0,void 0,function*(){try{return{data:yield lS(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}deleteBucket(e){return lO(this,void 0,void 0,function*(){try{return{data:yield lk(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(lu(e))return{data:null,error:e};throw e}})}}class lI extends lR{constructor(e,t={},r){super(e,t,r)}from(e){return new lP(this.url,this.headers,e,this.fetch)}}let lj="";"undefined"!=typeof Deno?lj="deno":"undefined"!=typeof document?lj="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?lj="react-native":lj="node";let l$={headers:{"X-Client-Info":`supabase-js-${lj}/2.49.4`}},lU={schema:"public"},lN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lL={};var lD=r(254);let lM=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=lD.default:t=fetch,(...e)=>t(...e)},lH=()=>"undefined"==typeof Headers?lD.Headers:Headers,lW=(e,t,r)=>{let n=lM(r),i=lH();return(r,a)=>(function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})})(void 0,void 0,void 0,function*(){var s;let o=null!==(s=yield t())&&void 0!==s?s:e,l=new i(null==a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,Object.assign(Object.assign({},a),{headers:l}))})},lK="2.69.1",lB={"X-Client-Info":`gotrue-js/${lK}`},lq="X-Supabase-Api-Version",lJ={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lV=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class lF extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function lz(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class lG extends lF{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class lX extends lF{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class lY extends lF{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class lZ extends lY{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class lQ extends lY{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class l0 extends lY{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class l1 extends lY{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class l2 extends lY{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class l5 extends lY{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function l3(e){return lz(e)&&"AuthRetryableFetchError"===e.name}class l6 extends lY{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class l4 extends lY{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let l8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),l9=" 	\n\r=".split(""),l7=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<l9.length;t+=1)e[l9[t].charCodeAt(0)]=-2;for(let t=0;t<l8.length;t+=1)e[l8[t].charCodeAt(0)]=t;return e})();function ce(e,t,r){let n=l7[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===n)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function ct(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127){r(e);return}for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let t=0;t<e.length;t+=1)ce(e.charCodeAt(t),i,a);return t.join("")}let cr=()=>"undefined"!=typeof window&&"undefined"!=typeof document,cn={tested:!1,writable:!1},ci=()=>{if(!cr())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(cn.tested)return cn.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),cn.tested=!0,cn.writable=!0}catch(e){cn.tested=!0,cn.writable=!1}return cn.writable},ca=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,254)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},cs=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,co=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},cl=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},cc=async(e,t)=>{await e.removeItem(t)};class cu{constructor(){this.promise=new cu.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function cd(e){let t=e.split(".");if(3!==t.length)throw new l4("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!lV.test(t[e]))throw new l4("JWT not in base64url format");return{header:JSON.parse(ct(t[0])),payload:JSON.parse(ct(t[1])),signature:function(e){let t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)ce(e.charCodeAt(t),r,n);return new Uint8Array(t)}(t[2]),raw:{header:t[0],payload:t[1]}}}async function ch(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function cp(e){return("0"+e.toString(16)).substr(-2)}async function cf(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function cg(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await cf(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function cm(e,t,r=!1){let n=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,cp).join("")}(),i=n;r&&(i+="/PASSWORD_RECOVERY"),await co(e,`${t}-code-verifier`,i);let a=await cg(n),s=n===a?"plain":"s256";return[a,s]}cu.promiseConstructor=Promise;let cy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var cw=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};let cb=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cv=[502,503,504];async function c_(e){var t;let r,n;if(!cs(e))throw new l5(cb(e),0);if(cv.includes(e.status))throw new l5(cb(e),e.status);try{r=await e.json()}catch(e){throw new lX(cb(e),e)}let i=function(e){let t=e.headers.get(lq);if(!t||!t.match(cy))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(i&&i.getTime()>=lJ["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new l6(cb(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new lZ}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new l6(cb(r),e.status,r.weak_password.reasons);throw new lG(cb(r),e.status||500,n)}let cS=(e,t,r,n)=>{let i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ck(e,t,r,n){var i;let a=Object.assign({},null==n?void 0:n.headers);a[lq]||(a[lq]=lJ["2024-01-01"].name),(null==n?void 0:n.jwt)&&(a.Authorization=`Bearer ${n.jwt}`);let s=null!==(i=null==n?void 0:n.query)&&void 0!==i?i:{};(null==n?void 0:n.redirectTo)&&(s.redirect_to=n.redirectTo);let o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await cE(e,t,r+o,{headers:a,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function cE(e,t,r,n,i,a){let s;let o=cS(t,n,i,a);try{s=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new l5(cb(e),0)}if(s.ok||await c_(s),null==n?void 0:n.noResolveJson)return s;try{return await s.json()}catch(e){await c_(e)}}function cx(e){var t,r;let n=null;return e.access_token&&e.refresh_token&&e.expires_in&&(n=Object.assign({},e),!e.expires_at)&&(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function cT(e){let t=cx(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function cA(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function cP(e){return{data:e,error:null}}function cC(e){let{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},user:Object.assign({},cw(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function cO(e){return e}var cR=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class cI{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ca(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ck(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(lz(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await ck(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:cA})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=cR(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await ck(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:cC,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(lz(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await ck(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:cA})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,i,a,s,o;try{let l={nextPage:null,lastPage:0,total:0},c=await ck(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:cO});if(c.error)throw c.error;let u=await c.json(),d=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,h=null!==(o=null===(s=c.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(e){if(lz(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await ck(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:cA})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await ck(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:cA})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await ck(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:cA})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await ck(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(lz(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await ck(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(lz(e))return{data:null,error:e};throw e}}}let cj={getItem:e=>ci()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ci()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ci()&&globalThis.localStorage.removeItem(e)}};function c$(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let cU={debug:!!(globalThis&&ci()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class cN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class cL extends cN{}async function cD(e,t,r){cU.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),cU.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(n){cU.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{cU.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(0===t)throw cU.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new cL(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(cU.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let cM={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:lB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cH(e,t,r){return await r()}class cW{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cW.nextInstanceID,cW.nextInstanceID+=1,this.instanceID>0&&cr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},cM),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new cI({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=ca(n.fetch),this.lock=n.lock||cH,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:cr()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=cD:this.lock=cH,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ci()?this.storage=cj:(this.memoryStorage={},this.storage=c$(this.memoryStorage)):(this.memoryStorage={},this.storage=c$(this.memoryStorage)),cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lK}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),cr()&&this.detectSessionInUrl&&"none"!==r){let{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lz(i)&&"AuthImplicitGrantRedirectError"===i.name){let t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}let{session:a,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",s),await this._saveSession(a),setTimeout(async()=>{"recovery"===s?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(lz(e))return{error:e};return{error:new lX("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{let{data:i,error:a}=await ck(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:cx});if(a||!i)return{data:{user:null,session:null},error:a};let s=i.session,o=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:o,session:s},error:null}}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let i;if("email"in e){let{email:r,password:n,options:a}=e,s=null,o=null;"pkce"===this.flowType&&([s,o]=await cm(this.storage,this.storageKey)),i=await ck(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:o},xform:cx})}else if("phone"in e){let{phone:t,password:a,options:s}=e;i=await ck(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:cx})}else throw new l0("You must provide either an email or phone number and a password");let{data:a,error:s}=i;if(s||!a)return{data:{user:null,session:null},error:s};let o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:n,options:i}=e;t=await ck(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:cT})}else if("phone"in e){let{phone:r,password:n,options:i}=e;t=await ck(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:cT})}else throw new l0("You must provide either an email or phone number and a password");let{data:r,error:n}=t;if(n)return{data:{user:null,session:null},error:n};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new lQ};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await cl(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{let{data:t,error:i}=await ck(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:cx});if(await cc(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new lQ};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:i}}catch(e){if(lz(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:n,access_token:i,nonce:a}=e,{data:s,error:o}=await ck(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:cx});if(o)return{data:{user:null,session:null},error:o};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new lQ};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:o}}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,i,a;try{if("email"in e){let{email:n,options:i}=e,a=null,s=null;"pkce"===this.flowType&&([a,s]=await cm(this.storage,this.storageKey));let{error:o}=await ck(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:s},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:o}=await ck(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(a=null==r?void 0:r.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new l0("You must provide either an email or phone number.")}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:a,error:s}=await ck(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:cx});if(s)throw s;if(!a)throw Error("An error occurred on token verification.");let o=a.session,l=a.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{let i=null,a=null;return"pkce"===this.flowType&&([i,a]=await cm(this.storage,this.storageKey)),await ck(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:cP})}catch(e){if(lz(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new lZ;let{error:n}=await ck(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:n,options:i}=e,{error:a}=await ck(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:r,type:n,options:i}=e,{data:a,error:s}=await ck(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:s}}throw new l0("You must provide either an email or phone number and a type")}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await cl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);if(i)return{data:{session:null},error:i};return{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await ck(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:cA});return await this._useSession(async e=>{var t,r,n;let{data:i,error:a}=e;if(a)throw a;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ck(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:cA}):{data:{user:null},error:new lZ}})}catch(e){if(lz(e))return lz(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await cc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new lZ;let a=n.session,s=null,o=null;"pkce"===this.flowType&&null!=e.email&&([s,o]=await cm(this.storage,this.storageKey));let{data:l,error:c}=await ck(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:o}),jwt:a.access_token,xform:cA});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(e){if(lz(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new lZ;let t=Date.now()/1e3,r=t,n=!0,i=null,{payload:a}=cd(e.access_token);if(a.exp&&(n=(r=a.exp)<=t),n){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{let{data:n,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(lz(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:n,error:i}=t;if(i)throw i;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new lZ;let{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(lz(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!cr())throw new l1("No browser detected.");if(e.error||e.error_description||e.error_code)throw new l1(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new l2("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new l1("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new l2("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:s,expires_at:o,token_type:l}=e;if(!i||!s||!a||!l)throw new l1("No session defined in URL");let c=Math.round(Date.now()/1e3),u=parseInt(s),d=c+u;o&&(d=parseInt(o));let h=d-c;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);let p=d-u;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,c);let{data:f,error:g}=await this._getUser(i);if(g)throw g;let m={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:d,refresh_token:a,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(e){if(lz(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await cl(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{error:i};let a=null===(r=n.session)||void 0===r?void 0:r.access_token;if(a){let{error:t}=await this.admin.signOut(a,e);if(t&&!(lz(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await cc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{let{data:{session:n},error:i}=t;if(i)throw i;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await (null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await cm(this.storage,this.storageKey,!0));try{return await ck(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(lz(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(lz(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:n}=await this._useSession(async t=>{var r,n,i,a,s;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await ck(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(s=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==s?s:void 0})});if(n)throw n;return!cr()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(lz(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:a}=t;if(a)throw a;return await ck(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(e){if(lz(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,n;let i=Date.now();return await (r=async r=>(r>0&&await ch(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await ck(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:cx})),n=(e,t)=>t&&l3(t)&&Date.now()+200*Math.pow(2,e)-i<3e4,new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{let t=await r(i);if(!n(i,null,t)){e(t);return}}catch(e){if(!n(i,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),lz(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),cr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await cl(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let n=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)*1e3-Date.now()<9e4;if(this._debug(t,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),l3(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new lZ;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new cu;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new lZ;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),lz(e)){let r={session:null,error:e};return l3(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){let n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let n=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await co(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await cc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&cr()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let n=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof cN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cr()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await cm(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await ck(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(lz(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;let{data:i,error:a}=t;if(a)return{data:null,error:a};let s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await ck(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null==o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(lz(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;if(i)return{data:null,error:i};let{data:a,error:s}=await ck(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:s})})}catch(e){if(lz(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:n,error:i}=t;return i?{data:null,error:i}:await ck(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(lz(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=cd(n.access_token),s=null;a.aal&&(s=a.aal);let o=s;return(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2"),{data:{currentLevel:s,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r||(r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>Date.now())return r;let{data:n,error:i}=await ck(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!n.keys||0===n.keys.length)throw new l4("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),!(r=n.keys.find(t=>t.kid===e)))throw new l4("No matching signing key found in JWKS");return r}async getClaims(e,t={keys:[]}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}let{header:n,payload:i,signature:a,raw:{header:s,payload:o}}=cd(r);if(!function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(i.exp),!n.kid||"HS256"===n.alg||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:i,header:n,signature:a},error:null}}let l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(n.alg),c=await this.fetchJwk(n.kid,t),u=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,u,a,function(e){let t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){let t=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127){t(e);return}if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${s}.${o}`)))throw new l4("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(e){if(lz(e))return{data:null,error:e};throw e}}}cW.nextInstanceID=0;let cK=cW;class cB extends cK{constructor(e){super(e)}}class cq{constructor(e,t,r){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let s=e.replace(/\/$/,"");this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;let o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){let{db:r,auth:n,realtime:i,global:a}=e,{db:s,auth:o,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),a),accessToken:()=>{var e,t,r,n;return e=this,t=void 0,n=function*(){return""},new(r=void 0,r=Promise)(function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})}};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=r?r:{},{db:lU,realtime:lL,auth:Object.assign(Object.assign({},lN),{storageKey:o}),global:l$});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=l.auth)&&void 0!==a?a:{},this.headers,l.global.fetch),this.fetch=lW(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new oV(`${s}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new oJ(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new lI(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,n,i,a;return r=this,n=void 0,i=void 0,a=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(i||(i=Promise))(function(e,t){function s(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(s,o)}l((a=a.apply(r,n||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:a,lock:s,debug:o},l,c){let u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cB({url:this.authUrl,headers:Object.assign(Object.assign({},u),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:a,lock:s,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new lo(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?this.changedAccessToken=r:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let cJ=new cq("https://gaojwilavmullvnglpwp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdhb2p3aWxhdm11bGx2bmdscHdwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0NjI3MzU3NywiZXhwIjoyMDYxODQ5NTc3fQ.PuIXX70SAjnwpadolC62xY76XDkL2Ac9yHM5jQrjU1Q",void 0);r(3),"undefined"!=typeof performance&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);async function cV(e){let{data:t,error:r}=await cJ.from("guests").select("*").eq("email",e).single();return t}async function cF(e){let{data:t,error:r}=await cJ.from("guests").insert([e]);if(r)throw console.error(r),Error("Guest could not be created");return t}"undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window),"undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window),function(e){e.AUTO="auto",e.FULL="full",e.TEMPORARY="temporary"}(_||(_={})),function(e){e.fresh="fresh",e.reusable="reusable",e.expired="expired",e.stale="stale"}(S||(S={}));let{handlers:{GET:cz,POST:cG},auth:cX,signIn:cY,signOut:cZ}=function(e){if("function"==typeof e){let t=async t=>{let r=await e(t);return o_(r),ob(ov(t),r)};return{handlers:{GET:t,POST:t},auth:oI(e,e=>o_(e)),signIn:async(t,r,n)=>{let i=await e(void 0);return o_(i),oL(t,r,n,i)},signOut:async t=>{let r=await e(void 0);return o_(r),oD(t,r)},unstable_update:async t=>{let r=await e(void 0);return o_(r),oM(t,r)}}}o_(e);let t=t=>ob(ov(t),e);return{handlers:{GET:t,POST:t},auth:oI(e),signIn:(t,r,n)=>oL(t,r,n,e),signOut:t=>oD(t,e),unstable_update:t=>oM(t,e)}}({providers:[{id:"google",name:"Google",type:"oidc",issuer:"https://accounts.google.com",style:{brandColor:"#1a73e8"},options:{clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET}}],callbacks:{authorized:({auth:e,request:t})=>!!e?.user,async signIn({user:e}){try{return await cV(e.email)||await cF({email:e.email,fullName:e.name}),!0}catch(e){return console.error("Sign-in error:",e),!1}},async session({session:e,user:t}){try{let t=await cV(e.user.email);e.user.guestId=t?.id||null}catch(t){console.error("Error in session callback:",t),e.user.guestId=null}return e}},pages:{signIn:"/login"}}),cQ=cX,c0={matcher:["/account"]},c1={...E},c2=c1.middleware||c1.default,c5="/middleware";if("function"!=typeof c2)throw Error(`The Middleware "${c5}" must export a \`middleware\` or a \`default\` function`);function c3(e){return eq({...e,page:c5,handler:c2})}},254:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Headers:()=>s,Request:()=>o,Response:()=>l,default:()=>a,fetch:()=>i});var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();let i=n.fetch,a=n.fetch.bind(n),s=n.Headers,o=n.Request,l=n.Response},22:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(254)),a=n(r(335));class s{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n;let i=null,s=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(s="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),a=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&a&&a.length>1&&(o=parseInt(a[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(i={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,o=null,l=406,c="Not Acceptable"):s=1===s.length?s[0]:null)}else{let t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(s=[],i=null,l=200,c="OK")}catch(r){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new a.default(i)}return{error:i,data:s,count:o,status:l,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}t.default=s},191:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(210)),a=n(r(401)),s=r(253);class o{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){let t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let s,o;let l=new URL(`${this.url}/rpc/${e}`);r||n?(s=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(s="POST",o=t);let c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new a.default({method:s,url:l,headers:c,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}t.default=o},335:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},401:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(251));class a extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");let a=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=a},210:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(401));class a{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){let n=!1,a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new i.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){let s=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),a||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}t.default=a},251:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=n(r(22));class a extends i.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){let a=i?`${i}.order`:"order",s=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){let i=void 0===n?"offset":`${n}.offset`,a=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var s;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(s=this.headers.Accept)&&void 0!==s?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=a},253:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;let n=r(348);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},690:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let i=n(r(191));t.PostgrestClient=i.default;let a=n(r(210));t.PostgrestQueryBuilder=a.default;let s=n(r(401));t.PostgrestFilterBuilder=s.default;let o=n(r(251));t.PostgrestTransformBuilder=o.default;let l=n(r(22));t.PostgrestBuilder=l.default;let c=n(r(335));t.PostgrestError=c.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},945:e=>{"use strict";var t=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,a={};function s(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),n=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?n:`${n}; ${r.join("; ")}`}function o(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[n,i]=[r.slice(0,e),r.slice(e+1)];try{t.set(n,decodeURIComponent(null!=i?i:"true"))}catch{}}return t}function l(e){var t,r;if(!e)return;let[[n,i],...a]=o(e),{domain:s,expires:l,httponly:d,maxage:h,path:p,samesite:f,secure:g,partitioned:m,priority:y}=Object.fromEntries(a.map(([e,t])=>[e.toLowerCase(),t]));return function(e){let t={};for(let r in e)e[r]&&(t[r]=e[r]);return t}({name:n,value:decodeURIComponent(i),domain:s,...l&&{expires:new Date(l)},...d&&{httpOnly:!0},..."string"==typeof h&&{maxAge:Number(h)},path:p,...f&&{sameSite:c.includes(t=(t=f).toLowerCase())?t:void 0},...g&&{secure:!0},...y&&{priority:u.includes(r=(r=y).toLowerCase())?r:void 0},...m&&{partitioned:!0}})}((e,r)=>{for(var n in r)t(e,n,{get:r[n],enumerable:!0})})(a,{RequestCookies:()=>d,ResponseCookies:()=>h,parseCookie:()=>o,parseSetCookie:()=>l,stringifyCookie:()=>s}),e.exports=((e,a,s,o)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let l of n(a))i.call(e,l)||l===s||t(e,l,{get:()=>a[l],enumerable:!(o=r(a,l))||o.enumerable});return e})(t({},"__esModule",{value:!0}),a);var c=["strict","lax","none"],u=["low","medium","high"],d=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,r]of o(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===n).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,n=this._parsed;return n.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(n).map(([e,t])=>s(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>s(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},h=class{constructor(e){var t,r,n;this._parsed=new Map,this._headers=e;let i=null!=(n=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?n:[];for(let e of Array.isArray(i)?i:function(e){if(!e)return[];var t,r,n,i,a,s=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,a=!1;l();)if(","===(r=e.charAt(o))){for(n=o,o+=1,l(),i=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(a=!0,o=i,s.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!a||o>=e.length)&&s.push(e.substring(t,e.length))}return s}(i)){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===n)}has(e){return this._parsed.has(e)}set(...e){let[t,r,n]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...n})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=s(r);t.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let[t,r,n]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:r,domain:n,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(s).join("; ")}}},439:(e,t,r)=>{(()=>{"use strict";var t={491:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let n=r(223),i=r(172),a=r(930),s="context",o=new n.NoopContextManager;class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalContextManager(e){return(0,i.registerGlobal)(s,e,a.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,r,...n){return this._getContextManager().with(e,t,r,...n)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,i.getGlobal)(s)||o}disable(){this._getContextManager().disable(),(0,i.unregisterGlobal)(s,a.DiagAPI.instance())}}t.ContextAPI=l},930:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let n=r(56),i=r(912),a=r(957),s=r(172);class o{constructor(){function e(e){return function(...t){let r=(0,s.getGlobal)("diag");if(r)return r[e](...t)}}let t=this;t.setLogger=(e,r={logLevel:a.DiagLogLevel.INFO})=>{var n,o,l;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(n=e.stack)&&void 0!==n?n:e.message),!1}"number"==typeof r&&(r={logLevel:r});let c=(0,s.getGlobal)("diag"),u=(0,i.createLogLevelDiagLogger)(null!==(o=r.logLevel)&&void 0!==o?o:a.DiagLogLevel.INFO,e);if(c&&!r.suppressOverrideMessage){let e=null!==(l=Error().stack)&&void 0!==l?l:"<failed to generate stacktrace>";c.warn(`Current logger will be overwritten from ${e}`),u.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,s.registerGlobal)("diag",u,t,!0)},t.disable=()=>{(0,s.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new n.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new o),this._instance}}t.DiagAPI=o},653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let n=r(660),i=r(172),a=r(930),s="metrics";class o{constructor(){}static getInstance(){return this._instance||(this._instance=new o),this._instance}setGlobalMeterProvider(e){return(0,i.registerGlobal)(s,e,a.DiagAPI.instance())}getMeterProvider(){return(0,i.getGlobal)(s)||n.NOOP_METER_PROVIDER}getMeter(e,t,r){return this.getMeterProvider().getMeter(e,t,r)}disable(){(0,i.unregisterGlobal)(s,a.DiagAPI.instance())}}t.MetricsAPI=o},181:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let n=r(172),i=r(874),a=r(194),s=r(277),o=r(369),l=r(930),c="propagation",u=new i.NoopTextMapPropagator;class d{constructor(){this.createBaggage=o.createBaggage,this.getBaggage=s.getBaggage,this.getActiveBaggage=s.getActiveBaggage,this.setBaggage=s.setBaggage,this.deleteBaggage=s.deleteBaggage}static getInstance(){return this._instance||(this._instance=new d),this._instance}setGlobalPropagator(e){return(0,n.registerGlobal)(c,e,l.DiagAPI.instance())}inject(e,t,r=a.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,r)}extract(e,t,r=a.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,r)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,n.unregisterGlobal)(c,l.DiagAPI.instance())}_getGlobalPropagator(){return(0,n.getGlobal)(c)||u}}t.PropagationAPI=d},997:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let n=r(172),i=r(846),a=r(139),s=r(607),o=r(930),l="trace";class c{constructor(){this._proxyTracerProvider=new i.ProxyTracerProvider,this.wrapSpanContext=a.wrapSpanContext,this.isSpanContextValid=a.isSpanContextValid,this.deleteSpan=s.deleteSpan,this.getSpan=s.getSpan,this.getActiveSpan=s.getActiveSpan,this.getSpanContext=s.getSpanContext,this.setSpan=s.setSpan,this.setSpanContext=s.setSpanContext}static getInstance(){return this._instance||(this._instance=new c),this._instance}setGlobalTracerProvider(e){let t=(0,n.registerGlobal)(l,this._proxyTracerProvider,o.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,n.getGlobal)(l)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,n.unregisterGlobal)(l,o.DiagAPI.instance()),this._proxyTracerProvider=new i.ProxyTracerProvider}}t.TraceAPI=c},277:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let n=r(491),i=(0,r(780).createContextKey)("OpenTelemetry Baggage Key");function a(e){return e.getValue(i)||void 0}t.getBaggage=a,t.getActiveBaggage=function(){return a(n.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(i,t)},t.deleteBaggage=function(e){return e.deleteValue(i)}},993:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class r{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let n=new r(this._entries);return n._entries.set(e,t),n}removeEntry(e){let t=new r(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new r(this._entries);for(let r of e)t._entries.delete(r);return t}clear(){return new r}}t.BaggageImpl=r},830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let n=r(930),i=r(993),a=r(830),s=n.DiagAPI.instance();t.createBaggage=function(e={}){return new i.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(s.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:a.baggageEntryMetadataSymbol,toString:()=>e}}},67:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0;let n=r(491);t.context=n.ContextAPI.getInstance()},223:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let n=r(780);class i{active(){return n.ROOT_CONTEXT}with(e,t,r,...n){return t.call(r,...n)}bind(e,t){return t}enable(){return this}disable(){return this}}t.NoopContextManager=i},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class r{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,n)=>{let i=new r(t._currentContext);return i._currentContext.set(e,n),i},t.deleteValue=e=>{let n=new r(t._currentContext);return n._currentContext.delete(e),n}}}t.ROOT_CONTEXT=new r},506:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0;let n=r(930);t.diag=n.DiagAPI.instance()},56:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let n=r(172);class i{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return a("debug",this._namespace,e)}error(...e){return a("error",this._namespace,e)}info(...e){return a("info",this._namespace,e)}warn(...e){return a("warn",this._namespace,e)}verbose(...e){return a("verbose",this._namespace,e)}}function a(e,t,r){let i=(0,n.getGlobal)("diag");if(i)return r.unshift(t),i[e](...r)}t.DiagComponentLogger=i},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let r=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class n{constructor(){for(let e=0;e<r.length;e++)this[r[e].n]=function(e){return function(...t){if(console){let r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}(r[e].c)}}t.DiagConsoleLogger=n},912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let n=r(957);t.createLogLevelDiagLogger=function(e,t){function r(r,n){let i=t[r];return"function"==typeof i&&e>=n?i.bind(t):function(){}}return e<n.DiagLogLevel.NONE?e=n.DiagLogLevel.NONE:e>n.DiagLogLevel.ALL&&(e=n.DiagLogLevel.ALL),t=t||{},{error:r("error",n.DiagLogLevel.ERROR),warn:r("warn",n.DiagLogLevel.WARN),info:r("info",n.DiagLogLevel.INFO),debug:r("debug",n.DiagLogLevel.DEBUG),verbose:r("verbose",n.DiagLogLevel.VERBOSE)}}},957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(t.DiagLogLevel||(t.DiagLogLevel={}))},172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let n=r(200),i=r(521),a=r(130),s=i.VERSION.split(".")[0],o=Symbol.for(`opentelemetry.js.api.${s}`),l=n._globalThis;t.registerGlobal=function(e,t,r,n=!1){var a;let s=l[o]=null!==(a=l[o])&&void 0!==a?a:{version:i.VERSION};if(!n&&s[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return r.error(t.stack||t.message),!1}if(s.version!==i.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${s.version} for ${e} does not match previously registered API v${i.VERSION}`);return r.error(t.stack||t.message),!1}return s[e]=t,r.debug(`@opentelemetry/api: Registered a global for ${e} v${i.VERSION}.`),!0},t.getGlobal=function(e){var t,r;let n=null===(t=l[o])||void 0===t?void 0:t.version;if(n&&(0,a.isCompatible)(n))return null===(r=l[o])||void 0===r?void 0:r[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${i.VERSION}.`);let r=l[o];r&&delete r[e]}},130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let n=r(521),i=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function a(e){let t=new Set([e]),r=new Set,n=e.match(i);if(!n)return()=>!1;let a={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=a.prerelease)return function(t){return t===e};function s(e){return r.add(e),!1}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;let n=e.match(i);if(!n)return s(e);let o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};return null!=o.prerelease||a.major!==o.major?s(e):0===a.major?a.minor===o.minor&&a.patch<=o.patch?(t.add(e),!0):s(e):a.minor<=o.minor?(t.add(e),!0):s(e)}}t._makeCompatibilityCheck=a,t.isCompatible=a(n.VERSION)},886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0;let n=r(653);t.metrics=n.MetricsAPI.getInstance()},901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class r{constructor(){}createHistogram(e,r){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,r){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,r){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,r){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,r){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,r){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=r;class n{}t.NoopMetric=n;class i extends n{add(e,t){}}t.NoopCounterMetric=i;class a extends n{add(e,t){}}t.NoopUpDownCounterMetric=a;class s extends n{record(e,t){}}t.NoopHistogramMetric=s;class o{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=o;class l extends o{}t.NoopObservableCounterMetric=l;class c extends o{}t.NoopObservableGaugeMetric=c;class u extends o{}t.NoopObservableUpDownCounterMetric=u,t.NOOP_METER=new r,t.NOOP_COUNTER_METRIC=new i,t.NOOP_HISTOGRAM_METRIC=new s,t.NOOP_UP_DOWN_COUNTER_METRIC=new a,t.NOOP_OBSERVABLE_COUNTER_METRIC=new l,t.NOOP_OBSERVABLE_GAUGE_METRIC=new c,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new u,t.createNoopMeter=function(){return t.NOOP_METER}},660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let n=r(102);class i{getMeter(e,t,r){return n.NOOP_METER}}t.NoopMeterProvider=i,t.NOOP_METER_PROVIDER=new i},200:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(46),t)},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:r.g},46:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(651),t)},939:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0;let n=r(181);t.propagation=n.PropagationAPI.getInstance()},874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0;class r{inject(e,t){}extract(e,t){return e}fields(){return[]}}t.NoopTextMapPropagator=r},194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,r){null!=e&&(e[t]=r)}}},845:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0;let n=r(997);t.trace=n.TraceAPI.getInstance()},403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let n=r(476);class i{constructor(e=n.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}t.NonRecordingSpan=i},614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let n=r(491),i=r(607),a=r(403),s=r(139),o=n.ContextAPI.getInstance();class l{startSpan(e,t,r=o.active()){if(null==t?void 0:t.root)return new a.NonRecordingSpan;let n=r&&(0,i.getSpanContext)(r);return"object"==typeof n&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&(0,s.isSpanContextValid)(n)?new a.NonRecordingSpan(n):new a.NonRecordingSpan}startActiveSpan(e,t,r,n){let a,s,l;if(arguments.length<2)return;2==arguments.length?l=t:3==arguments.length?(a=t,l=r):(a=t,s=r,l=n);let c=null!=s?s:o.active(),u=this.startSpan(e,a,c),d=(0,i.setSpan)(c,u);return o.with(d,l,void 0,u)}}t.NoopTracer=l},124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let n=r(614);class i{getTracer(e,t,r){return new n.NoopTracer}}t.NoopTracerProvider=i},125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let n=new(r(614)).NoopTracer;class i{constructor(e,t,r,n){this._provider=e,this.name=t,this.version=r,this.options=n}startSpan(e,t,r){return this._getTracer().startSpan(e,t,r)}startActiveSpan(e,t,r,n){let i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):n}}t.ProxyTracer=i},846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let n=r(125),i=new(r(124)).NoopTracerProvider;class a{getTracer(e,t,r){var i;return null!==(i=this.getDelegateTracer(e,t,r))&&void 0!==i?i:new n.ProxyTracer(this,e,t,r)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:i}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(e,t,r)}}t.ProxyTracerProvider=a},996:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},607:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let n=r(780),i=r(403),a=r(491),s=(0,n.createContextKey)("OpenTelemetry Context Key SPAN");function o(e){return e.getValue(s)||void 0}function l(e,t){return e.setValue(s,t)}t.getSpan=o,t.getActiveSpan=function(){return o(a.ContextAPI.getInstance().active())},t.setSpan=l,t.deleteSpan=function(e){return e.deleteValue(s)},t.setSpanContext=function(e,t){return l(e,new i.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null===(t=o(e))||void 0===t?void 0:t.spanContext()}},325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let n=r(564);class i{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let r=this._clone();return r._internalState.has(e)&&r._internalState.delete(e),r._internalState.set(e,t),r}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let r=t.trim(),i=r.indexOf("=");if(-1!==i){let a=r.slice(0,i),s=r.slice(i+1,t.length);(0,n.validateKey)(a)&&(0,n.validateValue)(s)&&e.set(a,s)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new i;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=i},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let r="[_0-9a-z-*/]",n=`[a-z]${r}{0,255}`,i=`[a-z0-9]${r}{0,240}@[a-z]${r}{0,13}`,a=RegExp(`^(?:${n}|${i})$`),s=/^[ -~]{0,255}[!-~]$/,o=/,|=/;t.validateKey=function(e){return a.test(e)},t.validateValue=function(e){return s.test(e)&&!o.test(e)}},98:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let n=r(325);t.createTraceState=function(e){return new n.TraceStateImpl(e)}},476:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let n=r(475);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:n.TraceFlags.NONE}},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},139:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let n=r(476),i=r(403),a=/^([0-9a-f]{32})$/i,s=/^[0-9a-f]{16}$/i;function o(e){return a.test(e)&&e!==n.INVALID_TRACEID}function l(e){return s.test(e)&&e!==n.INVALID_SPANID}t.isValidTraceId=o,t.isValidSpanId=l,t.isSpanContextValid=function(e){return o(e.traceId)&&l(e.spanId)},t.wrapSpanContext=function(e){return new i.NonRecordingSpan(e)}},847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))},475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.6.0"}},n={};function i(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}},s=!0;try{t[e].call(a.exports,a,a.exports,i),s=!1}finally{s&&delete n[e]}return a.exports}i.ab="//";var a={};(()=>{Object.defineProperty(a,"__esModule",{value:!0}),a.trace=a.propagation=a.metrics=a.diag=a.context=a.INVALID_SPAN_CONTEXT=a.INVALID_TRACEID=a.INVALID_SPANID=a.isValidSpanId=a.isValidTraceId=a.isSpanContextValid=a.createTraceState=a.TraceFlags=a.SpanStatusCode=a.SpanKind=a.SamplingDecision=a.ProxyTracerProvider=a.ProxyTracer=a.defaultTextMapSetter=a.defaultTextMapGetter=a.ValueType=a.createNoopMeter=a.DiagLogLevel=a.DiagConsoleLogger=a.ROOT_CONTEXT=a.createContextKey=a.baggageEntryMetadataFromString=void 0;var e=i(369);Object.defineProperty(a,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=i(780);Object.defineProperty(a,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(a,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var r=i(972);Object.defineProperty(a,"DiagConsoleLogger",{enumerable:!0,get:function(){return r.DiagConsoleLogger}});var n=i(957);Object.defineProperty(a,"DiagLogLevel",{enumerable:!0,get:function(){return n.DiagLogLevel}});var s=i(102);Object.defineProperty(a,"createNoopMeter",{enumerable:!0,get:function(){return s.createNoopMeter}});var o=i(901);Object.defineProperty(a,"ValueType",{enumerable:!0,get:function(){return o.ValueType}});var l=i(194);Object.defineProperty(a,"defaultTextMapGetter",{enumerable:!0,get:function(){return l.defaultTextMapGetter}}),Object.defineProperty(a,"defaultTextMapSetter",{enumerable:!0,get:function(){return l.defaultTextMapSetter}});var c=i(125);Object.defineProperty(a,"ProxyTracer",{enumerable:!0,get:function(){return c.ProxyTracer}});var u=i(846);Object.defineProperty(a,"ProxyTracerProvider",{enumerable:!0,get:function(){return u.ProxyTracerProvider}});var d=i(996);Object.defineProperty(a,"SamplingDecision",{enumerable:!0,get:function(){return d.SamplingDecision}});var h=i(357);Object.defineProperty(a,"SpanKind",{enumerable:!0,get:function(){return h.SpanKind}});var p=i(847);Object.defineProperty(a,"SpanStatusCode",{enumerable:!0,get:function(){return p.SpanStatusCode}});var f=i(475);Object.defineProperty(a,"TraceFlags",{enumerable:!0,get:function(){return f.TraceFlags}});var g=i(98);Object.defineProperty(a,"createTraceState",{enumerable:!0,get:function(){return g.createTraceState}});var m=i(139);Object.defineProperty(a,"isSpanContextValid",{enumerable:!0,get:function(){return m.isSpanContextValid}}),Object.defineProperty(a,"isValidTraceId",{enumerable:!0,get:function(){return m.isValidTraceId}}),Object.defineProperty(a,"isValidSpanId",{enumerable:!0,get:function(){return m.isValidSpanId}});var y=i(476);Object.defineProperty(a,"INVALID_SPANID",{enumerable:!0,get:function(){return y.INVALID_SPANID}}),Object.defineProperty(a,"INVALID_TRACEID",{enumerable:!0,get:function(){return y.INVALID_TRACEID}}),Object.defineProperty(a,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return y.INVALID_SPAN_CONTEXT}});let w=i(67);Object.defineProperty(a,"context",{enumerable:!0,get:function(){return w.context}});let b=i(506);Object.defineProperty(a,"diag",{enumerable:!0,get:function(){return b.diag}});let v=i(886);Object.defineProperty(a,"metrics",{enumerable:!0,get:function(){return v.metrics}});let _=i(939);Object.defineProperty(a,"propagation",{enumerable:!0,get:function(){return _.propagation}});let S=i(845);Object.defineProperty(a,"trace",{enumerable:!0,get:function(){return S.trace}}),a.default={context:w.context,diag:b.diag,metrics:v.metrics,propagation:_.propagation,trace:S.trace}})(),e.exports=a})()},133:e=>{(()=>{"use strict";"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab="//");var t={};(()=>{t.parse=function(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");for(var i={},a=t.split(n),s=(r||{}).decode||e,o=0;o<a.length;o++){var l=a[o],c=l.indexOf("=");if(!(c<0)){var u=l.substr(0,c).trim(),d=l.substr(++c,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==i[u]&&(i[u]=function(e,t){try{return t(e)}catch(t){return e}}(d,s))}}return i},t.serialize=function(e,t,n){var a=n||{},s=a.encode||r;if("function"!=typeof s)throw TypeError("option encode is invalid");if(!i.test(e))throw TypeError("argument name is invalid");var o=s(t);if(o&&!i.test(o))throw TypeError("argument val is invalid");var l=e+"="+o;if(null!=a.maxAge){var c=a.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(a.domain){if(!i.test(a.domain))throw TypeError("option domain is invalid");l+="; Domain="+a.domain}if(a.path){if(!i.test(a.path))throw TypeError("option path is invalid");l+="; Path="+a.path}if(a.expires){if("function"!=typeof a.expires.toUTCString)throw TypeError("option expires is invalid");l+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(l+="; HttpOnly"),a.secure&&(l+="; Secure"),a.sameSite)switch("string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return l};var e=decodeURIComponent,r=encodeURIComponent,n=/; */,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),e.exports=t})()},340:(e,t,r)=>{var n;(()=>{var i={226:function(i,a){!function(s,o){"use strict";var l="function",c="undefined",u="object",d="string",h="major",p="model",f="name",g="type",m="vendor",y="version",w="architecture",b="console",v="mobile",_="tablet",S="smarttv",k="wearable",E="embedded",x="Amazon",T="Apple",A="ASUS",P="BlackBerry",C="Browser",O="Chrome",R="Firefox",I="Google",j="Huawei",$="Microsoft",U="Motorola",N="Opera",L="Samsung",D="Sharp",M="Sony",H="Xiaomi",W="Zebra",K="Facebook",B="Chromium OS",q="Mac OS",J=function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r},V=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},F=function(e,t){return typeof e===d&&-1!==z(t).indexOf(z(e))},z=function(e){return e.toLowerCase()},G=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,""),typeof t===c?e:e.substring(0,350)},X=function(e,t){for(var r,n,i,a,s,c,d=0;d<t.length&&!s;){var h=t[d],p=t[d+1];for(r=n=0;r<h.length&&!s&&h[r];)if(s=h[r++].exec(e))for(i=0;i<p.length;i++)c=s[++n],typeof(a=p[i])===u&&a.length>0?2===a.length?typeof a[1]==l?this[a[0]]=a[1].call(this,c):this[a[0]]=a[1]:3===a.length?typeof a[1]!==l||a[1].exec&&a[1].test?this[a[0]]=c?c.replace(a[1],a[2]):void 0:this[a[0]]=c?a[1].call(this,c,a[2]):void 0:4===a.length&&(this[a[0]]=c?a[3].call(this,c.replace(a[1],a[2])):void 0):this[a]=c||o;d+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===u&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(F(t[r][n],e))return"?"===r?o:r}else if(F(t[r],e))return"?"===r?o:r;return e},Z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[y,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[y,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,y],[/opios[\/ ]+([\w\.]+)/i],[y,[f,N+" Mini"]],[/\bopr\/([\w\.]+)/i],[y,[f,N]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,y],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[y,[f,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[y,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[y,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[y,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[y,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[y,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+C],y],[/\bfocus\/([\w\.]+)/i],[y,[f,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[y,[f,N+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[y,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[y,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[y,[f,N+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[y,[f,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[y,[f,R]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+C]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+C],y],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],y],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,y],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,K],y],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,y],[/\bgsa\/([\w\.]+) .*safari\//i],[y,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[y,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[y,[f,O+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,O+" WebView"],y],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[y,[f,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,y],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[y,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[y,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[y,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,y],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],y],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[y,[f,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,y],[/(cobalt)\/([\w\.]+)/i],[f,[y,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[w,"amd64"]],[/(ia32(?=;))/i],[[w,z]],[/((?:i[346]|x)86)[;\)]/i],[[w,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[w,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[w,"armhf"]],[/windows (ce|mobile); ppc;/i],[[w,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[w,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[w,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[w,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[m,L],[g,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[p,[m,L],[g,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[m,T],[g,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[m,T],[g,_]],[/(macintosh);/i],[p,[m,T]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[m,D],[g,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[m,j],[g,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[m,j],[g,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[p,/_/g," "],[m,H],[g,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[m,H],[g,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[m,"OPPO"],[g,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[m,"Vivo"],[g,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[p,[m,"Realme"],[g,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[m,U],[g,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[m,U],[g,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[m,"LG"],[g,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[m,"LG"],[g,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[m,"Lenovo"],[g,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[m,"Nokia"],[g,v]],[/(pixel c)\b/i],[p,[m,I],[g,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[m,I],[g,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[m,M],[g,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[m,M],[g,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[m,"OnePlus"],[g,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[m,x],[g,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[m,x],[g,v]],[/(playbook);[-\w\),; ]+(rim)/i],[p,m,[g,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[m,P],[g,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[m,A],[g,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[m,A],[g,v]],[/(nexus 9)/i],[p,[m,"HTC"],[g,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[p,/_/g," "],[g,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[m,"Acer"],[g,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[m,"Meizu"],[g,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,p,[g,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,p,[g,_]],[/(surface duo)/i],[p,[m,$],[g,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[m,"Fairphone"],[g,v]],[/(u304aa)/i],[p,[m,"AT&T"],[g,v]],[/\bsie-(\w*)/i],[p,[m,"Siemens"],[g,v]],[/\b(rct\w+) b/i],[p,[m,"RCA"],[g,_]],[/\b(venue[\d ]{2,7}) b/i],[p,[m,"Dell"],[g,_]],[/\b(q(?:mv|ta)\w+) b/i],[p,[m,"Verizon"],[g,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[m,"Barnes & Noble"],[g,_]],[/\b(tm\d{3}\w+) b/i],[p,[m,"NuVision"],[g,_]],[/\b(k88) b/i],[p,[m,"ZTE"],[g,_]],[/\b(nx\d{3}j) b/i],[p,[m,"ZTE"],[g,v]],[/\b(gen\d{3}) b.+49h/i],[p,[m,"Swiss"],[g,v]],[/\b(zur\d{3}) b/i],[p,[m,"Swiss"],[g,_]],[/\b((zeki)?tb.*\b) b/i],[p,[m,"Zeki"],[g,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],p,[g,_]],[/\b(ns-?\w{0,9}) b/i],[p,[m,"Insignia"],[g,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[m,"NextBook"],[g,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],p,[g,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],p,[g,v]],[/\b(ph-1) /i],[p,[m,"Essential"],[g,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[m,"Envizen"],[g,_]],[/\b(trio[-\w\. ]+) b/i],[p,[m,"MachSpeed"],[g,_]],[/\btu_(1491) b/i],[p,[m,"Rotor"],[g,_]],[/(shield[\w ]+) b/i],[p,[m,"Nvidia"],[g,_]],[/(sprint) (\w+)/i],[m,p,[g,v]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[m,$],[g,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[m,W],[g,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[m,W],[g,v]],[/smart-tv.+(samsung)/i],[m,[g,S]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[m,L],[g,S]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,"LG"],[g,S]],[/(apple) ?tv/i],[m,[p,T+" TV"],[g,S]],[/crkey/i],[[p,O+"cast"],[m,I],[g,S]],[/droid.+aft(\w)( bui|\))/i],[p,[m,x],[g,S]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[m,D],[g,S]],[/(bravia[\w ]+)( bui|\))/i],[p,[m,M],[g,S]],[/(mitv-\w{5}) bui/i],[p,[m,H],[g,S]],[/Hbbtv.*(technisat) (.*);/i],[m,p,[g,S]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,G],[p,G],[g,S]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[g,S]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,p,[g,b]],[/droid.+; (shield) bui/i],[p,[m,"Nvidia"],[g,b]],[/(playstation [345portablevi]+)/i],[p,[m,M],[g,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[m,$],[g,b]],[/((pebble))app/i],[m,p,[g,k]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[m,T],[g,k]],[/droid.+; (glass) \d/i],[p,[m,I],[g,k]],[/droid.+; (wt63?0{2,3})\)/i],[p,[m,W],[g,k]],[/(quest( 2| pro)?)/i],[p,[m,K],[g,k]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[g,E]],[/(aeobc)\b/i],[p,[m,x],[g,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[p,[g,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[g,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[g,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[g,v]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[y,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[y,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,y],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[y,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,y],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[y,Y,Z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[y,Y,Z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[y,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,q],[y,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[y,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,y],[/\(bb(10);/i],[y,[f,P]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[y,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[y,[f,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[y,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[y,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[y,[f,O+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,B],y],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,y],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],y],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,y]]},ee=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof ee))return new ee(e,t).getResult();var r=typeof s!==c&&s.navigator?s.navigator:o,n=e||(r&&r.userAgent?r.userAgent:""),i=r&&r.userAgentData?r.userAgentData:o,a=t?J(Q,t):Q,b=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[f]=o,t[y]=o,X.call(t,n,a.browser),t[h]=typeof(e=t[y])===d?e.replace(/[^\d\.]/g,"").split(".")[0]:o,b&&r&&r.brave&&typeof r.brave.isBrave==l&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[w]=o,X.call(e,n,a.cpu),e},this.getDevice=function(){var e={};return e[m]=o,e[p]=o,e[g]=o,X.call(e,n,a.device),b&&!e[g]&&i&&i.mobile&&(e[g]=v),b&&"Macintosh"==e[p]&&r&&typeof r.standalone!==c&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[p]="iPad",e[g]=_),e},this.getEngine=function(){var e={};return e[f]=o,e[y]=o,X.call(e,n,a.engine),e},this.getOS=function(){var e={};return e[f]=o,e[y]=o,X.call(e,n,a.os),b&&!e[f]&&i&&"Unknown"!=i.platform&&(e[f]=i.platform.replace(/chrome os/i,B).replace(/macos/i,q)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===d&&e.length>350?G(e,350):e,this},this.setUA(n),this};ee.VERSION="1.0.35",ee.BROWSER=V([f,y,h]),ee.CPU=V([w]),ee.DEVICE=V([p,m,g,b,v,S,_,k,E]),ee.ENGINE=ee.OS=V([f,y]),typeof a!==c?(i.exports&&(a=i.exports=ee),a.UAParser=ee):r.amdO?void 0!==(n=(function(){return ee}).call(t,r,t,e))&&(e.exports=n):typeof s!==c&&(s.UAParser=ee);var et=typeof s!==c&&(s.jQuery||s.Zepto);if(et&&!et.ua){var er=new ee;et.ua=er.getResult(),et.ua.get=function(){return er.getUA()},et.ua.set=function(e){er.setUA(e);var t=er.getResult();for(var r in t)et.ua[r]=t[r]}}}("object"==typeof window?window:this)}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}},n=!0;try{i[e].call(r.exports,r,r.exports,s),n=!1}finally{n&&delete a[e]}return r.exports}s.ab="//";var o=s(226);e.exports=o})()},912:(e,t,r)=>{"use strict";r.r(t),r.d(t,{bailoutToClientRendering:()=>a});class n extends Error{constructor(e){super("Bail out to client-side rendering: "+e),this.reason=e,this.digest="BAILOUT_TO_CLIENT_SIDE_RENDERING"}}var i=r(452);function a(e){let t=i.A.getStore();if((null==t||!t.forceStatic)&&(null==t?void 0:t.isStaticGeneration))throw new n(e)}},452:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(228).P)()},488:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getTestReqInfo:function(){return s},withRequest:function(){return a}});let n=new(r(67)).AsyncLocalStorage;function i(e,t){let r=t.header(e,"next-test-proxy-port");if(r)return{url:t.url(e),proxyPort:Number(r),testData:t.header(e,"next-test-data")||""}}function a(e,t,r){let a=i(e,t);return a?n.run(a,r):r()}function s(e,t){return n.getStore()||(e&&t?i(e,t):void 0)}},375:(e,t,r)=>{"use strict";var n=r(195).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{handleFetch:function(){return o},interceptFetch:function(){return l},reader:function(){return a}});let i=r(488),a={url:e=>e.url,header:(e,t)=>e.headers.get(t)};async function s(e,t){let{url:r,method:i,headers:a,body:s,cache:o,credentials:l,integrity:c,mode:u,redirect:d,referrer:h,referrerPolicy:p}=t;return{testData:e,api:"fetch",request:{url:r,method:i,headers:[...Array.from(a),["next-test-stack",function(){let e=(Error().stack??"").split("\n");for(let t=1;t<e.length;t++)if(e[t].length>0){e=e.slice(t);break}return(e=(e=(e=e.filter(e=>!e.includes("/next/dist/"))).slice(0,5)).map(e=>e.replace("webpack-internal:///(rsc)/","").trim())).join("    ")}()]],body:s?n.from(await t.arrayBuffer()).toString("base64"):null,cache:o,credentials:l,integrity:c,mode:u,redirect:d,referrer:h,referrerPolicy:p}}}async function o(e,t){let r=(0,i.getTestReqInfo)(t,a);if(!r)return e(t);let{testData:o,proxyPort:l}=r,c=await s(o,t),u=await e(`http://localhost:${l}`,{method:"POST",body:JSON.stringify(c),next:{internal:!0}});if(!u.ok)throw Error(`Proxy request failed: ${u.status}`);let d=await u.json(),{api:h}=d;switch(h){case"continue":return e(t);case"abort":case"unhandled":throw Error(`Proxy request aborted [${t.method} ${t.url}]`)}return function(e){let{status:t,headers:r,body:i}=e.response;return new Response(i?n.from(i,"base64"):null,{status:t,headers:new Headers(r)})}(d)}function l(e){return r.g.fetch=function(t,r){var n;return(null==r?void 0:null==(n=r.next)?void 0:n.internal)?e(t,r):o(e,new Request(t,r))},()=>{r.g.fetch=e}}},177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{interceptTestApis:function(){return a},wrapRequestHandler:function(){return s}});let n=r(488),i=r(375);function a(){return(0,i.interceptFetch)(r.g.fetch)}function s(e){return(t,r)=>(0,n.withRequest)(t,i.reader,()=>e(t,r))}},355:(e,t,r)=>{"use strict";var n=r(23);Symbol.for("react.element"),Symbol.for("react.fragment"),Object.prototype.hasOwnProperty,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner},835:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||f}function w(){}function b(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=y.prototype;var v=b.prototype=new w;v.constructor=b,g(v,y.prototype),v.isPureReactComponent=!0;var _=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&!E.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:k.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function P(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function C(e,t,i){if(null==e)return e;var a=[],s=0;return!function e(t,i,a,s,o){var l,c,u,d=typeof t;("undefined"===d||"boolean"===d)&&(t=null);var h=!1;if(null===t)h=!0;else switch(d){case"string":case"number":h=!0;break;case"object":switch(t.$$typeof){case r:case n:h=!0}}if(h)return o=o(h=t),t=""===s?"."+P(h,0):s,_(o)?(a="",null!=t&&(a=t.replace(A,"$&/")+"/"),e(o,i,a,"",function(e){return e})):null!=o&&(T(o)&&(l=o,c=a+(!o.key||h&&h.key===o.key?"":(""+o.key).replace(A,"$&/")+"/")+t,o={$$typeof:r,type:l.type,key:c,ref:l.ref,props:l.props,_owner:l._owner}),i.push(o)),1;if(h=0,s=""===s?".":s+":",_(t))for(var f=0;f<t.length;f++){var g=s+P(d=t[f],f);h+=e(d,i,a,g,o)}else if("function"==typeof(g=null===(u=t)||"object"!=typeof u?null:"function"==typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(t=g.call(t),f=0;!(d=t.next()).done;)g=s+P(d=d.value,f++),h+=e(d,i,a,g,o);else if("object"===d)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(i=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return h}(e,a,"","",function(e){return t.call(i,e,s++)}),a}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},I={transition:null};function j(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:C,forEach:function(e,t,r){C(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return C(e,function(){t++}),t},toArray:function(e){return C(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:I,ReactCurrentOwner:k},t.act=j,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=j,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},23:(e,t,r)=>{"use strict";e.exports=r(835)},3:(e,t,r)=>{"use strict";r(355)},809:e=>{"use strict";e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},228:(e,t,r)=>{"use strict";r.d(t,{P:()=>s});let n=Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class i{disable(){throw n}getStore(){}run(){throw n}exit(){throw n}enterWith(){throw n}}let a=globalThis.AsyncLocalStorage;function s(){return a?new a:new i}}},e=>{var t=e(e.s=776);(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES).middleware_middleware=t}]);
//# sourceMappingURL=middleware.js.map